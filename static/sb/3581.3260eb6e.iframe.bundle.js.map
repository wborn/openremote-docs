{"version":3,"file":"3581.3260eb6e.iframe.bundle.js","mappings":";;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;;;;AAIA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0FA;;;AAGA;;AAEA;AACA;AACA;AACA;;;;AAIA;;;;AAIA;;AAEA;;AAEA;;;;;;AAMA;;AAEA;;;AAGA;;;;AAIA;;AAEA;;;;;;AAMA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClFA;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACuBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4DA;AACA;;;;;;;;;;;;;;;;;;;AAmBA;AACA;AACA;;AAEA;;;;;;;;;;;;;;;;AAgBA;;;;AAIA;;;;;;;AAOA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;;;;;;AAOA;;;AAGA;;;;;;AAMA;;AAEA;AACA;;;;AAIA;AACA;AACA;;;;;;;;;;;AAWA;AACA;;AAEA;;AAEA;;;;;;;;;;;;;;;AAeA;;AAEA;AACA;;;;;;;;;;;;;;;;;AAiBA;;;;;;AAMA;;AAEA;ACtPA;;;AAGA;;;AAGA;;;;AAIA;AACA;AAiFA;AACA;;AAhFA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;;;;;AAMA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;AAIA;;;;;;;;;;;;;AAaA;AACA;AACA;AACA;AACA;AAGA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;AAmBA;;;;;;;AAOA;;;AAGA;AACA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;;AAIA;;AAEA;;;;;;;;;;;;;;;;;;;;;;ACvJA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AC9BA;AACA;;;;;;;;AAQA;AACA;;;;;;;;;;ACaA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;;AAzGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;ACQA;;AAEA;ACvBA;AACA;AACA;AACA;;;;;;;;AAQA;;;;;;;;;;AAUA;;;;;;;;;ACbA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;AACA;AACA;;;;;;AAMA;;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjEA;AACA;;;;;;;;AAQA;;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;;;;;;;;AAQA;;;;;;;;;;;;;;;;;;;;;;;AAuBA;;;;;;;;;;;;;ACtIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;;AAEA;AACA;;;;AAIA;;AAEA;;AAEA;AACA;;;AAGA;;;AAGA;;AAEA;;;AAGA;;AAEA;;;AAGA;;;AAGA;;;AAGA;;;;;AAKA;;;AAGA;;AAEA;;;;AAIA;AACA;AACA;AACA;;;;;;;;AAQA;;AAEA;;;;;;;;;;;;;;;;;AAiBA;;AAEA;;;;AAIA;;;;AChIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;;;;;;AAMA;;;;;;AAMA;AACA;;;AAGA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;;AAGA;;AAEA;;;;AAIA;AACA;;AAEA;;AAEA;;AAEA;;;;AAIA;;;;;AAKA;ACzFA;AACA;;AAEA;;AAEA;;;AAGA;AAVA;AACA;;;;;;;;ACMA;;;;;;;ACDA;;AAEA;;;;;;;;AAQA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwHA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;AAmBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrKA;;;;;;;;;;;;AAYA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;;AAEA;ACpEA;;AAEA;AACA;;;;AAIA;;;AAGA;;AAEA;;;;AAIA;AChBA;AACA;;AAEA;AACA;;;;;;;;;;;;;;AAcA;;;;;;;;;;AAUA;AACA;;AAEA;;;;;;;;AAQA;;;;;;;;;;;;;AC3BA","sources":["webpack://@openremote/workshop/../../component/or-attribute-history/lib/index.js","webpack://@openremote/workshop/../../component/or-asset-viewer/lib/style.js","webpack://@openremote/workshop/../../component/or-asset-viewer/lib/or-add-attribute-panel.js","webpack://@openremote/workshop/../../component/or-asset-viewer/lib/or-edit-asset-panel.js","webpack://@openremote/workshop/../../component/or-asset-viewer/lib/index.js","webpack://@openremote/workshop/../../component/or-components/lib/or-loading-wrapper.js","webpack://@openremote/workshop/../../component/or-attribute-input/lib/agent-link-json-forms-renderer.js","webpack://@openremote/workshop/../../component/or-attribute-input/lib/index.js","webpack://@openremote/workshop/../../component/or-components/lib/or-ace-editor.js","webpack://@openremote/workshop/../../component/or-json-forms/lib/util.js","webpack://@openremote/workshop/../../component/or-components/lib/or-collapsible-panel.js","webpack://@openremote/workshop/../../component/or-json-forms/lib/styles.js","webpack://@openremote/workshop/../../component/or-json-forms/lib/layouts/layout-vertical-element.js","webpack://@openremote/workshop/../../component/or-json-forms/lib/controls/control-input-element.js","webpack://@openremote/workshop/../../component/or-json-forms/lib/controls/control-array-element.js","webpack://@openremote/workshop/../../component/or-json-forms/lib/standard-renderers.js","webpack://@openremote/workshop/../../component/or-json-forms/lib/index.js","webpack://@openremote/workshop/../../component/or-map/lib/style.js","webpack://@openremote/workshop/../../component/or-map/lib/markers/or-map-marker.js","webpack://@openremote/workshop/../../component/or-map/lib/or-map-asset-card.js","webpack://@openremote/workshop/../../component/or-map/lib/index.js","webpack://@openremote/workshop/../../component/or-mwc-components/lib/style.js"],"sourcesContent":["var OrAttributeHistory_1,__decorate=this&&this.__decorate||function(t,e,r,i){var o,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,i);else for(var n=t.length-1;n>=0;n--)(o=t[n])&&(s=(a<3?o(s):a>3?o(e,r,s):o(e,r))||s);return a>3&&s&&Object.defineProperty(e,r,s),s},__awaiter=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))((function(o,a){function s(t){try{l(i.next(t))}catch(t){a(t)}}function n(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,n)}l((i=i.apply(t,e||[])).next())}))};import{css,html,LitElement,unsafeCSS}from\"lit\";import{customElement,property,query}from\"lit/decorators.js\";import i18next from\"i18next\";import{translate}from\"@openremote/or-translate\";import{AssetModelUtil}from\"@openremote/model\";import manager,{DefaultColor2,DefaultColor3,DefaultColor4}from\"@openremote/core\";import\"@openremote/or-mwc-components/or-mwc-input\";import\"@openremote/or-components/or-panel\";import\"@openremote/or-translate\";import\"@openremote/or-chart\";import{Chart}from\"chart.js\";import\"chartjs-adapter-moment\";import{InputType}from\"@openremote/or-mwc-components/or-mwc-input\";import{JSONPath}from\"jsonpath-plus\";import moment from\"moment\";import{styleMap}from\"lit/directives/style-map.js\";export class OrAttributeHistoryEvent extends CustomEvent{constructor(t,e){super(OrAttributeHistoryEvent.NAME,{detail:{value:t,previousValue:e},bubbles:!0,composed:!0})}}OrAttributeHistoryEvent.NAME=\"or-attribute-history-event\";const tableStyle=require(\"@material/data-table/dist/mdc.data-table.css\"),style=css`\n    :host {\n        --internal-or-attribute-history-background-color: var(--or-attribute-history-background-color, var(--or-app-color2, ${unsafeCSS(DefaultColor2)}));\n        --internal-or-attribute-history-text-color: var(--or-attribute-history-text-color, var(--or-app-color3, ${unsafeCSS(DefaultColor3)}));\n        --internal-or-attribute-history-controls-margin: var(--or-attribute-history-controls-margin, 10px 0);\n        --internal-or-attribute-history-controls-justify-content: var(--or-attribute-history-controls-justify-content, flex-end);\n        --internal-or-attribute-history-graph-fill-color: var(--or-attribute-history-graph-fill-color, var(--or-app-color4, ${unsafeCSS(DefaultColor4)}));       \n        --internal-or-attribute-history-graph-fill-opacity: var(--or-attribute-history-graph-fill-opacity, 1);       \n        --internal-or-attribute-history-graph-line-color: var(--or-attribute-history-graph-line-color, var(--or-app-color4, ${unsafeCSS(DefaultColor4)}));       \n        --internal-or-attribute-history-graph-point-color: var(--or-attribute-history-graph-point-color, var(--or-app-color4, ${unsafeCSS(DefaultColor4)}));\n        --internal-or-attribute-history-graph-point-border-color: var(--or-attribute-history-graph-point-border-color, var(--or-app-color4, ${unsafeCSS(DefaultColor4)}));\n        --internal-or-attribute-history-graph-point-radius: var(--or-attribute-history-graph-point-radius, 2);\n        --internal-or-attribute-history-graph-point-hit-radius: var(--or-attribute-history-graph-point-hit-radius, 20);       \n        --internal-or-attribute-history-graph-point-border-width: var(--or-attribute-history-graph-point-border-width, 2);\n        --internal-or-attribute-history-graph-point-hover-color: var(--or-attribute-history-graph-point-hover-color, var(--or-app-color4, ${unsafeCSS(DefaultColor4)}));\n        --internal-or-attribute-history-graph-point-hover-border-color: var(--or-attribute-history-graph-point-hover-border-color, var(--or-app-color4, ${unsafeCSS(DefaultColor4)}));\n        --internal-or-attribute-history-graph-point-hover-radius: var(--or-attribute-history-graph-point-hover-radius, 4);      \n        --internal-or-attribute-history-graph-point-hover-border-width: var(--or-attribute-history-graph-point-hover-border-width, 2);\n        display: block;                \n    }\n    \n    :host([hidden]) {\n        display: none;\n    }\n    \n    #container {\n        display: flex;\n        min-width: 0;\n        width: 100%;\n        height: 100%;\n        flex-direction: column;\n    }\n       \n    .button-icon {\n        align-self: center;\n        padding: 10px;\n        cursor: pointer;\n    }\n\n\n    #msg {\n        height: 100%;\n        width: 100%;\n        justify-content: center;\n        align-items: center;\n        text-align: center;\n    }\n    \n    #msg:not([hidden]) {\n        display: flex;    \n    }\n    \n    #controls {\n        display: flex;\n        flex-wrap: wrap;\n        justify-content: var(--internal-or-attribute-history-controls-justify-content);\n        margin: var(--internal-or-attribute-history-controls-margin);        \n        flex-direction: row;\n    }\n    \n    #time-picker {\n        width: 150px;\n        padding: 0 5px;\n    }\n\n    #ending-controls {\n        max-width: 100%;\n        display: flex;\n        flex-wrap: wrap;\n        align-items: center;\n    }\n    \n    #ending-controls > * {\n        padding: 0 3px;\n    }\n    \n    #ending-date {\n        width: 200px;\n        padding-left: 5px;\n    }\n    \n    #chart-container {\n        position: relative;\n        min-height: 250px;\n    }\n        \n    #table-container {\n        height: 100%;\n    }\n    \n    #table {\n        width: 100%;\n        margin-bottom: 10px;\n    }\n    \n    #table > table {\n        width: 100%;\n        table-layout: fixed;\n    }\n    \n    #table th, #table td {\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n    }\n`;let OrAttributeHistory=OrAttributeHistory_1=class extends(translate(i18next)(LitElement)){constructor(){super(...arguments),this.period=\"day\",this._loading=!1,this._dataFirstLoaded=!1}static get styles(){return[css`${unsafeCSS(tableStyle)}`,style]}connectedCallback(){super.connectedCallback(),this._style=window.getComputedStyle(this)}disconnectedCallback(){super.disconnectedCallback(),this._cleanup()}shouldUpdate(t){let e=t.has(\"period\")||t.has(\"toTimestamp\")||t.has(\"attribute\");return!(this._dataFirstLoaded&&!t.get(\"_loading\")&&!e)&&(this.toTimestamp?(!this._type&&this.attribute&&(this._type=AssetModelUtil.getValueDescriptor(this.attribute.type)||{}),e&&(this._type=void 0,this._data=void 0,this._loadData()),super.shouldUpdate(t)):(this.toTimestamp=new Date,!1))}render(){const t=this._type&&(\"number\"===this._type.jsonType||\"boolean\"===this._type.jsonType),e=this._loading||!this._type;return html`\n            <div id=\"container\">\n                <div id=\"controls\">\n                    <or-mwc-input id=\"time-picker\" .type=\"${InputType.SELECT}\" ?disabled=\"${e}\" .label=\"${i18next.t(\"timeframe\")}\" @or-mwc-input-changed=\"${t=>this.period=t.detail.value}\" .value=\"${this.period}\" .options=\"${this._getPeriodOptions()}\"></or-mwc-input>\n                    <div id=\"ending-controls\">\n                        <or-mwc-input id=\"ending-date\" .type=\"${InputType.DATETIME}\" ?disabled=\"${e}\" label=\"${i18next.t(\"ending\")}\" .value=\"${this.toTimestamp}\" @or-mwc-input-changed=\"${t=>this._updateTimestamp(moment(t.detail.value).toDate())}\"></or-mwc-input>\n                        <or-icon class=\"button button-icon\" ?disabled=\"${e}\" icon=\"chevron-left\" @click=\"${()=>this._updateTimestamp(this.toTimestamp,!1,0)}\"></or-icon>\n                        <or-icon class=\"button button-icon\" ?disabled=\"${e}\" icon=\"chevron-right\" @click=\"${()=>this._updateTimestamp(this.toTimestamp,!0,0)}\"></or-icon>\n                        <or-icon class=\"button button-icon\" ?disabled=\"${e}\" icon=\"chevron-double-right\" @click=\"${()=>this._updateTimestamp(new Date)}\"></or-icon>\n                    </div>\n                </div>\n                \n                ${this._type?t?html`\n                        <div id=\"chart-container\">\n                            <canvas id=\"chart\"></canvas>\n                        </div>\n                    `:html`\n                        <div id=\"table-container\">\n                            ${this._tableTemplate||\"\"}\n                        </div>\n                    `:html`\n                    <div id=\"msg\">\n                        <or-translate value=\"invalidAttribute\"></or-translate>\n                    </div>\n                `}                \n            </div>\n        `}willUpdate(t){if(super.willUpdate(t),this._type&&this._data){if(!this._type||\"number\"!==this._type.jsonType&&\"boolean\"!==this._type.jsonType)this._tableTemplate&&!t.has(\"_data\")||(this._tableTemplate=this._getTableTemplate());else{const e=this._data;if(this._chart)t.has(\"_data\")&&(this._chart.options.scales.x.min=this._startOfPeriod,this._chart.options.scales.x.max=this._endOfPeriod,this._chart.options.scales.x.time.unit=this._timeUnits,this._chart.options.scales.x.time.stepSize=this._stepSize,this._chart.data.datasets[0].data=e,this._chart.update());else{let t=this._style.getPropertyValue(\"--internal-or-attribute-history-graph-fill-color\").trim();const r=Number(this._style.getPropertyValue(\"--internal-or-attribute-history-graph-fill-opacity\").trim());isNaN(r)||(!t.startsWith(\"#\")||4!==t.length&&7!==t.length?t.startsWith(\"rgb(\")&&(t=t.substring(0,t.length-1)+r):t+=4===t.length?Math.round(255*r).toString(16).substr(0,1):Math.round(255*r).toString(16));const i={type:\"line\",data:{datasets:[{data:e,backgroundColor:t,borderColor:this._style.getPropertyValue(\"--internal-or-attribute-history-graph-line-color\"),pointBorderColor:this._style.getPropertyValue(\"--internal-or-attribute-history-graph-point-border-color\"),pointBackgroundColor:this._style.getPropertyValue(\"--internal-or-attribute-history-graph-point-color\"),pointRadius:Number(this._style.getPropertyValue(\"--internal-or-attribute-history-graph-point-radius\")),pointBorderWidth:Number(this._style.getPropertyValue(\"--internal-or-attribute-history-graph-point-border-width\")),pointHoverBackgroundColor:this._style.getPropertyValue(\"--internal-or-attribute-history-graph-point-hover-color\"),pointHoverBorderColor:this._style.getPropertyValue(\"--internal-or-attribute-history-graph-point-hover-border-color\"),pointHoverRadius:Number(this._style.getPropertyValue(\"--internal-or-attribute-history-graph-point-hover-radius\")),pointHoverBorderWidth:Number(this._style.getPropertyValue(\"--internal-or-attribute-history-graph-point-hover-border-width\")),pointHitRadius:Number(this._style.getPropertyValue(\"--internal-or-attribute-history-graph-point-hit-radius\")),fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,onResize:()=>this.dispatchEvent(new OrAttributeHistoryEvent(\"resize\")),plugins:{legend:{display:!1},tooltip:{displayColors:!1,xPadding:10,yPadding:10,titleMarginBottom:10}},scales:{y:{beginAtZero:!0,grid:{color:\"#cccccc\"}},x:{type:\"time\",min:this._startOfPeriod,max:this._endOfPeriod,time:{tooltipFormat:\"MMM D, YYYY, HH:mm:ss\",displayFormats:{millisecond:\"HH:mm:ss.SSS\",second:\"HH:mm:ss\",minute:\"HH:mm\",hour:\"HH:mm\",week:\"w\"},unit:this._timeUnits,stepSize:this._stepSize},ticks:{color:\"#000\",font:{family:\"'Open Sans', Helvetica, Arial, Lucida, sans-serif\",size:9,style:\"normal\"}},gridLines:{color:\"#cccccc\"}}}}};this._chart=new Chart(this._chartElem.getContext(\"2d\"),i)}}this.onCompleted().then((()=>{this.dispatchEvent(new OrAttributeHistoryEvent(\"rendered\"))}))}}onCompleted(){return __awaiter(this,void 0,void 0,(function*(){yield this.updateComplete}))}_cleanup(){this._tableTemplate=void 0,this._chart&&(this._chart.destroy(),this._chart=void 0),this._table&&(this._table.destroy(),this._table=void 0)}_getTableTemplate(){const t=this.assetType,e=this.attribute?this.attribute.name:this.attributeRef?this.attributeRef.name:void 0,r=this.attribute?this.attribute.type:void 0;if(!(this._data&&t&&e&&r))return html``;let i={autoColumns:!0};if(this.config&&this.config.table&&(this.config.table.assetTypes&&this.config.table.assetTypes[t]&&(this.config.table.assetTypes[t].attributeNames&&this.config.table.assetTypes[t].attributeNames[e]||r&&this.config.table.assetTypes[t].attributeValueTypes&&this.config.table.assetTypes[t].attributeValueTypes[r])?i=this.config.table.assetTypes[t].attributeNames&&this.config.table.assetTypes[t].attributeNames[e]||this.config.table.assetTypes[t].attributeValueTypes[r]:this.config.table.attributeNames&&this.config.table.attributeNames[e]?i=this.config.table.attributeNames[e]:r&&this.config.table.attributeValueTypes&&this.config.table.attributeValueTypes[r]?i=this.config.table.attributeValueTypes[r]:this.config.table.default&&(i=this.config.table.default),i||(i={autoColumns:!0})),i.autoColumns){i=Object.assign({},i),i.columns=[];const t=this._data.find((t=>void 0!==t.y));t&&(\"object\"!=typeof t.y||Array.isArray(t.y)?i.columns.push({type:\"prop\",header:\"value\",stringify:\"object\"==typeof t.y,numeric:\"number\"==typeof t.y}):i.columns=Object.entries(t.y).map((([t,e])=>({type:\"prop\",header:t,path:\"$.['\"+t+\"']\",stringify:\"object\"==typeof e,numeric:!isNaN(Number(e))})))),i.columns.length>0&&i.columns.push({header:\"timestamp\",type:\"timestamp\"})}return i.columns&&i.columns.length>0?html`\n            <div id=\"table\" class=\"mdc-data-table\">\n                <table style=\"${i.styles?styleMap(i.styles):\"\"}\" class=\"mdc-data-table__table\" aria-label=\"${e+\" history\"}\">\n                    <thead>\n                        <tr class=\"mdc-data-table__header-row\">\n                            ${i.columns.map((t=>html`<th style=\"${t.headerStyles?styleMap(t.headerStyles):\"\"}\" class=\"mdc-data-table__header-cell ${t.numeric?\"mdc-data-table__header-cell--numeric\":\"\"}\" role=\"columnheader\" scope=\"col\"><or-translate value=\"${t.header}\"></or-translate></th>`))}\n                        </tr>\n                    </thead>\n                    <tbody class=\"mdc-data-table__content\">\n                        ${this._data.map((t=>html`\n                                <tr class=\"mdc-data-table__row\">\n                                    ${i.columns.map((e=>{const r=this._getCellValue(t,e,i.timestampFormat);return html`<td style=\"${e.styles?styleMap(e.styles):\"\"}\" class=\"mdc-data-table__cell ${e.numeric?\"mdc-data-table__cell--numeric\":\"\"}\" title=\"${r}\">${r}</td>`}))}\n                                </tr>\n                            `))}\n                    </tbody>\n                </table>\n            </div>\n            `:(console.warn(\"OrAttributeHistory: No columns configured so nothing to show\"),html``)}_getCellValue(t,e,r){switch(e.type){case\"timestamp\":const i=moment(t.x).format(r||OrAttributeHistory_1.DEFAULT_TIMESTAMP_FORMAT);if(e&&e.contentProvider){const r=e.contentProvider(t,i,e);if(r)return r}return i;case\"prop\":let o=t.y;if(e.path&&(o=JSONPath({path:e.path,json:t.y,wrap:!1}),Array.isArray(o)&&1===o.length&&(o=o[0])),e&&e.contentProvider){const r=e.contentProvider(t,o,e);if(r)return r}return e.stringify?JSON.stringify(o):o}}_getIntervalOptions(){return[\"HOUR\",\"DAY\",\"WEEK\",\"MONTH\",\"YEAR\"].map((t=>[t,i18next.t(t.toLowerCase())]))}_getPeriodOptions(){return[\"HOUR\".toLowerCase(),\"DAY\".toLowerCase(),\"WEEK\".toLowerCase(),\"MONTH\".toLowerCase(),\"YEAR\".toLowerCase()]}_loadData(){return __awaiter(this,void 0,void 0,(function*(){if(this._loading||this._data||!this.assetType||!this.assetId||!this.attribute&&!this.attributeRef||!this.period||!this.toTimestamp)return;this._loading=!0;const t=this.assetId,e=this.attribute?this.attribute.name:this.attributeRef.name;if(!this._type){let r=this.attribute;if(!r){const i=yield manager.rest.api.AssetResource.queryAssets({ids:[t],select:{attributes:[e]}});200===i.status&&i.data.length>0&&(r=i.data[0].attributes?i.data[0].attributes[e]:void 0)}r&&(this._type=AssetModelUtil.getValueDescriptor(r.type)||{})}if(!this._type||!this._type.name)return void(this._loading=!1);let r=\"HOUR\",i=1;switch(this.period){case\"hour\":r=\"MINUTE\",i=5;break;case\"day\":r=\"HOUR\",i=1;break;case\"week\":r=\"HOUR\",i=6;break;case\"month\":r=\"DAY\",i=1;break;case\"year\":r=\"MONTH\",i=1}const o=r.toLowerCase();let a;this._startOfPeriod=moment(this.toTimestamp).subtract(1,this.period).startOf(o).add(1,o).toDate().getTime(),this._endOfPeriod=moment(this.toTimestamp).startOf(o).add(1,o).toDate().getTime(),this._timeUnits=o,this._stepSize=i,a=!this._type||\"number\"!==this._type.jsonType&&\"boolean\"!==this._type.jsonType?yield manager.rest.api.AssetDatapointResource.getDatapoints(t,e,{type:\"all\",fromTimestamp:this._startOfPeriod,toTimestamp:this._endOfPeriod}):yield manager.rest.api.AssetDatapointResource.getDatapoints(t,e,{type:\"lttb\",fromTimestamp:this._startOfPeriod,toTimestamp:this._endOfPeriod,amountOfPoints:100}),this._loading=!1,200===a.status&&(this._data=a.data.filter((t=>null!==t.y&&void 0!==t.y)),this._dataFirstLoaded=!0)}))}_updateTimestamp(t,e,r=300){this._updateTimestampTimer&&(window.clearTimeout(this._updateTimestampTimer),this._updateTimestampTimer=void 0),this._updateTimestampTimer=window.setTimeout((()=>{const r=moment(t);void 0!==e&&r.add(e?1:-1,this.period),this.toTimestamp=r.toDate()}),r)}};OrAttributeHistory.DEFAULT_TIMESTAMP_FORMAT=\"L HH:mm:ss\",__decorate([property({type:String})],OrAttributeHistory.prototype,\"assetType\",void 0),__decorate([property({type:String})],OrAttributeHistory.prototype,\"assetId\",void 0),__decorate([property({type:Object})],OrAttributeHistory.prototype,\"attribute\",void 0),__decorate([property({type:Object})],OrAttributeHistory.prototype,\"attributeRef\",void 0),__decorate([property({type:String})],OrAttributeHistory.prototype,\"period\",void 0),__decorate([property({type:Number})],OrAttributeHistory.prototype,\"toTimestamp\",void 0),__decorate([property({type:Object})],OrAttributeHistory.prototype,\"config\",void 0),__decorate([property()],OrAttributeHistory.prototype,\"_loading\",void 0),__decorate([property()],OrAttributeHistory.prototype,\"_data\",void 0),__decorate([property()],OrAttributeHistory.prototype,\"_tableTemplate\",void 0),__decorate([query(\"#chart\")],OrAttributeHistory.prototype,\"_chartElem\",void 0),__decorate([query(\"#table\")],OrAttributeHistory.prototype,\"_tableElem\",void 0),OrAttributeHistory=OrAttributeHistory_1=__decorate([customElement(\"or-attribute-history\")],OrAttributeHistory);export{OrAttributeHistory};","import{css,unsafeCSS}from\"lit\";import{DefaultColor1,DefaultColor2,DefaultColor3,DefaultColor5,DefaultColor4,DefaultColor6,DefaultHeaderHeight}from\"@openremote/core\";export const panelStyles=css`\n    .panelContainer {\n        flex: 1 1 50%;\n        box-sizing: border-box;\n        min-width: 400px;\n        padding: 0 5px;\n    }\n    \n    .panel {\n        background-color: var(--internal-or-asset-viewer-panel-color);\n        border: 1px solid #e5e5e5;\n        border-radius: 5px;\n        position: relative;\n        margin: 0 0 10px 0;\n    }\n\n    .panel-content-wrapper {\n        padding: var(--internal-or-asset-viewer-panel-padding);\n    }\n\n    .panel-content > :first-child {\n        margin-top: 0;\n    }\n    .panel-content > :last-child {\n        margin-bottom: 0;\n    }\n\n    .panel-content {\n        display: flex;\n        flex-wrap: wrap;\n    }\n\n    .panel-title {\n        text-transform: uppercase;\n        font-weight: bolder;\n        line-height: 1em;\n        color: var(--internal-or-asset-viewer-title-text-color);\n        margin-bottom: 20px;\n        flex: 0 0 auto;\n        letter-spacing: 0.025em;\n    }\n\n    .field {\n        margin: 10px 0;\n        width: 100%;\n        flex: 0 0 auto;\n    }\n\n    .field > * {\n        width: 100%;\n        box-sizing: border-box;\n    }\n\n    @media screen and (max-width: 767px) {\n        .panel {\n            border-radius: 0;\n            border-right: none;\n            border-left: none;\n            flex-basis: 100%;\n            min-width: 360px;\n        }\n    }\n    \n    #linkedUsers-panel {\n        min-height: 200px;\n    }\n`;export const style=css`\n\n    :host {\n        --internal-or-asset-viewer-background-color: var(--or-asset-viewer-background-color, var(--or-app-color2, ${unsafeCSS(DefaultColor2)}));\n        --internal-or-asset-viewer-panel-margin: var(--or-asset-viewer-panel-margin, 20px);\n        --internal-or-asset-viewer-panel-padding: var(--or-asset-viewer-panel-padding, 24px);\n        --internal-or-asset-viewer-text-color: var(--or-asset-viewer-text-color, var(--or-app-color3, ${unsafeCSS(DefaultColor3)}));\n        --internal-or-asset-viewer-title-text-color: var(--or-asset-viewer-title-text-color, var(--or-app-color3, ${unsafeCSS(DefaultColor3)}));       \n        --internal-or-asset-viewer-panel-color: var(--or-asset-viewer-panel-color, var(--or-app-color1, ${unsafeCSS(DefaultColor1)}));\n        --internal-or-asset-viewer-line-color: var(--or-asset-viewer-line-color, var(--or-app-color5, ${unsafeCSS(DefaultColor5)}));\n        --internal-or-asset-viewer-button-color: var(--or-asset-viewer-button-color, var(--or-app-color4, ${unsafeCSS(DefaultColor4)}));\n        --internal-or-asset-viewer-error-color: var(--or-asset-viewer-error-color, var(--or-app-color6, ${unsafeCSS(DefaultColor6)}));\n        --internal-or-header-height: var(--or-header-height, ${unsafeCSS(DefaultHeaderHeight)});\n                \n        height: 100%;\n        width: 100%;\n        background-color: var(--internal-or-asset-viewer-background-color);\n    }\n   \n    *[hidden] {\n        display: none;\n    }\n    \n    #wrapper {\n        height: 100%;\n        width: 100%;\n        display: flex;\n        flex-direction: column;\n    }\n    \n    #wrapper.saving {\n        opacity: 0.5;\n        pointer-events: none;\n    }\n\n    #view-container, #edit-container {\n        flex: 0 1 auto;\n        overflow: auto;\n    }\n    \n    #view-container {\n        flex: 1;\n        margin-top: 0;\n        box-sizing: border-box;\n        display: flex;\n        flex-direction: row;\n        flex-wrap: wrap;\n        width: 100%;\n        padding: 0 15px 15px;\n\n        -webkit-animation: fadein 0.3s; /* Safari, Chrome and Opera > 12.1 */\n        -moz-animation: fadein 0.3s; /* Firefox < 16 */\n        -ms-animation: fadein 0.3s; /* Internet Explorer */\n        -o-animation: fadein 0.3s; /* Opera < 12.1 */\n        animation: fadein 0.3s;\n    }\n\n    #edit-container {\n        padding: 10px 20px 0;\n    }\n    \n    #name-input {\n        width: 300px;\n    }\n\n    @keyframes fadein {\n        from { opacity: 0; }\n        to   { opacity: 1; }\n    }\n\n    /* Firefox < 16 */\n    @-moz-keyframes fadein {\n        from { opacity: 0; }\n        to   { opacity: 1; }\n    }\n\n    /* Safari, Chrome and Opera > 12.1 */\n    @-webkit-keyframes fadein {\n        from { opacity: 0; }\n        to   { opacity: 1; }\n    }\n\n    /* Internet Explorer */\n    @-ms-keyframes fadein {\n        from { opacity: 0; }\n        to   { opacity: 1; }\n    }\n\n    /* Opera < 12.1 */\n    @-o-keyframes fadein {\n        from { opacity: 0; }\n        to   { opacity: 1; }\n    }\n\n    #asset-header {\n        padding: 20px 30px 15px;\n        display: flex;\n        flex: 0 0 auto;\n        align-items: center;\n        justify-content: space-between;\n        z-index: 1;\n        transition: box-shadow 0.2s;\n        box-shadow: none;\n    }\n\n    #asset-header.editmode {\n        padding: 14px 30px;\n        background-color: var(--internal-or-asset-viewer-panel-color);\n        border-bottom: solid 1px #e5e5e5;\n    }\n    #asset-header.scrolled {\n        box-shadow: rgb(0 0 0 / 15%) 0 0 5px 0;\n    }\n\n    #title {\n        flex: 1 1 auto;\n        font-size: 18px;\n        font-weight: bold;\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n        color: var(--internal-or-asset-viewer-title-text-color);\n    }\n\n    #title > or-icon {\n        margin-right: 10px;\n    }\n\n    #error-wrapper {\n        color: var(--internal-or-asset-viewer-error-color);\n    }\n\n    #error-wrapper > * {\n        vertical-align: middle;\n    }\n\n    #error-wrapper or-translate {\n        margin-left: 5px;\n    }\n   \n    #created-time {\n        font-size: 12px;\n    }\n    \n    #right-wrapper {\n        flex: 1 1 auto;\n        text-align: right;\n    }\n    \n    #edit-wrapper {\n        flex: 0 0 auto;\n    }\n\n    #edit-wrapper > or-translate {\n        margin-right: 10px;\n    }\n\n    #save-btn {\n        margin-left: 20px;\n    }\n\n    #edit-btn {\n        margin-left: 15px;\n    }\n    \n    #location-panel .panel-content {\n        height: 100%;\n    }\n    \n    #history-panel .panel-content {\n        position: relative;\n    }\n    \n    .msg {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        text-align: center;\n        height: 100%;\n    }\n    \n    .back-navigation {\n        display: none;\n        cursor: pointer;\n    }\n    \n    #fileupload {\n        display: flex;\n        align-items: center;\n        width: 100%;\n    }\n    \n    .hidden {\n        display: none;\n    }\n    \n    .multipleAssetsView {\n        display: flex;\n        flex-direction: column;\n    }\n\n    .multipleAssetsView > *:first-child {\n        margin: 30px;\n    }\n\n    @media screen and (max-width: 767px) {\n        #wrapper {\n            position: absolute;\n            left: 0;\n            right: 0;\n        }\n\n        .back-navigation {\n            display: block;\n        }\n        \n        .mobileHidden {\n            display: none;\n        }\n        \n        #asset-header {\n            padding: 15px 15px 15px;\n        }\n\n        #name-input {\n            width: auto;\n        }\n\n        #view-container {\n            padding: 0;\n        }\n\n        #edit-container {\n            padding: 10px 0;\n        }\n\n        .panelContainer {\n            min-width: 360px;\n            padding: 0;\n        }\n    }\n    \n    @media screen and (max-width: 1130px) {\n        #name-input {\n            width: 150px;\n        }\n\n        .tabletHidden {\n            display: none;\n        }\n\n        #view-container {\n            flex-direction: column;\n            flex-wrap: nowrap;\n        }\n\n        .panelContainer {\n            flex: 0 1 auto;\n        }\n    }\n\n`;","var __decorate=this&&this.__decorate||function(t,e,i,r){var a,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,r);else for(var n=t.length-1;n>=0;n--)(a=t[n])&&(o=(s<3?a(o):s>3?a(e,i,o):a(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o};import{html,LitElement,css}from\"lit\";import{customElement,property,query}from\"lit/decorators.js\";import{InputType}from\"@openremote/or-mwc-components/or-mwc-input\";import i18next from\"i18next\";import{AssetModelUtil}from\"@openremote/model\";import{Util}from\"@openremote/core\";import\"@openremote/or-mwc-components/or-mwc-input\";export class OrAddAttributePanelAttributeChangedEvent extends CustomEvent{constructor(t){super(OrAddAttributePanelAttributeChangedEvent.NAME,{bubbles:!0,composed:!1,detail:t})}}OrAddAttributePanelAttributeChangedEvent.NAME=\"or-add-attribute-panel-attribute-changed\";let OrAddAttributePanel=class extends LitElement{constructor(){super(...arguments),this.attribute={},this.isCustom=!1,this.isArray=!1,this.arrayDimensions=1,this.customAttribute=!0,this.arrayRegex=/\\[\\]/g}static get styles(){return css`                        \n            or-mwc-input {\n                width: 300px;\n                display: block;\n                padding: 10px 20px;\n            }`}shouldUpdate(t){var e,i;return t.has(\"asset\")&&(this.attributeTypes=void 0,this.attributeValueTypes=void 0,this.attributeTypes=((null===(e=AssetModelUtil.getAssetTypeInfo(this.asset.type))||void 0===e?void 0:e.attributeDescriptors)||[]).filter((t=>!this.asset.attributes[t.name])).sort(Util.sortByString((t=>t.name))).map((t=>[t.name,Util.getAttributeLabel(void 0,t,this.asset.type,!1)])),this.attributeTypes=[[\"@custom\",i18next.t(\"custom\")],...this.attributeTypes],this.attributeValueTypes=((null===(i=AssetModelUtil.getAssetTypeInfo(this.asset.type))||void 0===i?void 0:i.valueDescriptors)||[]).sort(Util.sortByString((t=>t[0]))).filter((t=>{const e=AssetModelUtil.getValueDescriptor(t);return!e||!e.metaUseOnly})).map((t=>[t,Util.getValueDescriptorLabel(t)]))),super.shouldUpdate(t)}render(){if(this.attributeTypes&&this.attributeValueTypes)return html`\n            <div id=\"attribute-creator\">\n                <or-mwc-input .type=\"${InputType.SELECT}\" .options=\"${this.attributeTypes}\" .label=\"${i18next.t(\"type\")}\" .value=\"${\"@custom\"}\" @or-mwc-input-changed=\"${t=>this.onTypeChanged(t.detail.value)}\"></or-mwc-input>\n                <or-mwc-input id=\"name-input\" .type=\"${InputType.TEXT}\" ?disabled=\"${!this.customAttribute}\" .value=\"${this.attribute&&this.attribute.name?this.attribute.name:void 0}\" .label=\"${i18next.t(\"name\")}\" pattern=\"\\\\w+\" required @keyup=\"${t=>this.onNameChanged(t.target.currentValue)}\" @or-mwc-input-changed=\"${t=>this.onNameChanged(t.detail.value)}\"></or-mwc-input>\n                <or-mwc-input id=\"type-input\" .type=\"${InputType.SELECT}\" ?disabled=\"${!this.customAttribute}\" .value=\"${this.attribute&&this.attribute.type?this.attribute.type.replace(this.arrayRegex,\"\"):void 0}\" .options=\"${this.attributeValueTypes}\" .label=\"${i18next.t(\"valueType\")}\" @or-mwc-input-changed=\"${t=>this.onValueTypeChanged(t.detail.value)}\"></or-mwc-input>\n                <or-mwc-input id=\"array-checkbox\" .type=\"${InputType.CHECKBOX}\" ?disabled=\"${!this.customAttribute}\" .value=\"${this.isArray}\" .label=\"${i18next.t(\"array\")}\" @or-mwc-input-changed=\"${t=>this.onArrayChanged(t.detail.value,1)}\"></or-mwc-input>\n                <or-mwc-input id=\"array-input\" .type=\"${InputType.NUMBER}\" ?disabled=\"${!this.isArray||!this.customAttribute}\" .value=\"${this.arrayDimensions}\" min=\"1\" max=\"2\" .label=\"${i18next.t(\"arrayDimensions\")}\" @or-mwc-input-changed=\"${t=>this.onArrayChanged(!0,t.detail.value)}\"></or-mwc-input>\n            </div>\n        `}onTypeChanged(t){if(\"@custom\"===t)this.customAttribute=!0,this.attribute={meta:{}};else{this.customAttribute=!1;const e=AssetModelUtil.getAttributeDescriptor(t,this.asset.type);this.attribute={},this.attribute.name=e.name,this.attribute.type=e.type,e.meta?this.attribute.meta=JSON.parse(JSON.stringify(e.meta)):this.attribute.meta={}}this.dispatchEvent(new OrAddAttributePanelAttributeChangedEvent(this.attribute))}onNameChanged(t){this.attribute.name=t,this.dispatchEvent(new OrAddAttributePanelAttributeChangedEvent(this.attribute))}onValueTypeChanged(t){this.attribute.type=t,this.updateAttributeType()}onArrayChanged(t,e){this.isArray=t,this.arrayDimensions=e,this.updateAttributeType()}updateAttributeType(){if(!this.attribute||!this.attribute.type)return;let t=this.attribute.type.replace(this.arrayRegex,\"\");if(this.isArray)for(let e=1;e<=this.arrayDimensions;e++)t+=\"[]\";this.attribute.type=t,this.dispatchEvent(new OrAddAttributePanelAttributeChangedEvent(this.attribute))}};__decorate([property({attribute:!1})],OrAddAttributePanel.prototype,\"asset\",void 0),__decorate([property({attribute:!1})],OrAddAttributePanel.prototype,\"attribute\",void 0),__decorate([property()],OrAddAttributePanel.prototype,\"isCustom\",void 0),__decorate([property()],OrAddAttributePanel.prototype,\"isArray\",void 0),__decorate([property()],OrAddAttributePanel.prototype,\"arrayDimensions\",void 0),__decorate([query(\"#array-input\")],OrAddAttributePanel.prototype,\"arrayInput\",void 0),OrAddAttributePanel=__decorate([customElement(\"or-add-attribute-panel\")],OrAddAttributePanel);export{OrAddAttributePanel};","var __decorate=this&&this.__decorate||function(t,e,a,i){var o,s=arguments.length,l=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)l=Reflect.decorate(t,e,a,i);else for(var r=t.length-1;r>=0;r--)(o=t[r])&&(l=(s<3?o(l):s>3?o(e,a,l):o(e,a))||l);return s>3&&l&&Object.defineProperty(e,a,l),l};import{css,html,LitElement,unsafeCSS}from\"lit\";import{until}from\"lit/directives/until.js\";import{customElement,property}from\"lit/decorators.js\";import{InputType,getValueHolderInputTemplateProvider}from\"@openremote/or-mwc-components/or-mwc-input\";import i18next from\"i18next\";import{AssetModelUtil}from\"@openremote/model\";import{DefaultColor5,DefaultColor3,Util}from\"@openremote/core\";import\"@openremote/or-mwc-components/or-mwc-input\";import{showDialog,OrMwcDialog}from\"@openremote/or-mwc-components/or-mwc-dialog\";import{ListType}from\"@openremote/or-mwc-components/or-mwc-list\";import\"./or-add-attribute-panel\";import{getField,getPanel,getPropertyTemplate}from\"./index\";import{panelStyles}from\"./style\";import{jsonFormsInputTemplateProvider}from\"@openremote/or-attribute-input\";import{createRef,ref}from\"lit/directives/ref.js\";const tableStyle=require(\"@material/data-table/dist/mdc.data-table.css\"),style=css`\n    .panel {\n        margin: 10px auto;\n        max-width: 1200px;\n    }\n\n    #parent-edit-wrapper {\n        display: flex;\n        align-items: center;\n    }\n    \n    #parent-edit-wrapper > #property-parentId {\n        width: 100%;\n    }\n    \n    #change-parent-btn {\n        margin-left: 20px;\n    }\n\n    .mdc-data-table__row:hover {\n        background-color: inherit !important;\n    }\n\n    .mdc-data-table__row {\n        border-top-color: #D3D3D3;\n    }\n\n    #attribute-table {\n        width: 100%;\n    }\n\n    .mdc-data-table__table {\n        width: 100%;\n    }\n    .mdc-data-table__header-cell {\n        font-weight: 500;\n        color: ${unsafeCSS(DefaultColor3)};\n    }\n\n    .mdc-data-table__header-cell:first-child {\n        padding-left: 36px;\n    }\n    .expander-cell {\n        --or-icon-width: 20px;\n        --or-icon-height: 20px;\n        cursor: pointer;\n    }\n    .expander-cell > * {\n        pointer-events: none;\n    }\n    .expander-cell > or-icon {\n        vertical-align: middle;\n        margin-right: 6px;\n        margin-left: -5px;\n    }\n    .padded-cell {\n        padding: 10px 16px;\n    }\n    .padded-cell > or-attribute-input {\n        width: 100%;\n    }\n    .actions-cell {\n        text-align: right;\n        width: 40px;\n        padding-right: 4px;\n    }\n    .meta-item-container {\n        padding: 0 4px 0 24px;\n        overflow: hidden;\n        max-height: 0;\n        transition: max-height 0.25s ease-out;\n    }\n    .attribute-meta-row.expanded  .meta-item-container {\n        transition: max-height 1s ease-in;\n    }\n    .meta-item-container or-mwc-input {\n        width: 100%;\n    }\n    .meta-item-wrapper {\n        display: flex;\n        margin: 10px 0;\n    }\n    .meta-item-wrapper:first-child {\n        margin-top: 0;\n    }\n    .meta-item-wrapper:hover .button-clear {\n        visibility: visible;                    \n    }\n    .item-add {\n        margin-bottom: 10px;                \n    }\n    .item-add-attribute {\n        margin: 10px 0px 10px 4px;\n    }\n    .button-clear {\n        background: none;\n        color: ${unsafeCSS(DefaultColor5)};\n        --or-icon-fill: ${unsafeCSS(DefaultColor5)};\n        visibility: hidden;\n        display: inline-block;\n        border: none;\n        padding: 0 0 0 4px;\n        cursor: pointer;\n    }                \n    .button-clear:hover {\n        --or-icon-fill: var(--internal-or-asset-viewer-button-color);\n    }                \n    .button-clear:focus {\n        outline: 0;\n    }                \n    .button-clear.hidden {\n        visibility: hidden;\n    }\n    .overflow-visible {\n        overflow: visible;\n    }\n`;export class OrEditAssetModifiedEvent extends CustomEvent{constructor(t){super(OrEditAssetModifiedEvent.NAME,{bubbles:!0,composed:!0,detail:t})}}OrEditAssetModifiedEvent.NAME=\"or-edit-asset-modified\";const AssetNameRegex=/^\\w+$/;let OrEditAssetPanel=class extends LitElement{constructor(){super(...arguments),this.attributeTemplatesAndValidators=[],this.changedAttributes=[]}static get styles(){return[unsafeCSS(tableStyle),panelStyles,style]}attributeUpdated(t){this.asset&&(this.changedAttributes.push(t),this.requestUpdate())}shouldUpdate(t){return t.has(\"asset\")&&(this.changedAttributes=[]),super.shouldUpdate(t)}render(){const t=t=>{this.asset.accessPublicRead=t,this._onModified()},e=[getField(\"type\",void 0,getPropertyTemplate(this.asset,\"type\",this,void 0,void 0,{readonly:!0,label:i18next.t(\"assetType\")})),getField(\"parent\",void 0,this._getParentTemplate()),html`<div @or-mwc-input-changed=\"${e=>t(e.detail.value)}\">\n                    ${getField(\"accessPublicRead\",void 0,getPropertyTemplate(this.asset,\"accessPublicRead\",this,void 0,void 0,{readonly:!1,label:i18next.t(\"accessPublicRead\")}))}\n                </div>`];this.attributeTemplatesAndValidators=this.asset.attributes?Object.entries(this.asset.attributes).sort(Util.sortByString((([t,e])=>t.toUpperCase()))).map((([t,e])=>(e.name=t,this._getAttributeTemplate(this.asset.type,e)))):[];const a=html`\n            <div id=\"attribute-table\" class=\"mdc-data-table\">\n                <table class=\"mdc-data-table__table\" aria-label=\"attribute list\" @click=\"${t=>{const e=t.target;if(e.className.indexOf(\"expander-cell\")<0||e.className.indexOf(\"expanding\")>=0)return;const a=e.getElementsByTagName(\"or-icon\")[0],i=e.parentElement,o=i.parentElement.rows[i.rowIndex],s=o.firstElementChild.firstElementChild,l=Math.max(500,s.firstElementChild.getBoundingClientRect().height);\"chevron-right\"===a.icon?(a.icon=\"chevron-down\",o.classList.add(\"expanded\"),s.style.maxHeight=l+\"px\",e.classList.add(\"expanding\"),window.setTimeout((()=>{e.classList.remove(\"expanding\"),s.style.maxHeight=\"unset\"}),1100)):(a.icon=\"chevron-right\",o.classList.remove(\"expanded\"),s.style.transition=\"none\",s.style.maxHeight=Math.max(500,s.firstElementChild.getBoundingClientRect().height)+\"px\",window.setTimeout((()=>{s.style.transition=\"\",s.style.maxHeight=\"\"})))}}\">\n                    <colgroup>\n                        <col span=\"1\" style=\"width: 25%;\">\n                        <col span=\"1\" style=\"width: 25%;\">\n                        <col span=\"1\" style=\"width: 35%;\">\n                        <col span=\"1\" style=\"width: 15%;\">\n                    </colgroup>\n                    <thead>\n                        <tr class=\"mdc-data-table__header-row\">\n                            <th class=\"mdc-data-table__header-cell\" role=\"columnheader\" scope=\"col\"><or-translate value=\"name\"></or-translate></th>\n                            <th class=\"mdc-data-table__header-cell\" role=\"columnheader\" scope=\"col\"><or-translate value=\"type\"></or-translate></th>\n                            <th class=\"mdc-data-table__header-cell\" role=\"columnheader\" scope=\"col\"><or-translate value=\"value\"></or-translate></th>\n                            <th class=\"mdc-data-table__header-cell\" role=\"columnheader\" scope=\"col\"></or-translate></th>\n                        </tr>\n                    </thead>\n                    <tbody class=\"mdc-data-table__content\">\n                        ${this.attributeTemplatesAndValidators.map((t=>t.template))}\n                        <tr class=\"mdc-data-table__row\">\n                            <td colspan=\"4\">\n                                <div class=\"item-add-attribute\">\n                                    <or-mwc-input .type=\"${InputType.BUTTON}\" label=\"addAttribute\" icon=\"plus\" @or-mwc-input-changed=\"${()=>this._addAttribute()}\"></or-mwc-input>\n                                </div>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        `;return html`\n            <div id=\"edit-wrapper\">\n                ${getPanel(\"0\",{type:\"info\",title:\"properties\"},html`${e}`)||\"\"}\n                ${getPanel(\"1\",{type:\"info\",title:\"attribute_plural\"},html`${a}`)||\"\"}\n            </div>\n        `}_getAttributeTemplate(t,e){const a=AssetModelUtil.getAttributeDescriptor(e.name,t),i=!a||a.optional,o=createRef(),s=e.meta?Object.entries(e.meta).sort(Util.sortByString((([t,e])=>t))).map((([t,a])=>this._getMetaItemTemplate(e,Util.getMetaItemNameValueHolder(t,a)))):[];return{template:html`\n            <tr class=\"mdc-data-table__row\">\n                <td class=\"padded-cell mdc-data-table__cell expander-cell\"><or-icon icon=\"chevron-right\"></or-icon><span>${e.name}</span></td>\n                <td class=\"padded-cell mdc-data-table__cell\">${Util.getValueDescriptorLabel(e.type)}</td>\n                <td class=\"padded-cell overflow-visible mdc-data-table__cell\">\n                    <or-attribute-input ${ref(o)} \n                                        .comfortable=\"${!0}\" .assetType=\"${t}\" .label=${null} \n                                        .readonly=\"${!1}\" .attribute=\"${e}\" .assetId=\"${this.asset.id}\" \n                                        disableWrite disableSubscribe disableButton compact \n                                        @or-attribute-input-changed=\"${t=>this._onAttributeModified(e,t.detail.value)}\"></or-attribute-input>\n                </td>\n                <td class=\"padded-cell mdc-data-table__cell actions-cell\">${i?html`<or-mwc-input type=\"${InputType.BUTTON}\" icon=\"delete\" @click=\"${()=>{delete this.asset.attributes[e.name],this._onModified()}}\">`:\"\"}</td>\n            </tr>\n            <tr class=\"attribute-meta-row\">\n                <td colspan=\"4\">\n                    <div class=\"meta-item-container\">\n                        <div>\n                            <div>\n                                ${s.map((t=>t.template))}\n                            </div>\n                            <div class=\"item-add\">\n                                <or-mwc-input .type=\"${InputType.BUTTON}\" label=\"addMetaItems\" icon=\"plus\" @or-mwc-input-changed=\"${()=>this._addMetaItems(e)}\"></or-mwc-input>\n                            </div>\n                        </div>\n                    </div>                     \n                </td>\n            </tr>\n        `,validator:()=>{let t=!1;return o.value&&(t=o.value.checkValidity()),{name:e.name,valid:t,metaResults:s.map((t=>t.validator()))}}}}_onModified(){this.dispatchEvent(new OrEditAssetModifiedEvent(this.validate())),this.requestUpdate()}validate(){return this.attributeTemplatesAndValidators.map((t=>t.validator()))}_onAttributeModified(t,e){const a=this.changedAttributes.indexOf(t.name);a>-1?this.changedAttributes.splice(a,1):(t.value=e,t.timestamp=void 0,this._onModified())}_onMetaItemModified(t,e,a){e.value=a?a.value:void 0,t.meta[e.name]=e.value,this._onModified()}_getMetaItemTemplate(t,e){const a=AssetModelUtil.getMetaItemDescriptor(e.name),i=a?AssetModelUtil.getValueDescriptor(a.type):void 0;let o=html``,s=()=>({name:e.name,valid:!0});if(i){const l={label:Util.getMetaLabel(e,a,this.asset.type,!0),resizeVertical:!0},r=getValueHolderInputTemplateProvider(this.asset.type,e,a,i,(a=>this._onMetaItemModified(t,e,a)),l);let n=jsonFormsInputTemplateProvider(r)(this.asset.type,e,a,i,(a=>this._onMetaItemModified(t,e,a)),l);n||(n=r),n&&n.templateFunction&&(o=html`${until(n.templateFunction(e.value,!1,!1,!1,!1,void 0),\"\")}`),n.validator&&(s=()=>({name:e.name,valid:n.validator()}))}else console.log(\"Couldn't find value descriptor for meta item so falling back to simple JSON input: \"+e.name),o=html`<or-mwc-input @or-mwc-input-changed=\"${a=>this._onMetaItemModified(t,e,a.detail)}\" .type=\"${InputType.JSON}\" .value=\"${e.value}\"></or-mwc-input>`;return{template:html`\n            <div class=\"meta-item-wrapper\">\n                ${o}\n                <button class=\"button-clear\" @click=\"${()=>{delete t.meta[e.name],this._onModified()}}\">\n                    <or-icon icon=\"close-circle\"></or-icon>\n                    </input>\n            </div>\n        `,validator:s}}_addAttribute(){const t=this.asset;let e;const a=e=>!(e&&e.name&&!t.attributes[e.name]&&AssetNameRegex.test(e.name)&&e.type),i=showDialog((new OrMwcDialog).setContent(html`\n                <or-add-attribute-panel .asset=\"${t}\" @or-add-attribute-panel-attribute-changed=\"${t=>(t=>{const o=a(t);i.shadowRoot.getElementById(\"add-btn\").disabled=o,e=t})(t.detail)}\"></or-add-attribute-panel>\n            `).setStyles(html`\n                <style>\n                    .mdc-dialog__surface {\n                        overflow-x: visible !important;\n                        overflow-y: visible !important;\n                    }\n                    #dialog-content {\n                        padding: 0;\n                        overflow: visible;\n                    }\n                </style>\n            `).setHeading(i18next.t(\"addAttribute\")).setActions([{actionName:\"cancel\",content:\"cancel\"},{default:!0,actionName:\"add\",action:()=>{e&&(this.asset.attributes[e.name]=e,this._onModified())},content:html`<or-mwc-input id=\"add-btn\" .type=\"${InputType.BUTTON}\" disabled label=\"add\"\n                                    @or-mwc-input-changed=\"${t=>{if(a(e))return t.stopPropagation(),!1}}\"></or-mwc-input>`}]).setDismissAction(null))}_addMetaItems(t){const e=AssetModelUtil.getAssetTypeInfo(this.asset.type);if(!e||!e.metaItemDescriptors)return;const a=t.meta||{},i=e.metaItemDescriptors.map((t=>AssetModelUtil.getMetaItemDescriptor(t))).filter((t=>!a.hasOwnProperty(t.name))).map((t=>({text:Util.getMetaLabel(void 0,t,this.asset.type,!0),value:t.name,translate:!1}))).sort(Util.sortByString((t=>t.text))),o=showDialog((new OrMwcDialog).setContent(html`\n                <div id=\"meta-creator\">\n                    <or-mwc-list id=\"meta-creator-list\" .type=\"${ListType.MULTI_CHECKBOX}\" .listItems=\"${i}\"></or-mwc-list>\n                </div>\n            `).setStyles(html`\n                <style>\n                    #meta-creator {\n                        height: 600px;\n                        max-height: 100%;\n                    }\n                    \n                    #meta-creator > or-mwc-list {\n                        height: 100%;\n                    }\n\n                    .mdc-dialog .mdc-dialog__content {\n                        padding: 0 !important;\n                    }\n                </style>\n            `).setHeading(i18next.t(\"addMetaItems\")).setActions([{actionName:\"cancel\",content:\"cancel\"},{default:!0,actionName:\"add\",action:()=>{const e=o.shadowRoot.getElementById(\"meta-creator-list\"),a=e?e.selectedItems:void 0;a&&(t.meta||(t.meta={}),a.forEach((e=>{const a=AssetModelUtil.getMetaItemDescriptors().find((t=>t.name===e.value));a&&(t.meta[a.name]=\"boolean\"===a.type||null,this._onModified())})))},content:\"add\"}]).setDismissAction(null))}_getParentTemplate(){let t;const e=t=>{t.stopPropagation()},a=html`<or-asset-tree id=\"parent-asset-tree\" disableSubscribe readonly .selectedIds=\"${this.asset.parentId?[this.asset.parentId]:[]}\" @or-asset-tree-request-select=\"${e}\" @or-asset-tree-selection-changed=\"${e}\" .selector=\"${t=>t.asset.id!==this.asset.id}\"></or-asset-tree>`,i=[{actionName:\"clear\",content:\"none\",action:()=>{this.asset.parentId=void 0,this.asset.path=[this.asset.id],this._onModified()}},{actionName:\"ok\",content:\"ok\",action:()=>{const e=t.shadowRoot.getElementById(\"parent-asset-tree\");this.asset.parentId=1===e.selectedIds.length?e.selectedIds[0]:void 0;const a=[this.asset.id];let i=e.selectedNodes[0];for(;void 0!==i;)a.unshift(i.asset.id),i=i.parent;this.asset.path=a,this._onModified()}},{default:!0,actionName:\"cancel\",content:\"cancel\"}];return html`\n            <div id=\"parent-edit-wrapper\">\n                ${getPropertyTemplate(this.asset,\"parentId\",this,void 0,void 0,{readonly:!0,label:i18next.t(\"parent\")})}\n                <or-mwc-input id=\"change-parent-btn\" type=\"${InputType.BUTTON}\" outlined label=\"edit\" @or-mwc-input-changed=\"${()=>{t=showDialog((new OrMwcDialog).setContent(a).setActions(i).setStyles(html`\n                        <style>\n                            .mdc-dialog__surface {\n                                width: 400px;\n                                height: 800px;\n                                display: flex;\n                                overflow: visible;\n                                overflow-x: visible !important;\n                                overflow-y: visible !important;\n                            }\n                            #dialog-content {\n                                flex: 1;    \n                                overflow: visible;\n                                min-height: 0;\n                                padding: 0;\n                            }\n                            footer.mdc-dialog__actions {\n                                border-top: 1px solid ${unsafeCSS(DefaultColor5)};\n                            }\n                            or-asset-tree {\n                                height: 100%;\n                            }\n                        </style>\n                    `).setHeading(i18next.t(\"setParent\")).setDismissAction(null))}}\"></or-mwc-input>\n            </div>\n        `}};__decorate([property({attribute:!1})],OrEditAssetPanel.prototype,\"asset\",void 0),OrEditAssetPanel=__decorate([customElement(\"or-edit-asset-panel\")],OrEditAssetPanel);export{OrEditAssetPanel};","var __decorate=this&&this.__decorate||function(e,t,s,i){var o,r=arguments.length,n=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(r<3?o(n):r>3?o(t,s,n):o(t,s))||n);return r>3&&n&&Object.defineProperty(t,s,n),n},__awaiter=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(o,r){function n(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,a)}l((i=i.apply(e,t||[])).next())}))};import{html,LitElement,unsafeCSS}from\"lit\";import{customElement,property,query,state}from\"lit/decorators.js\";import\"@openremote/or-icon\";import\"@openremote/or-mwc-components/or-mwc-input\";import\"@openremote/or-attribute-input\";import\"@openremote/or-attribute-history\";import\"@openremote/or-chart\";import\"@openremote/or-mwc-components/or-mwc-table\";import\"@openremote/or-components/or-panel\";import\"@openremote/or-mwc-components/or-mwc-dialog\";import{OrMwcDialog,showDialog,showOkCancelDialog,showOkDialog}from\"@openremote/or-mwc-components/or-mwc-dialog\";import\"@openremote/or-mwc-components/or-mwc-list\";import{translate}from\"@openremote/or-translate\";import{InputType}from\"@openremote/or-mwc-components/or-mwc-input\";import manager,{subscribe,Util,DefaultColor5}from\"@openremote/core\";import{AssetModelUtil}from\"@openremote/model\";import{panelStyles,style}from\"./style\";import i18next from\"i18next\";import{styleMap}from\"lit/directives/style-map.js\";import{classMap}from\"lit/directives/class-map.js\";import\"./or-edit-asset-panel\";import{OrEditAssetModifiedEvent}from\"./or-edit-asset-panel\";import\"@openremote/or-mwc-components/or-mwc-snackbar\";import{showSnackbar}from\"@openremote/or-mwc-components/or-mwc-snackbar\";import{progressCircular}from\"@openremote/or-mwc-components/style\";export function getIncludedProperties(e){const t=e&&e.properties&&e.properties.include?e.properties.include:DEFAULT_ASSET_PROPERTIES,s=e&&e.properties&&e.properties.exclude?e.properties.exclude:[];return t.filter((e=>!s||s.indexOf(e)<0))}export function getIncludedAttributes(e,t){const s=t&&t.attributes&&t.attributes.include?t.attributes.include:void 0,i=t&&t.attributes&&t.attributes.exclude?t.attributes.exclude:void 0;return s||i?Object.values(e).filter((e=>(!s||s.some((t=>Util.stringMatch(t,e.name))))&&(!i||!i.some((t=>Util.stringMatch(t,e.name)))))):Object.values(e)}export class OrAssetViewerComputeGridEvent extends CustomEvent{constructor(){super(OrAssetViewerComputeGridEvent.NAME,{bubbles:!0,composed:!0})}}OrAssetViewerComputeGridEvent.NAME=\"or-asset-viewer-compute-grid-event\";export class OrAssetViewerRequestSaveEvent extends CustomEvent{constructor(e){super(OrAssetViewerRequestSaveEvent.NAME,{bubbles:!0,composed:!0,detail:{allow:!0,detail:e}})}}OrAssetViewerRequestSaveEvent.NAME=\"or-asset-viewer-request-save\";export class OrAssetViewerSaveEvent extends CustomEvent{constructor(e){super(OrAssetViewerSaveEvent.NAME,{bubbles:!0,composed:!0,detail:e})}}OrAssetViewerSaveEvent.NAME=\"or-asset-viewer-save\";export class OrAssetViewerChangeParentEvent extends CustomEvent{constructor(e,t){super(OrAssetViewerChangeParentEvent.NAME,{bubbles:!0,composed:!0,detail:{parentId:e,assetsIds:t}})}}OrAssetViewerChangeParentEvent.NAME=\"or-asset-viewer-change-parent\";export class OrAssetViewerRequestEditToggleEvent extends CustomEvent{constructor(e){super(OrAssetViewerRequestEditToggleEvent.NAME,{bubbles:!0,composed:!0,detail:{allow:!0,detail:e}})}}OrAssetViewerRequestEditToggleEvent.NAME=\"or-asset-viewer-request-edit-toggle\";export class OrAssetViewerEditToggleEvent extends CustomEvent{constructor(e){super(OrAssetViewerEditToggleEvent.NAME,{bubbles:!0,composed:!0,detail:e})}}OrAssetViewerEditToggleEvent.NAME=\"or-asset-viewer-edit-toggle\";export class OrAssetViewerLoadUserEvent extends CustomEvent{constructor(e){super(OrAssetViewerLoadUserEvent.NAME,{bubbles:!0,composed:!0,detail:e})}}OrAssetViewerLoadUserEvent.NAME=\"or-asset-viewer-load-user-event\";export function getPanel(e,t,s){if(s)return html`\n        <div class=${classMap({panel:!0,mobileHidden:!0===t.hideOnMobile})} style=\"${t&&t.panelStyles?styleMap(t.panelStyles):\"\"}\" id=\"${e}-panel\">\n            <div class=\"panel-content-wrapper\">\n                <div class=\"panel-title\">\n                    <or-translate value=\"${t.title||t.type}\"></or-translate>\n                </div>\n                <div class=\"panel-content\">\n                    ${s}\n                </div>\n            </div>\n        </div>\n    `}function getPanelContent(e,t,s,i,o){var r;const n=t.asset;if(i.panelViewProvider){const t=i.panelViewProvider(n,n.attributes,e,s,i,o);if(t)return t}if(o){if(\"info\"===o.type){const e=o,r=getIncludedProperties(e),a=getIncludedAttributes(n.attributes,e);if(0===r.length&&0===a.length)return;const l=[];r.forEach((t=>{const s=e.properties&&e.properties.itemConfig?e.properties.itemConfig[t]:{};void 0===s.label&&(s.label=i18next.t(t)),s.priority=s.priority||0,l.push({item:t,itemConfig:s})})),a.forEach((t=>{const s=e.attributes&&e.attributes.itemConfig&&e.attributes.itemConfig[t.name]?e.attributes.itemConfig[t.name]:{};if(void 0===s.label){const e=AssetModelUtil.getAttributeAndValueDescriptors(n.type,t.name,t);s.label=Util.getAttributeLabel(t,e[0],n.type,!0)}s.priority=s.priority||0,l.push({item:t,itemConfig:s})}));const d=Util.sortByString((e=>e.itemConfig.label.toUpperCase()));return l.sort(((e,t)=>{const s=e.itemConfig.priority,i=t.itemConfig.priority;return s<i?1:s>i?-1:d(e,t)})),html`\n            ${l.map((e=>{if(\"string\"==typeof e.item)return getField(e.item,e.itemConfig,getPropertyTemplate(n,e.item,s,i,o,e.itemConfig));{if(t.attributeTemplateMap[e.item.name])return getField(e.item.name,e.itemConfig,t.attributeTemplateMap[e.item.name]);const r=getAttributeTemplate(n,e.item,s,i,o,e.itemConfig);return t.attributeTemplateMap[e.item.name]=r,getField(e.item.name,e.itemConfig,r)}}))}`}if(\"setup\"===o.type){const e=AssetModelUtil.getAssetDescriptor(n.type);if(!e||!n.id||\"agent\"!==e.descriptorType||!e.assetDiscovery&&!e.assetImport)return;const t=()=>{const e=s.shadowRoot.getElementById(\"fileupload-elem\"),t=s.shadowRoot.getElementById(\"filename-elem\"),i=s.shadowRoot.getElementById(\"fileupload-btn\"),o=e.value;if(!o)return;let r;i.disabled=!1,o.lastIndexOf(\"\\\\\")?r=o.lastIndexOf(\"\\\\\")+1:o.lastIndexOf(\"/\")&&(r=o.lastIndexOf(\"/\")+1),t.value=o.slice(r,o.length)},i=()=>{const e=s.shadowRoot.getElementById(\"discover-btn\"),t=s.shadowRoot.getElementById(\"cancel-discover-btn\");if(!e||!t)return!1;t.hidden=!1,e.disabled=!0,e.label=i18next.t(\"discovering\")+\"...\",manager.rest.api.AgentResource.doProtocolAssetDiscovery(n.id).then((e=>{200!==e.status?showSnackbar(void 0,\"somethingWentWrong\",\"dismiss\"):(showSnackbar(void 0,\"Import successful! Added \"+e.data.length+\" assets!\",\"dismiss\"),console.info(e.data,e))})).catch((e=>{showSnackbar(void 0,\"somethingWentWrong\",\"dismiss\"),console.error(e)})).finally((()=>{t.hidden=!0,e.disabled=!1,e.label=i18next.t(\"discoverAssets\")}))},o=()=>{const e=s.shadowRoot.getElementById(\"discover-btn\"),t=s.shadowRoot.getElementById(\"cancel-discover-btn\");e.disabled=!1,e.label=i18next.t(\"discoverAssets\"),t.hidden=!0},r=()=>{const e=s.shadowRoot.getElementById(\"filename-elem\"),t=s.shadowRoot.getElementById(\"fileupload-btn\"),i=s.shadowRoot.getElementById(\"progress-circular\");if(!t||!i)return!1;t.disabled=!0,t.classList.add(\"hidden\"),i.classList.remove(\"hidden\");const o=s.shadowRoot.getElementById(\"fileupload-elem\");if(o){const s=new FileReader;o.files&&o.files.length&&s.readAsDataURL(o.files[0]),s.onload=()=>{if(s.result){let o=s.result.toString().replace(/^data:(.*,)?/,\"\");o.length%4>0&&(o+=\"=\".repeat(4-o.length%4));const r={name:\"filename\",contents:o,binary:!0};manager.rest.api.AgentResource.doProtocolAssetImport(n.id,r,void 0,{timeout:3e4}).then((e=>{200!==e.status?showSnackbar(void 0,\"somethingWentWrong\",\"dismiss\"):(showSnackbar(void 0,\"Import successful! Added \"+e.data.length+\" assets!\",\"dismiss\"),console.info(e.data,e))})).catch((e=>{showSnackbar(void 0,\"somethingWentWrong\",\"dismiss\"),console.error(e)})).finally((()=>{e.value=\"\",t.disabled=!0,t.classList.remove(\"hidden\"),i.classList.add(\"hidden\")}))}else showSnackbar(void 0,\"somethingWentWrong\",\"dismiss\"),console.error(s)}}};let a=html``;return e.assetImport?a=html`\n                <div id=\"fileupload\">\n                    <or-mwc-input style=\"flex: 0 1 auto;\" outlined label=\"selectFile\" .type=\"${InputType.BUTTON}\" @or-mwc-input-changed=\"${()=>s.shadowRoot.getElementById(\"fileupload-elem\").click()}\">\n                        <input id=\"fileupload-elem\" name=\"configfile\" type=\"file\" accept=\".*\" @change=\"${()=>t()}\"/>\n                    </or-mwc-input>\n                    <or-mwc-input style=\"flex: 1 1 auto; margin: 0 4px 0 10px;\" id=\"filename-elem\" .label=\"${i18next.t(\"file\")}\" .type=\"${InputType.TEXT}\" disabled></or-mwc-input>\n                    <or-mwc-input style=\"flex: 0 1 auto;\" id=\"fileupload-btn\" icon=\"upload\" .type=\"${InputType.BUTTON}\" @or-mwc-input-changed=\"${()=>r()}\" disabled></or-mwc-input>\n                    <progress id=\"progress-circular\" class=\"hidden pure-material-progress-circular\"></progress>\n                </div>\n            `:e.assetDiscovery?a=html`\n                <or-mwc-input outlined id=\"discover-btn\" .type=\"${InputType.BUTTON}\" label=\"discoverAssets\" @or-mwc-input-changed=\"${()=>i()}\"></or-mwc-input>\n                <or-mwc-input id=\"cancel-discover-btn\" .type=\"${InputType.BUTTON}\" label=\"cancel\" @or-mwc-input-changed=\"${()=>o()}\" hidden style=\"margin-left:20px\"></or-mwc-input>\n            `:showSnackbar(void 0,\"agent type doesn't support a known protocol to add assets\",\"dismiss\"),html`\n            <style>\n                [hidden] {\n                    display: none;\n                }\n            </style>\n            ${a}\n        `}if(\"history\"===o.type){const e=o,a=e.include?e.include:void 0,l=e.exclude?e.exclude:[],d=Object.values(null===(r=null==t?void 0:t.asset)||void 0===r?void 0:r.attributes).filter((e=>(!a||a.indexOf(e.name)>=0)&&(!l||l.indexOf(e.name)<0)&&e.meta&&(e.meta.hasOwnProperty(\"storeDataPoints\")?e.meta.storeDataPoints:e.meta.hasOwnProperty(\"agentLink\"))));if(0===d.length)return;let c;const p=e=>{if(s.shadowRoot){const t=s.shadowRoot.getElementById(\"attribute-history\");if(e&&t){let s=n.attributes&&n.attributes[e];const i=AssetModelUtil.getAttributeAndValueDescriptors(n.type,s.name,s);Util.getAttributeLabel(s,i[0],n.type,!0),t.attribute=s,c=s}}},u=d.map((e=>{const t=AssetModelUtil.getAttributeAndValueDescriptors(n.type,e.name,e),s=Util.getAttributeLabel(e,t[0],n.type,!0);return[e.name,s]})).sort(Util.sortByString((e=>void 0===e[1]?e[0]:e[1])));let m=html`\n                <div id=\"attribute-picker\">\n                    <or-mwc-input .checkAssetWrite=\"${!1}\" .label=\"${i18next.t(\"attribute\")}\" @or-mwc-input-changed=\"${e=>p(e.detail.value)}\" .type=\"${InputType.SELECT}\" .options=\"${u}\"></or-mwc-input>\n                </div>`;return html`\n            <style>\n               #attribute-picker {\n                   flex: 0;\n                   margin: 0 0 10px 0;\n                   position: unset;\n               }\n               \n               #attribute-picker > or-mwc-input {\n                   width: 250px;\n               }\n                \n                or-attribute-history {\n                    width: 100%;\n                    --or-attribute-history-controls-margin: 0 0 10px -5px;\n                    --or-attribute-history-controls-justify-content: flex-start;\n                }\n\n               @media screen and (min-width: 1900px) {\n                   #attribute-picker {\n                       position: absolute;\n                   }\n\n                   or-attribute-history {\n                       --or-attribute-history-controls-margin: 0 0 10px 0;\n                       --or-attribute-history-controls-justify-content: flex-end;\n                       min-height: 70px;\n                   }\n               }\n            </style>\n            ${m}\n            <or-attribute-history id=\"attribute-history\" .config=\"${i.historyConfig}\" .assetType=\"${n.type}\" .assetId=\"${n.id}\"></or-attribute-history>\n        `}if(\"group\"===o.type){if(!n.id||\"GroupAsset\"!==n.type)return;const i=t.childAssets;if(!i||0===i.length)return;const r=n.attributes&&n.attributes.childAssetType,a=o;if(!r||\"string\"!=typeof r.value)return;const l=r.value;let d=[],c=[];a.childAssetTypes&&a.childAssetTypes[l]&&(d=a.childAssetTypes[l].availableAttributes?a.childAssetTypes[l].availableAttributes:[],c=a.childAssetTypes[l].selectedAttributes?a.childAssetTypes[l].selectedAttributes:[]);const p=t=>{c.length=0,c.push(...t);const i=s.shadowRoot.getElementById(e+\"-attribute-table\"),o=m();i.columns=o[0],i.rows=o[1],u.views[n.id]=[...c],manager.console.storeData(\"OrAssetConfig\",u)};let u;if(manager.console.retrieveData(\"OrAssetConfig\").then((e=>{u=e,u||(u={views:{}}),u.views||(u.views={});const t=u.views[n.id];t&&p([...t])})),0===d.length){const e=AssetModelUtil.getAssetTypeInfo(l);e&&e.attributeDescriptors&&(d=e.attributeDescriptors.map((e=>e.name)))}c&&0!==c.length||!d||(c=[...new Set(i.map((e=>Object.keys(e.attributes))).flat())]);const m=()=>{const e=[...c].sort(),t=e.map((e=>{const t=AssetModelUtil.getAttributeDescriptor(e,l);return Util.getAttributeLabel(void 0,t,n.type,!1)})),s=i.map((t=>{const s=e.map((e=>{const s=AssetModelUtil.getAttributeDescriptor(e,l);return t.attributes[e]?Util.getAttributeValueAsString(t.attributes[e],s,n.type,!1):\"\"}));return s.unshift(t.name),s}));return t.unshift(i18next.t(\"groupAssetName\")),[t,s]},h=()=>{const e=[...c];showOkCancelDialog(i18next.t(\"addRemoveAttributes\"),html`\n                    <div style=\"display: flex; flex-direction: column;\">\n                        ${d.sort().map((t=>html`\n                            <or-mwc-input .type=\"${InputType.CHECKBOX}\" .label=\"${i18next.t(Util.camelCaseToSentenceCase(t))}\" style=\"display: inline-flex;\"\n                                          .value=\"${!!c.find((e=>e===t))}\" \n                                          @or-mwc-input-changed=\"${s=>s.detail.value?e.push(t):e.splice(e.findIndex((e=>e===t)),1)}\"\n                            ></or-mwc-input>\n                        `))}\n                    </div>\n                `).then((t=>{t&&p(e)}))},v=m();return html`\n                <style>\n                    .asset-group-add-remove-button {\n                        position: absolute;\n                        --or-mwc-input-color: currentColor;\n                        top: calc(var(--internal-or-asset-viewer-panel-padding) - 15px);\n                        right: calc(var(--internal-or-asset-viewer-panel-padding) - 15px);\n                    }\n                    .asset-group-add-remove-button.active {\n                        cursor: pointer;\n                        opacity: 1;\n                    }\n                </style>\n                <or-mwc-input .type=\"${InputType.BUTTON}\" class=\"asset-group-add-remove-button\" icon=\"pencil\" @click=\"${()=>h()}\"></or-mwc-input>\n                <or-mwc-table .columns=\"${v[0]}\" .rows=\"${v[1]}\" .id=\"${e}-attribute-table\" .config=\"${{stickyFirstColumn:!0}}\"></or-mwc-table>\n            `}if(\"linkedUsers\"===o.type){const e=manager.hasRole(\"read:admin\"),i=t.userAssetLinks;if(!e)return;if(!i||0===i.length)return;const o=[i18next.t(\"username\"),i18next.t(\"roles\"),i18next.t(\"restrictedUser\")],r=i.sort(Util.sortByString((e=>e.usernameAndId))).map((e=>[e.usernameAndId,e.roles.join(\", \"),e.restrictedUser?i18next.t(\"yes\"):i18next.t(\"no\")]));return html`<or-mwc-table id=\"linked-users-table\" .rows=\"${r}\" .config=\"${{stickyFirstColumn:!1}}\" .columns=\"${o}\"\n                                  @or-mwc-table-row-click=\"${e=>{s.dispatchEvent(new OrAssetViewerLoadUserEvent(i[e.detail.index].userId))}}\">\n                    </or-mwc-table>`}}}export function getAttributeTemplate(e,t,s,i,o,r){if(i.attributeViewProvider){const r=i.attributeViewProvider(e,t,s,i,o);if(r)return r}let n,a,l,d,c,p;return r&&(n=r.label,a=r.disabled,l=r.readonly,d=r.disableButton,p=r.disableHelperText,c=r.inputTypeOverride),html`\n        <or-attribute-input class=\"force-btn-padding\" disablesubscribe .assetType=\"${e.type}\" .attribute=\"${t}\" .assetId=\"${e.id}\" .disabled=\"${a}\" .label=\"${n}\" .readonly=\"${l}\" resizeVertical .disableButton=\"${d}\" .inputType=\"${c}\" .hasHelperText=\"${!p}\" .fullWidth=\"${\"location\"===t.name}\"></or-attribute-input>\n    `}export function getPropertyTemplate(e,t,s,i,o,r){let n=e[t];if(i&&i.propertyViewProvider&&o){const r=i.propertyViewProvider(e,t,n,s,i,o);if(r)return r}let a=InputType.TEXT;switch(t){case\"parentId\":n=e.path||[\"\",e.parentId];const t=[...n];t.pop(),n=\"\",t.length>0&&(getAssetNames(t).then((e=>{if(s&&s.shadowRoot){const t=s.shadowRoot.getElementById(\"property-parentId\");t&&(t.value=e.join(\" > \"))}})),n=i18next.t(\"loading\"));break;case\"createdOn\":a=InputType.DATETIME;break;case\"accessPublicRead\":a=InputType.CHECKBOX}return html`<or-mwc-input id=\"property-${t}\" .type=\"${a}\" dense .value=\"${n}\" .readonly=\"${void 0===r.readonly||r.readonly}\" .label=\"${r.label}\"></or-mwc-input>`}export function getField(e,t,s){return s?html`\n            <div id=\"field-${e}\" style=\"${t&&t.styles?styleMap(t.styles):\"\"}\" class=${classMap({field:!0,mobileHidden:!!t&&!!t.hideOnMobile})}>\n                ${s}\n            </div>\n        `:html``}function getAssetNames(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield manager.rest.api.AssetResource.queryAssets({select:{attributes:[]},ids:e});return 200===t.status&&t.data&&t.data.length===e.length?e.map((e=>t.data.find((t=>t.id===e)).name)):e}))}function getAssetChildren(e,t){return __awaiter(this,void 0,void 0,(function*(){let s;try{s=yield manager.rest.api.AssetResource.queryAssets({parents:[{id:e}]})}catch(e){return console.log(\"Failed to get child assets: \"+e),[]}return 200===s.status&&s.data?s.data.filter((e=>e.type===t)):[]}))}function getLinkedUserInfo(e){return __awaiter(this,void 0,void 0,(function*(){const t=e.id.userId;return{userId:t,usernameAndId:e.userFullName,roles:yield manager.rest.api.UserResource.getUserRoles(manager.displayRealm,t).then((e=>e.data.filter((e=>e.composite&&e.assigned)).map((e=>e.name)))).catch((e=>(console.info(\"User not allowed to get roles\",e),[]))),restrictedUser:yield manager.rest.api.UserResource.getUserRealmRoles(manager.displayRealm,t).then((e=>!!e.data&&!!e.data.find((e=>e.assigned&&\"restricted_user\"===e.name))))}}))}function getLinkedUsers(e){return __awaiter(this,void 0,void 0,(function*(){try{return yield manager.rest.api.AssetResource.getUserAssetLinks({realm:manager.displayRealm,assetId:e.id}).then((e=>{const t=e.data.map((e=>getLinkedUserInfo(e)));return Promise.all(t)}))}catch(e){return console.log(\"Failed to get child assets: \"+e),[]}}))}export function saveAsset(e){return __awaiter(this,void 0,void 0,(function*(){const t=!!e.id&&void 0!==e.version;let s,i=\"\";try{if(t){if(!e.id)throw new Error(\"Request to update existing asset but asset ID is not set\");s=200===(yield manager.rest.api.AssetResource.update(e.id,e)).status,i=e.id}else{const t=yield manager.rest.api.AssetResource.create(e);s=200===t.status,s&&(i=t.data.id)}}catch(e){s=!1,showSnackbar(void 0,t?\"saveAssetFailed\":\"createAssetFailed\",\"dismiss\"),console.error(\"Failed to save asset\",e)}return{assetId:i,success:s,isNew:!t}}))}const tableStyle=require(\"@material/data-table/dist/mdc.data-table.css\");export const DEFAULT_ASSET_PROPERTIES=[\"name\",\"createdOn\",\"type\",\"parentId\",\"accessPublicRead\"];export const DEFAULT_VIEWER_CONFIG={viewerStyles:{},panels:[{type:\"group\",title:\"underlyingAssets\"},{type:\"info\",hideOnMobile:!0,properties:{include:[]},attributes:{include:[\"notes\",\"manufacturer\",\"model\"]}},{title:\"attributes\",type:\"info\",properties:{include:[]},attributes:{exclude:[\"location\",\"notes\",\"manufacturer\",\"model\"]}},{type:\"setup\",hideOnMobile:!1},{title:\"location\",type:\"info\",column:1,properties:{include:[]},attributes:{include:[\"location\"],itemConfig:{location:{label:\"\",readonly:!0}}}},{type:\"history\",column:1},{type:\"linkedUsers\",column:1}]};let OrAssetViewer=class extends(subscribe(manager)(translate(i18next)(LitElement))){static get styles(){return[unsafeCSS(tableStyle),progressCircular,panelStyles,style]}constructor(){super(),this._validationResults=[],this.langChangedCallback=()=>{this._assetInfo&&(this._assetInfo.attributeTemplateMap={},this.requestUpdate(\"_assetInfo\"))},this.addEventListener(OrEditAssetModifiedEvent.NAME,(e=>this._onAssetModified(e.detail)))}isModified(){return!!this.editMode&&this._assetInfo&&this._assetInfo.modified}shouldUpdate(e){return console.log(e),this._isReadonly()&&(this.editMode=!1),e.has(\"ids\")&&(this._assetInfo=void 0,this.asset=void 0,this.ids&&1===this.ids.length?super.assetIds=[this.ids[0]]:super.assetIds=void 0),e.has(\"asset\")&&(this._assetInfo=void 0,this.ids=void 0,super.assetIds=void 0,this.asset&&this.loadAssetInfo(this.asset).then((e=>this._assetInfo=e)).catch((e=>{console.debug(e)}))),super.shouldUpdate(e)}updated(e){e.has(\"asset\")&&this._doValidation()}loadAssetInfo(e){return __awaiter(this,void 0,void 0,(function*(){if(console.log(\"loadAssetInfo()\",e),!e)throw new Error(\"Asset has changed\");e.attributes||(e.attributes={});const t=!!e.id,s=!t,i=this._getPanelConfig(e);if(!t)return{asset:e,modified:s,viewerConfig:i,attributeTemplateMap:{}};const o=yield getLinkedUsers(e);if(console.log(o),!this.ids||1!=this.ids.length||this.ids[0]!==e.id)throw console.log(\"Wrong asset id?\"),new Error(\"Asset has changed\");let r;if(\"GroupAsset\"===e.type&&(r=yield getAssetChildren(e.id,e.attributes.childAssetType.value)),!this.ids||1!=this.ids.length||this.ids[0]!==e.id)throw console.log(\"Wrong assetg id 2?\"),new Error(\"Asset has changed\");return{asset:e,modified:s,viewerConfig:i,childAssets:r,userAssetLinks:o,attributeTemplateMap:{}}}))}_doValidation(){this.editMode&&this.editor&&(this._validationResults=this.editor.validate())}_onParentChangeClick(){let e;const t=e=>{e.stopPropagation()},s=html`\n            <or-asset-tree id=\"parent-asset-tree\" disableSubscribe readonly .selectedIds=\"${[]}\"\n                           @or-asset-tree-request-select=\"${t}\"\n                           @or-asset-tree-selection-changed=\"${t}\"></or-asset-tree>`,i=[{actionName:\"clear\",content:\"none\",action:()=>{this.dispatchEvent(new OrAssetViewerChangeParentEvent(void 0,this.ids||[]))}},{actionName:\"ok\",content:\"ok\",action:()=>{const t=e.shadowRoot.getElementById(\"parent-asset-tree\");let s=1===t.selectedIds.length?t.selectedIds[0]:void 0;this.dispatchEvent(new OrAssetViewerChangeParentEvent(s,this.ids||[]))}},{default:!0,actionName:\"cancel\",content:\"cancel\"}];e=showDialog((new OrMwcDialog).setContent(s).setActions(i).setStyles(html`\n                <style>\n                    .mdc-dialog__surface {\n                        width: 400px;\n                        height: 800px;\n                        display: flex;\n                        overflow: visible;\n                        overflow-x: visible !important;\n                        overflow-y: visible !important;\n                    }\n\n                    #dialog-content {\n                        flex: 1;\n                        overflow: visible;\n                        min-height: 0;\n                        padding: 0;\n                    }\n\n                    footer.mdc-dialog__actions {\n                        border-top: 1px solid ${unsafeCSS(DefaultColor5)};\n                    }\n\n                    or-asset-tree {\n                        height: 100%;\n                    }\n                </style>\n            `).setHeading(i18next.t(\"setParent\")).setDismissAction(null))}render(){const e=!(this.asset||this.ids&&0!==this.ids.length);if(!this.asset&&this.ids&&this.ids.length>1)return html`\n                <div class=\"msg\">\n                    <div class=\"multipleAssetsView\">\n                        <or-translate value=\"multiAssetSelected\" .options=\"${{assetNbr:this.ids.length}}\"></or-translate>\n                        <or-mwc-input .type=\"${InputType.BUTTON}\" label=\"changeParent\" @click=\"${()=>this._onParentChangeClick()}\" outlined></or-mwc-input>\n                    </div>\n                </div>\n            `;if(e)return html`\n                <div class=\"msg\"><or-translate value=\"noAssetSelected\"></or-translate></div>\n            `;if(!this._assetInfo)return html`\n                <div class=\"msg\"><or-translate value=\"loading\"></or-translate></div>\n            `;if(!this._assetInfo.asset)return html`\n                <div><or-translate value=\"notFound\"></or-translate></div>\n            `;const t=this._assetInfo.asset,s=AssetModelUtil.getAssetDescriptor(t.type),i=!!this.editMode;let o=\"\",r=[];if(i)o=html`\n                <div id=\"edit-container\">\n                    <or-edit-asset-panel id=\"editor\" .asset=\"${t}\"></or-edit-asset-panel>\n                </div>\n            `,r=this._validationResults.filter((e=>!e.valid||e.metaResults&&e.metaResults.some((e=>!e.valid)))).flatMap((e=>{const t=[];return e.valid||t.push(i18next.t(\"validation.invalidAttributeValue\",{attrName:e.name})),e.metaResults&&e.metaResults.filter((e=>!e.valid)).forEach((s=>{t.push(i18next.t(\"validation.invalidMetaItemValue\",{attrName:e.name,metaName:s.name}))})),t}));else{const e=this._assetInfo.viewerConfig;if(e.panels){const t=[],s=[];e.panels.forEach(((i,o)=>{if(!i.hide){const r=o+\"\",n=i.column||0,a=getPanel(r,i,getPanelContent(r,this._assetInfo,this,e,i))||\"\";a&&(0==n?t.push(a):s.push(a))}})),o=html`                \n                    <div id=\"view-container\" style=\"${e.viewerStyles?styleMap(e.viewerStyles):\"\"}\" @scroll=\"${this._toggleHeaderShadow}\">\n                        <div id=\"left-column\" class=\"panelContainer\">\n                            ${t}\n                        </div>\n                        <div id=\"right-column\" class=\"panelContainer\">\n                            ${s}\n                        </div>\n                    </div>`}}return html`\n            <div id=\"wrapper\">\n                <div id=\"asset-header\" class=${i?\"editmode\":\"\"}>\n                    <a class=\"back-navigation\" @click=\"${()=>window.history.back()}\">\n                        <or-icon icon=\"chevron-left\"></or-icon>\n                    </a>\n                    <div id=\"title\">\n                        <or-icon title=\"${s&&s.name?s.name:\"unset\"}\" style=\"--or-icon-fill: ${s&&s.colour?\"#\"+s.colour:\"unset\"}\" icon=\"${s&&s.icon?s.icon:AssetModelUtil.getAssetDescriptorIcon(\"ThingAsset\")}\"></or-icon>\n                        ${i?html`\n                                    <or-mwc-input id=\"name-input\" .type=\"${InputType.TEXT}\" min=\"1\" max=\"1023\" comfortable required outlined .label=\"${i18next.t(\"name\")}\" .value=\"${t.name}\" @or-mwc-input-changed=\"${e=>{t.name=e.detail.value,this._assetInfo.modified=!0,this._doValidation()}}\"></or-mwc-input>\n                                `:html`<span>${t.name}</span>`}\n                    </div>\n                    <div id=\"right-wrapper\" class=\"mobileHidden\">\n                        ${0===r.length?t.createdOn?html`<or-translate id=\"created-time\" class=\"tabletHidden\" value=\"createdOnWithDate\" .options=\"${{date:new Date(t.createdOn)}}\"></or-translate>`:\"\":html`<span id=\"error-wrapper\" .title=\"${r.join(\"\\n\")}\"><or-icon icon=\"alert\"></or-icon><or-translate class=\"tabletHidden\" value=\"validation.invalidAsset\"></or-translate></span>`}\n                        ${i?html`<or-mwc-input id=\"save-btn\" .disabled=\"${!this.isModified()}\" raised .type=\"${InputType.BUTTON}\" label=\"save\" @or-mwc-input-changed=\"${()=>this._onSaveClicked()}\"></or-mwc-input>`:\"\"}\n                        ${this._isReadonly()?\"\":html`<or-mwc-input id=\"edit-btn\" .disabled=\"${!this._assetInfo.asset.id}\" outlined .type=\"${InputType.BUTTON}\" .value=\"${this.editMode}\" .label=\"${this.editMode?i18next.t(\"viewAsset\"):i18next.t(\"editAsset\")}\" icon=\"${this.editMode?\"eye\":\"pencil\"}\" @or-mwc-input-changed=\"${()=>this._onEditToggleClicked(!this.editMode)}\"></or-mwc-input>\n                        `}\n                    </div>\n                </div>\n                ${o}\n            </div>\n        `}_toggleHeaderShadow(){this.containerElem.scrollTop>0?this.headerElem.classList.add(\"scrolled\"):this.headerElem.classList.remove(\"scrolled\")}_isReadonly(){return this.readonly||!manager.hasRole(\"write:assets\")}_onEditToggleClicked(e){Util.dispatchCancellableEvent(this,new OrAssetViewerRequestEditToggleEvent(e)).then((t=>{t.allow?this._doEditToggle(e):this.editBtnElem.value=!e}))}_doEditToggle(e){this.editMode=e,this.dispatchEvent(new OrAssetViewerEditToggleEvent(e))}_onSaveClicked(){this._assetInfo&&this._assetInfo.asset&&Util.dispatchCancellableEvent(this,new OrAssetViewerRequestSaveEvent(this._assetInfo.asset)).then((e=>{e.allow&&this._doSave()}))}_doSave(){return __awaiter(this,void 0,void 0,(function*(){if(!this._assetInfo)return;const e=this._assetInfo.asset;this.saveBtnElem.disabled=!0,this.wrapperElem.classList.add(\"saving\"),this._saveResult=yield saveAsset(e),this.wrapperElem.classList.remove(\"saving\"),this.saveBtnElem.disabled=!1,this._assetInfo&&this._assetInfo.asset===e&&(this._saveResult.success&&(this._assetInfo.modified=!1,this.asset=void 0,this.ids=[this._saveResult.assetId]),this.dispatchEvent(new OrAssetViewerSaveEvent(this._saveResult)))}))}_onAssetModified(e){this._assetInfo&&(this._assetInfo.modified=!0,this._validationResults=e)}_onEvent(e){var t;const s=this.ids&&this.ids.length>0?this.ids[0]:void 0;if(\"asset\"===e.eventType&&e.asset.id===s||\"attribute\"===e.eventType&&e.ref.id==s){if(\"asset\"===e.eventType){const i=e.asset;if(!this._assetInfo)return void this.loadAssetInfo(i).then((e=>this._assetInfo=e)).catch((e=>{}));if(i.id!==s)return;if(this.editMode){if(!this._assetInfo.modified||(null===(t=this._saveResult)||void 0===t?void 0:t.assetId)===s)return this._assetInfo=void 0,this._saveResult=void 0,void this.loadAssetInfo(i).then((e=>this._assetInfo=e)).catch((e=>{}));showOkDialog(\"assetModified\",i18next.t(\"assetModifiedMustRefresh\")).then((()=>{this._assetInfo=void 0,this.loadAssetInfo(i).then((e=>this._assetInfo=e)).catch((e=>{}))}))}else this._assetInfo=void 0,this.loadAssetInfo(i).then((e=>this._assetInfo=e)).catch((e=>{}))}if(\"attribute\"===e.eventType){if(!this._assetInfo)return;const t=this._assetInfo.asset,s=e,i=s.ref.name;if(t&&t.attributes&&t.attributes[i]){delete this._assetInfo.attributeTemplateMap[i];const e=Object.assign({},t.attributes[i]);if(e.value=s.value,e.timestamp=s.timestamp,t.attributes[i]=e,this.editMode){const e=this.shadowRoot.getElementById(\"editor\");e&&e.attributeUpdated(i)}else this.requestUpdate()}}}}_getPanelConfig(e){const t=Object.assign({},DEFAULT_VIEWER_CONFIG);if(this.config){t.viewerStyles=Object.assign({},t.viewerStyles),t.panels=t.panels?[...t.panels]:[];const s=this.config.assetTypes&&this.config.assetTypes.hasOwnProperty(e.type)?this.config.assetTypes[e.type]:this.config.default;s&&(s.viewerStyles&&Object.assign(t.viewerStyles,s.viewerStyles),s.panels&&(t.panels=s.panels),t.attributeViewProvider=s.attributeViewProvider||(this.config.default?this.config.default.attributeViewProvider:void 0),t.panelViewProvider=s.panelViewProvider||(this.config.default?this.config.default.panelViewProvider:void 0),t.propertyViewProvider=s.propertyViewProvider||(this.config.default?this.config.default.propertyViewProvider:void 0),t.historyConfig=s.historyConfig||this.config.historyConfig)}return t}};__decorate([property({type:Object,reflect:!1})],OrAssetViewer.prototype,\"asset\",void 0),__decorate([property({type:Array,reflect:!1})],OrAssetViewer.prototype,\"ids\",void 0),__decorate([property({type:Object})],OrAssetViewer.prototype,\"config\",void 0),__decorate([property({type:Boolean})],OrAssetViewer.prototype,\"editMode\",void 0),__decorate([property({type:Boolean})],OrAssetViewer.prototype,\"readonly\",void 0),__decorate([state()],OrAssetViewer.prototype,\"_assetInfo\",void 0),__decorate([state()],OrAssetViewer.prototype,\"_validationResults\",void 0),__decorate([query(\"#wrapper\")],OrAssetViewer.prototype,\"wrapperElem\",void 0),__decorate([query(\"#save-btn\")],OrAssetViewer.prototype,\"saveBtnElem\",void 0),__decorate([query(\"#edit-btn\")],OrAssetViewer.prototype,\"editBtnElem\",void 0),__decorate([query(\"#editor\")],OrAssetViewer.prototype,\"editor\",void 0),__decorate([query(\"#asset-header\")],OrAssetViewer.prototype,\"headerElem\",void 0),__decorate([query(\"#view-container\")],OrAssetViewer.prototype,\"containerElem\",void 0),OrAssetViewer=__decorate([customElement(\"or-asset-viewer\")],OrAssetViewer);export{OrAssetViewer};","var __decorate=this&&this.__decorate||function(e,t,o,r){var i,p=arguments.length,a=p<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var d=e.length-1;d>=0;d--)(i=e[d])&&(a=(p<3?i(a):p>3?i(t,o,a):i(t,o))||a);return p>3&&a&&Object.defineProperty(t,o,a),a};import{css,html,LitElement}from\"lit\";import{customElement,property}from\"lit/decorators.js\";let OrLoadingWrapper=class extends LitElement{constructor(){super(...arguments),this.loadDom=!0,this.fadeContent=!1,this.loading=!1}static get styles(){return css`\n            :host {\n                display: block;\n            }\n            \n            .hidden {\n                display: none;\n            }\n            \n            .faded {\n                opacity: 0.5;\n            }\n            \n            #wrapper {\n                position: relative;\n            }\n            \n            #loader {\n                position: absolute;\n                width: 100%;\n                height: 100%;\n            }\n        `}render(){return html`\n            <div id=\"wrapper\">\n                ${this.loading?html`<div id=\"loader\">LOADING</div>`:\"\"}\n                ${this.loadDom||!this.loading?html`\n                    <div id=\"content-wrapper\" class=\"${this.loading?this.fadeContent?\"faded\":\"hidden\":\"\"}\">\n                        <slot></slot>\n                        ${this.content||\"\"}\n                    </div>`:\"\"}\n            </div>\n        `}};__decorate([property({type:Number})],OrLoadingWrapper.prototype,\"loadingHeight\",void 0),__decorate([property({type:Boolean})],OrLoadingWrapper.prototype,\"loadDom\",void 0),__decorate([property({type:Boolean})],OrLoadingWrapper.prototype,\"fadeContent\",void 0),__decorate([property({type:Boolean})],OrLoadingWrapper.prototype,\"loading\",void 0),__decorate([property({type:Object,attribute:!1})],OrLoadingWrapper.prototype,\"content\",void 0),OrLoadingWrapper=__decorate([customElement(\"or-loading-wrapper\")],OrLoadingWrapper);export{OrLoadingWrapper};","import{rankWith,and,mapStateToControlProps,mapDispatchToControlProps,uiTypeIs,formatIs}from\"@jsonforms/core\";import manager,{OREvent}from\"@openremote/core\";import{getTemplateWrapper}from\"@openremote/or-json-forms\";import{InputType}from\"@openremote/or-mwc-components/or-mwc-input\";import{html}from\"lit\";import\"@openremote/or-mwc-components/or-mwc-input\";import{i18next}from\"@openremote/or-translate\";import{until}from\"lit/directives/until.js\";let agents,loadingPromise,subscribed=!1;const timeout=2e3;export function loadAgents(){return agents?Promise.resolve(agents):loadingPromise||(subscribed||(manager.addListener((e=>{e===OREvent.DISPLAY_REALM_CHANGED&&(agents=void 0,loadingPromise=void 0)})),manager.events.subscribeAssetEvents(void 0,!1,(e=>{e.asset&&e.asset.type.endsWith(\"Agent\")&&(agents=void 0,loadingPromise=void 0)})),subscribed=!0),loadingPromise=manager.rest.api.AssetResource.queryAssets({realm:{name:manager.displayRealm},types:[\"Agent\"],select:{attributes:[]}}).then((e=>e.data)).then((e=>(agents=e,e))),loadingPromise)}const agentIdTester=rankWith(6,and(uiTypeIs(\"Control\"),formatIs(\"or-agent-id\"))),agentIdRenderer=(e,t)=>{t=Object.assign(Object.assign(Object.assign({},t),mapStateToControlProps({jsonforms:Object.assign({},e)},t)),mapDispatchToControlProps(e.dispatch));const r=loadAgents().then((e=>{const r=e.map((e=>[e.id,e.name+\" (\"+e.id+\")\"]));return html`\n            <or-mwc-input .label=\"${i18next.t(\"agentId\")}\" required class=\"agent-id-picker\" @or-mwc-input-changed=\"${r=>{return n=e.find((e=>e.id===r.detail.value)),void t.handleChange(t.path,n?n.id:void 0);var n}}\" type=\"${InputType.SELECT}\" .value=\"${t.data}\" .placeholder=\"${i18next.t(\"selectAgent\")}\" .options=\"${r}\"></or-mwc-input>\n        `})),n=html`\n        <style>\n            .agent-id-picker {\n                min-width: 300px;\n                max-width: 600px;\n                width: 100%;\n            }\n        </style>\n        ${until(r,html`<or-mwc-input class=\"agent-id-picker\" .type=\"${InputType.SELECT}\"></or-mwc-input>`)}\n        `;return getTemplateWrapper(n,void 0)};export const agentIdRendererRegistryEntry={tester:agentIdTester,renderer:agentIdRenderer};","var __decorate=this&&this.__decorate||function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},__awaiter=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,a){function o(e){try{d(r.next(e))}catch(e){a(e)}}function s(e){try{d(r.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,s)}d((r=r.apply(e,t||[])).next())}))};import{css,html,LitElement}from\"lit\";import{customElement,property}from\"lit/decorators.js\";import{ifDefined}from\"lit/directives/if-defined.js\";import{until}from\"lit/directives/until.js\";import{createRef,ref}from\"lit/directives/ref.js\";import{i18next,translate}from\"@openremote/or-translate\";import{AssetModelUtil}from\"@openremote/model\";import manager,{subscribe,Util}from\"@openremote/core\";import\"@openremote/or-mwc-components/or-mwc-input\";import{progressCircular}from\"@openremote/or-mwc-components/style\";import\"@openremote/or-components/or-loading-wrapper\";import{getValueHolderInputTemplateProvider}from\"@openremote/or-mwc-components/or-mwc-input\";import\"@openremote/or-map\";import{geoJsonPointInputTemplateProvider}from\"@openremote/or-map\";import\"@openremote/or-json-forms\";import{StandardRenderers}from\"@openremote/or-json-forms\";import{agentIdRendererRegistryEntry,loadAgents}from\"./agent-link-json-forms-renderer\";export class OrAttributeInputChangedEvent extends CustomEvent{constructor(e,t){super(OrAttributeInputChangedEvent.NAME,{detail:{value:e,previousValue:t},bubbles:!0,composed:!0})}}OrAttributeInputChangedEvent.NAME=\"or-attribute-input-changed\";export function getAttributeInputWrapper(e,t,i,r,n,a,o,s,d){return n&&(e=html`\n                    <div id=\"wrapper-helper\">\n                        ${a?html`<div id=\"wrapper-label\">${a}</div>`:\"\"}\n                        <div id=\"wrapper-input\">${e}</div>\n                        <div id=\"helper-text\">${n}</div>\n                    </div>\n                `),o&&(e=html`\n                ${e}\n                <or-mwc-input id=\"send-btn\" icon=\"${o}\" type=\"button\" .disabled=\"${r||i}\" @or-mwc-input-changed=\"${e=>{e.stopPropagation(),s&&s()}}\"></or-mwc-input>\n            `),html`\n            <div id=\"wrapper\" class=\"${o||d?\"no-padding\":\"right-padding\"}\">\n                ${e}\n                <div id=\"scrim\" class=\"${ifDefined(i?void 0:\"hidden\")}\"><progress class=\"pure-material-progress-circular\"></progress></div>\n            </div>\n        `}export function getHelperText(e,t,i){return e?i18next.t(\"sending\"):t?i18next.t(\"sendFailed\"):i?i18next.t(\"updatedWithDate\",{date:new Date(i)}):void 0}const jsonFormsAttributeRenderers=[...StandardRenderers,agentIdRendererRegistryEntry];export const jsonFormsInputTemplateProvider=e=>(t,i,r,n,a,o)=>{const s=!(!o||!o.disabled),d=!(!o||!o.readonly),p=o.label;if(\"agentLink\"===n.name){const e={type:\"Control\",scope:\"#\"};let t;const i=createRef(),r=createRef();let n,o=[],l=!1;const u=e=>{if(!l)return;const t=e.data;if(t){const e=o.find((e=>e.id===t.id));if(e){const i=AssetModelUtil.getAssetDescriptor(e.type);i&&(t.type=i.agentLinkType)}}Util.objectsEqual(t,n)||(n=t,a({value:t}))},c=e=>__awaiter(void 0,void 0,void 0,(function*(){if(l||(n=e),l=!0,t||(t=JSON.parse('{\"$schema\":\"http://json-schema.org/draft-07/schema#\",\"title\":\"Agent Link\",\"oneOf\":[{\"$ref\":\"#/definitions/SNMPAgentLink\"},{\"$ref\":\"#/definitions/HTTPAgentLink\"},{\"$ref\":\"#/definitions/DefaultAgentLink\"},{\"$ref\":\"#/definitions/ZWaveAgentLink\"},{\"$ref\":\"#/definitions/WebsocketAgentLink\"},{\"$ref\":\"#/definitions/StorageSimulatorAgentLink\"},{\"$ref\":\"#/definitions/MockAgentLink\"},{\"$ref\":\"#/definitions/BluetoothMeshAgentLink\"},{\"$ref\":\"#/definitions/MQTTAgentLink\"},{\"$ref\":\"#/definitions/KNXAgentLink\"},{\"$ref\":\"#/definitions/SimulatorAgentLink\"},{\"$ref\":\"#/definitions/VelbusAgentLink\"}],\"definitions\":{\"SNMPAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"SNMPAgentLink\"],\"default\":\"SNMPAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"},\"oid\":{\"type\":\"string\"}},\"title\":\"SNMPAgentLink\",\"required\":[\"type\",\"oid\"]},\"regex\":{\"type\":\"object\",\"additionalProperties\":true,\"title\":\"Regex\",\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"regex\"],\"default\":\"regex\"},\"pattern\":{\"type\":\"string\"},\"matchGroup\":{\"type\":\"integer\"},\"matchIndex\":{\"type\":\"integer\"}},\"required\":[\"type\"]},\"substring\":{\"type\":\"object\",\"additionalProperties\":true,\"title\":\"Substring\",\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"substring\"],\"default\":\"substring\"},\"beginIndex\":{\"type\":\"integer\"},\"endIndex\":{\"type\":\"integer\"}},\"required\":[\"type\",\"beginIndex\"]},\"jsonPath\":{\"type\":\"object\",\"additionalProperties\":true,\"title\":\"JSON Path\",\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"jsonPath\"],\"default\":\"jsonPath\"},\"path\":{\"type\":\"string\"},\"returnFirst\":{\"type\":\"boolean\"},\"returnLast\":{\"type\":\"boolean\"}},\"required\":[\"type\",\"path\",\"returnFirst\",\"returnLast\"]},\"PatternPropertiesSimpleKeyAnyType\":{\"type\":\"object\",\"additionalProperties\":true,\"patternProperties\":{\"^[a-zA-Z][a-zA-Z0-9]*\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}},\"properties\":{}},\"StringPredicate\":{\"type\":\"object\",\"additionalProperties\":true,\"description\":\"Predicate for string values; will match based on configured options.\",\"properties\":{\"predicateType\":{\"type\":\"string\",\"enum\":[\"string\"],\"default\":\"string\"},\"match\":{\"type\":\"string\",\"enum\":[\"EXACT\",\"BEGIN\",\"END\",\"CONTAINS\"]},\"caseSensitive\":{\"type\":\"boolean\"},\"value\":{\"type\":\"string\"},\"negate\":{\"type\":\"boolean\"}},\"title\":\"string\",\"required\":[\"predicateType\",\"caseSensitive\",\"negate\"]},\"BooleanPredicate\":{\"type\":\"object\",\"additionalProperties\":true,\"description\":\"Predicate for boolean values; will evaluate the value as a boolean and match against this predicates value, any value that is not a boolean will not match\",\"properties\":{\"predicateType\":{\"type\":\"string\",\"enum\":[\"boolean\"],\"default\":\"boolean\"},\"value\":{\"type\":\"boolean\"}},\"title\":\"boolean\",\"required\":[\"predicateType\",\"value\"]},\"DateTimePredicate\":{\"type\":\"object\",\"additionalProperties\":true,\"description\":\"Predicate for date time values; provided values should be valid ISO 8601 datetime strings (e.g. yyyy-MM-dd\\'T\\'HH:mm:ssZ or yyyy-MM-dd\\'T\\'HH:mm:ss±HH:mm), offset and time are optional, if no offset information is supplied then UTC is assumed.\",\"properties\":{\"predicateType\":{\"type\":\"string\",\"enum\":[\"datetime\"],\"default\":\"datetime\"},\"value\":{\"type\":\"string\"},\"rangeValue\":{\"type\":\"string\"},\"operator\":{\"type\":\"string\",\"enum\":[\"EQUALS\",\"GREATER_THAN\",\"GREATER_EQUALS\",\"LESS_THAN\",\"LESS_EQUALS\",\"BETWEEN\"]},\"negate\":{\"type\":\"boolean\"}},\"title\":\"datetime\",\"required\":[\"predicateType\",\"negate\"]},\"NumberPredicate\":{\"type\":\"object\",\"additionalProperties\":true,\"description\":\"Predicate for number values; will match based on configured options.\",\"properties\":{\"predicateType\":{\"type\":\"string\",\"enum\":[\"number\"],\"default\":\"number\"},\"value\":{\"type\":\"number\"},\"rangeValue\":{\"type\":\"number\"},\"operator\":{\"type\":\"string\",\"enum\":[\"EQUALS\",\"GREATER_THAN\",\"GREATER_EQUALS\",\"LESS_THAN\",\"LESS_EQUALS\",\"BETWEEN\"]},\"negate\":{\"type\":\"boolean\"}},\"title\":\"number\",\"required\":[\"predicateType\",\"negate\"]},\"RadialGeofencePredicate\":{\"type\":\"object\",\"additionalProperties\":true,\"description\":\"Predicate for GEO JSON point values; will return true if the point is within the specified radius of the specified latitude and longitude unless negated.\",\"title\":\"Radial geofence\",\"properties\":{\"predicateType\":{\"type\":\"string\",\"enum\":[\"radial\"],\"default\":\"radial\"},\"radius\":{\"type\":\"integer\"},\"lat\":{\"type\":\"number\"},\"lng\":{\"type\":\"number\"},\"negated\":{\"type\":\"boolean\"}},\"required\":[\"predicateType\",\"radius\",\"lat\",\"lng\",\"negated\"]},\"RectangularGeofencePredicate\":{\"type\":\"object\",\"additionalProperties\":true,\"description\":\"Predicate for GEO JSON point values; will return true if the point is within the specified rectangle specified as latitude and longitude values of two corners unless negated.\",\"title\":\"Rectangular geofence\",\"properties\":{\"predicateType\":{\"type\":\"string\",\"enum\":[\"rect\"],\"default\":\"rect\"},\"latMin\":{\"type\":\"number\"},\"lngMin\":{\"type\":\"number\"},\"latMax\":{\"type\":\"number\"},\"lngMax\":{\"type\":\"number\"},\"negated\":{\"type\":\"boolean\"}},\"required\":[\"predicateType\",\"latMin\",\"lngMin\",\"latMax\",\"lngMax\",\"negated\"]},\"ArrayPredicate\":{\"type\":\"object\",\"additionalProperties\":true,\"description\":\"Predicate for array values; will match based on configured options.\",\"properties\":{\"predicateType\":{\"type\":\"string\",\"enum\":[\"array\"],\"default\":\"array\"},\"value\":{\"$ref\":\"#/definitions/AnyType\"},\"index\":{\"type\":\"integer\"},\"lengthEquals\":{\"type\":\"integer\"},\"lengthGreaterThan\":{\"type\":\"integer\"},\"lengthLessThan\":{\"type\":\"integer\"},\"negated\":{\"type\":\"boolean\"}},\"title\":\"array\",\"required\":[\"predicateType\",\"negated\"]},\"AnyType\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"],\"additionalProperties\":true,\"properties\":{}},\"ValueAnyPredicate\":{\"type\":\"object\",\"additionalProperties\":true,\"description\":\"Predicate that matches any value including null.\",\"title\":\"Any value\",\"properties\":{\"predicateType\":{\"type\":\"string\",\"enum\":[\"value-any\"],\"default\":\"value-any\"}},\"required\":[\"predicateType\"]},\"ValueEmptyPredicate\":{\"type\":\"object\",\"additionalProperties\":true,\"description\":\"Predicate that matches any empty/null value; unless negated.\",\"title\":\"Empty value\",\"properties\":{\"predicateType\":{\"type\":\"string\",\"enum\":[\"value-empty\"],\"default\":\"value-empty\"},\"negate\":{\"type\":\"boolean\"}},\"required\":[\"predicateType\",\"negate\"]},\"CalendarEventPredicate\":{\"type\":\"object\",\"additionalProperties\":true,\"description\":\"Predicate for calendar event values; will match based on whether the calendar event is active for the specified time.\",\"title\":\"Calendar\",\"properties\":{\"predicateType\":{\"type\":\"string\",\"enum\":[\"calendar-event\"],\"default\":\"calendar-event\"},\"timestamp\":{\"type\":\"integer\",\"format\":\"utc-millisec\"}},\"required\":[\"predicateType\"]},\"HTTPAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"HTTPAgentLink\"],\"default\":\"HTTPAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"},\"headers\":{\"type\":\"object\",\"additionalProperties\":{\"type\":\"array\",\"items\":{\"type\":\"string\"}},\"description\":\"A JSON object of headers to be added to HTTP request; the key represents the name of the header and for each string value supplied a new header will be added with the key name and specified string value\"},\"queryParameters\":{\"type\":\"object\",\"additionalProperties\":{\"type\":\"array\",\"items\":{\"type\":\"string\"}},\"description\":\"A JSON object of query parameters to be added to HTTP request URL; the key represents the name of the query parameter and for each string value supplied a new query parameter will be added with the key name and specified string value (e.g. \\'https://..../?test=1&test=2\\')\"},\"pollingMillis\":{\"type\":\"integer\",\"description\":\"Indicates that this HTTP request is used to update the linked attribute; this value indicates how frequently the HTTP request is made in order to update the linked attribute value\"},\"pagingMode\":{\"type\":\"boolean\",\"description\":\"Indicates that the HTTP server supports pagination using the standard Link header mechanism\"},\"path\":{\"type\":\"string\",\"description\":\"The URL path to append to the agents Base URL when making requests for this linked attribute\"},\"method\":{\"type\":\"string\",\"enum\":[\"GET\",\"POST\",\"PUT\",\"DELETE\",\"OPTIONS\",\"PATCH\"],\"description\":\"The HTTP method to use when making requests for this linked attribute\"},\"contentType\":{\"type\":\"string\",\"description\":\"The content type header value to use when making requests for this linked attribute (shortcut alternative to using headers parameter)\"},\"pollingAttribute\":{\"type\":\"string\",\"description\":\"Allows the polled response to be written to another attribute with the specified name on the same asset as the linked attribute\"},\"messageConvertBinary\":{\"type\":\"boolean\",\"description\":\"Indicates that the HTTP response is binary and should be converted to binary string representation\"},\"messageConvertHex\":{\"type\":\"boolean\",\"description\":\"Indicates that the HTTP response is binary and should be converted to hexidecimal string representation\"}},\"title\":\"HTTPAgentLink\",\"required\":[\"type\",\"messageConvertBinary\",\"messageConvertHex\"]},\"DefaultAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"DefaultAgentLink\"],\"default\":\"DefaultAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"}},\"title\":\"DefaultAgentLink\",\"required\":[\"type\"]},\"ZWaveAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"ZWaveAgentLink\"],\"default\":\"ZWaveAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"},\"deviceNodeId\":{\"type\":\"integer\"},\"deviceEndpoint\":{\"type\":\"integer\"},\"deviceValue\":{\"type\":\"string\"}},\"title\":\"ZWaveAgentLink\",\"required\":[\"type\"]},\"WebsocketAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"WebsocketAgentLink\"],\"default\":\"WebsocketAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"},\"websocketSubscriptions\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/websocket\"},{\"$ref\":\"#/definitions/http\"}]}}},\"title\":\"WebsocketAgentLink\",\"required\":[\"type\"]},\"websocket\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"websocket\"],\"default\":\"websocket\"},\"body\":{\"$ref\":\"#/definitions/AnyType\"}},\"title\":\"websocket\",\"required\":[\"type\"]},\"http\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"http\"],\"default\":\"http\"},\"body\":{\"$ref\":\"#/definitions/AnyType\"},\"method\":{\"type\":\"string\",\"enum\":[\"GET\",\"PUT\",\"POST\"]},\"contentType\":{\"type\":\"string\"},\"headers\":{\"type\":\"object\",\"additionalProperties\":{\"type\":\"array\",\"items\":{\"type\":\"string\"}}},\"uri\":{\"type\":\"string\"}},\"title\":\"http\",\"required\":[\"type\"]},\"StorageSimulatorAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"StorageSimulatorAgentLink\"],\"default\":\"StorageSimulatorAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"}},\"title\":\"StorageSimulatorAgentLink\",\"required\":[\"type\"]},\"MockAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"MockAgentLink\"],\"default\":\"MockAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"},\"requiredValue\":{\"type\":\"string\"}},\"title\":\"MockAgentLink\",\"required\":[\"type\"]},\"BluetoothMeshAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"BluetoothMeshAgentLink\"],\"default\":\"BluetoothMeshAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"},\"appKeyIndex\":{\"type\":\"integer\",\"minimum\":0,\"maximum\":2147483647},\"address\":{\"type\":\"string\",\"pattern\":\"^([0-9A-Fa-f]{4})$\"},\"modelName\":{\"type\":\"string\",\"pattern\":\"^.*\\\\\\\\S+.*$\",\"minLength\":1}},\"title\":\"BluetoothMeshAgentLink\",\"required\":[\"type\",\"appKeyIndex\",\"modelName\"]},\"MQTTAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"MQTTAgentLink\"],\"default\":\"MQTTAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"},\"subscriptionTopic\":{\"type\":\"string\"},\"publishTopic\":{\"type\":\"string\"}},\"title\":\"MQTTAgentLink\",\"required\":[\"type\"]},\"KNXAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"KNXAgentLink\"],\"default\":\"KNXAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"},\"dpt\":{\"type\":\"string\",\"pattern\":\"^\\\\\\\\d{1,3}\\\\\\\\.\\\\\\\\d{1,3}$\"},\"actionGroupAddress\":{\"type\":\"string\",\"pattern\":\"^\\\\\\\\d{1,3}/\\\\\\\\d{1,3}/\\\\\\\\d{1,3}$\"},\"statusGroupAddress\":{\"type\":\"string\",\"pattern\":\"^\\\\\\\\d{1,3}/\\\\\\\\d{1,3}/\\\\\\\\d{1,3}$\"}},\"title\":\"KNXAgentLink\",\"required\":[\"type\",\"dpt\"]},\"SimulatorAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"SimulatorAgentLink\"],\"default\":\"SimulatorAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"},\"replayData\":{\"type\":\"array\",\"items\":{\"$ref\":\"#/definitions/SimulatorReplayDatapoint\"},\"description\":\"Used to store 24h dataset of values that should be replayed (i.e. written to the linked attribute) in a continuous loop.\"}},\"title\":\"SimulatorAgentLink\",\"required\":[\"type\"]},\"SimulatorReplayDatapoint\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"timestamp\":{\"type\":\"integer\"},\"value\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"array\",\"object\",\"string\"]}},\"title\":\"Data point\",\"required\":[\"timestamp\", \"value\"]},\"VelbusAgentLink\":{\"type\":\"object\",\"additionalProperties\":true,\"properties\":{\"type\":{\"type\":\"string\",\"enum\":[\"VelbusAgentLink\"],\"default\":\"VelbusAgentLink\"},\"id\":{\"type\":\"string\",\"format\":\"or-agent-id\"},\"deviceAddress\":{\"type\":\"integer\",\"minimum\":1,\"maximum\":255},\"deviceValueLink\":{\"type\":\"string\",\"pattern\":\"^.*\\\\\\\\S+.*$\",\"minLength\":1},\"valueFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"Defines ValueFilters to apply to an incoming value before it is written to a protocol linked attribute; this is particularly useful for generic protocols. The message should pass through the filters in array order\"},\"valueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValueConverter\":{\"type\":\"object\",\"patternProperties\":{\".+\":{\"type\":[\"null\",\"number\",\"integer\",\"boolean\",\"string\",\"array\",\"object\"]}}},\"writeValue\":{\"type\":\"string\",\"format\":\"or-multiline\",\"description\":\"String to be used for attribute writes and can contain \\'{$value}\\' placeholders to allow the written value to be injected into the string or to even hardcode the value written to the protocol (particularly useful for executable attributes)\"},\"messageMatchPredicate\":{\"oneOf\":[{\"$ref\":\"#/definitions/StringPredicate\"},{\"$ref\":\"#/definitions/BooleanPredicate\"},{\"$ref\":\"#/definitions/DateTimePredicate\"},{\"$ref\":\"#/definitions/NumberPredicate\"},{\"$ref\":\"#/definitions/RadialGeofencePredicate\"},{\"$ref\":\"#/definitions/RectangularGeofencePredicate\"},{\"$ref\":\"#/definitions/ArrayPredicate\"},{\"$ref\":\"#/definitions/ValueAnyPredicate\"},{\"$ref\":\"#/definitions/ValueEmptyPredicate\"},{\"$ref\":\"#/definitions/CalendarEventPredicate\"}],\"description\":\"The predicate to apply to incoming messages to determine if the message is intended for the linked attribute; the value used in the predicate can be filtered using the message match filters. This must be defined to enable attributes to be updated by the linked agent.\"},\"messageMatchFilters\":{\"type\":\"array\",\"items\":{\"oneOf\":[{\"$ref\":\"#/definitions/regex\"},{\"$ref\":\"#/definitions/substring\"},{\"$ref\":\"#/definitions/jsonPath\"}]},\"description\":\"ValueFilters to apply to incoming messages prior to comparison with the messageMatchPredicate\"},\"updateOnWrite\":{\"type\":\"boolean\",\"description\":\"Don\\'t expect a response from the protocol just update the attribute immediately on write\"}},\"title\":\"VelbusAgentLink\",\"required\":[\"type\",\"deviceAddress\",\"deviceValueLink\"]}}}')),o=yield loadAgents(),o){if(e&&(e.id?o.find((t=>t.id===e.id))||(console.warn(\"Agent link: linked agent could not be found\"),e.id=\"\"):e.id=\"\"),i.value&&r.value){const n=i.value;n.schema=t,n.data=e,r.value.loading=!1}}else console.warn(\"Failed to load agents for agent link\")}));return{templateFunction:(n,a,o,l,f,h)=>(n||(n={id:\"\",type:\"DefaultAgentLink\"}),window.setTimeout((()=>c(n)),0),html`\n                <style>\n                    .disabled {\n                        opacity: 0.5;\n                        pointer-events: none;\n                    }\n                    or-loading-wrapper {\n                        width: 100%;\n                    }\n                </style>\n                <or-loading-wrapper ${ref(r)} .loading=\"${!0}\">\n                    <or-json-forms .renderers=\"${jsonFormsAttributeRenderers}\" ${ref(i)}\n                                   .disabled=\"${s}\" .readonly=\"${d}\" .label=\"${p}\"\n                                   .schema=\"${t}\" label=\"Agent link\" .uischema=\"${e}\" .onChange=\"${u}\"></or-json-forms>\n                </or-loading-wrapper>\n            `),supportsHelperText:!1,supportsLabel:!1,supportsSendButton:!1,validator:()=>!!i.value&&i.value.checkValidity()}}return e};const DEFAULT_TIMEOUT=5e3;let OrAttributeInput=class extends(subscribe(manager)(translate(i18next)(LitElement))){constructor(){super(...arguments),this.disableSubscribe=!1,this.disableWrite=!1,this.compact=!1,this.comfortable=!1,this.resizeVertical=!1,this.writeTimeout=5e3,this._requestFocus=!1,this._sendError=!1,this.langChangedCallback=()=>{this._updateTemplate(),this.requestUpdate()}}static get styles(){return[progressCircular,css`\n            :host {\n                display: inline-block;\n            }\n            \n            :host(.force-btn-padding) #wrapper.no-padding {\n                /*padding-right: 52px;*/\n            }   \n            \n            #wrapper or-mwc-input, #wrapper or-map {\n                width: 100%;\n            }\n            \n            #wrapper or-map {\n                min-height: 250px;\n            }\n\n            #wrapper .long-press-msg {\n                display: none;\n            }\n            \n            #wrapper {\n                display: flex;\n                position: relative;\n            }\n            \n            #wrapper.right-padding {\n                padding-right: 52px;\n            }\n            \n            #wrapper-helper {\n                display: flex;\n                flex: 1;\n                flex-direction: column;\n            }\n            \n            #wrapper-input {\n                flex: 1;\n                display: flex;\n            }\n            \n            #wrapper-label, #helper-text {\n                margin-left: 16px;\n            }\n            \n            /* Copy of mdc text field helper text styles */\n            #helper-text {                \n                min-width: 255px;\n                color: rgba(0, 0, 0, 0.6);\n                font-family: Roboto, sans-serif;\n                -webkit-font-smoothing: antialiased;\n                font-size: 0.75rem;\n                font-weight: 400;\n                letter-spacing: 0.0333333em;\n            }\n            \n            #scrim {\n                position: absolute;\n                left: 0;\n                top: 0;\n                right: 0;\n                bottom: 0;\n                background: white;\n                opacity: 0.2;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n            }\n            \n            #scrim.hidden {\n                display: none;\n            }\n\n            #send-btn { \n                flex: 0;\n                margin-left: 4px;\n                margin-top: 4px;\n            }\n        `]}disconnectedCallback(){super.disconnectedCallback(),this._clearWriteTimeout()}shouldUpdate(e){const t=super.shouldUpdate(e);let i=!1,r=!1;if(e.has(\"disableSubscribe\")&&(i=!0),(e.has(\"attributeDescriptor\")||e.has(\"valueDescriptor\")||e.has(\"assetType\"))&&(r=!0),e.has(\"attribute\")){const t=Object.assign({},e.get(\"attribute\")),n=this.attribute;if(t&&n){const a=t.value,o=t.timestamp;if(t.value=n.value,t.timestamp=n.timestamp,Util.objectsEqual(t,n))if(Util.objectsEqual(a,n.value)&&o===n.timestamp){if(1===e.size)return!1}else this._onAttributeValueChanged(a,n.value,n.timestamp);else i=!0,r=!0}}return e.has(\"assetId\")&&e.get(\"assetId\")!==this.assetId&&(i=!0,r=!0),r&&this._updateDescriptors(),i&&this._updateSubscribedRefs(),this._templateProvider&&(e.has(\"disabled\")||e.has(\"readonly\")||e.has(\"required\")||e.has(\"label\"))&&this._updateTemplate(),t}_updateSubscribedRefs(){if(this._attributeEvent=void 0,this.disableSubscribe)this.attributeRefs=void 0;else{const e=this._getAttributeRef();this.attributeRefs=e?[e]:void 0}}_getAttributeRef(){if(this.assetId&&this.attribute)return{name:this.attribute.name,id:this.assetId}}_updateDescriptors(){if(this._valueDescriptor=void 0,this._attributeDescriptor=void 0,this.attributeDescriptor&&this.valueDescriptor)this._attributeDescriptor=this.attributeDescriptor,this._valueDescriptor=this.valueDescriptor;else{const e=this.attributeDescriptor||(this.attribute?this.attribute.name:void 0);if(e){const t=AssetModelUtil.getAttributeAndValueDescriptors(this.assetType,e,this.attribute);this._attributeDescriptor=t[0],this._valueDescriptor=this.valueDescriptor?this._valueDescriptor:t[1]}else this._attributeDescriptor=this.attributeDescriptor,this._valueDescriptor=this.valueDescriptor}this._updateTemplate()}_updateTemplate(){if(this._templateProvider=void 0,!this.assetType)return;const e=AssetModelUtil.resolveValueDescriptor(this.attribute,this._valueDescriptor||this._attributeDescriptor);if(!e)return;const t={readonly:this.isReadonly(),required:this.required,disabled:this.disabled,compact:this.compact,rounded:this.rounded,outlined:this.outlined,label:this.getLabel(),comfortable:this.comfortable,resizeVertical:this.resizeVertical,inputType:this.inputType},i=e=>{const t=e?e.value:void 0,i=e&&e.enterPressed||!this._templateProvider||!this.showButton||!this._templateProvider.supportsSendButton;this._onInputValueChanged(t,i)};if(this.customProvider)return void(this._templateProvider=this.customProvider?this.customProvider(this.assetType,this.attribute,this._attributeDescriptor,e,(e=>i(e)),t):void 0);if(\"GEO_JSONPoint\"===e.name)return void(this._templateProvider=geoJsonPointInputTemplateProvider(this.assetType,this.attribute,this._attributeDescriptor,e,(e=>i(e)),t));const r=getValueHolderInputTemplateProvider(this.assetType,this.attribute,this._attributeDescriptor,e,(e=>i(e)),t);this._templateProvider=jsonFormsInputTemplateProvider(r)(this.assetType,this.attribute,this._attributeDescriptor,e,(e=>i(e)),t),this._templateProvider||(this._templateProvider=r)}getLabel(){let e;if(this.label)e=this.label;else if(\"\"!==this.label&&null!==this.label){const t=AssetModelUtil.getAttributeAndValueDescriptors(this.assetType,this.attribute?this.attribute.name:void 0,this._attributeDescriptor);e=Util.getAttributeLabel(this.attribute,t[0],this.assetType,!0)}return e}isReadonly(){return manager.hasRole(\"write:attributes\")?void 0!==this.readonly?this.readonly:Util.getMetaValue(\"readOnly\",this.attribute,this._attributeDescriptor):(this.readonly=!manager.hasRole(\"write:attributes\"),this.readonly)}render(){if(!this.assetType||!this._templateProvider)return html``;const e=this.attributeRefs&&!this._attributeEvent||!!this._writeTimeoutHandler;let t;const i=this.getValue(),r=this._requestFocus;this._requestFocus=!1;const n=this.hasHelperText?getHelperText(!!this._writeTimeoutHandler,this._sendError,this.getTimestamp()):void 0,a=this.showButton?this._writeTimeoutHandler?\"send-clock\":\"send\":this.disableButton?void 0:\"\";return t=this._templateProvider&&this._templateProvider.templateFunction?html`${until(this._templateProvider.templateFunction(i,r,e,!!this._writeTimeoutHandler,this._sendError,this._templateProvider.supportsHelperText?n:void 0),\"\")}`:html`<or-translate .value=\"attributeUnsupported\"></or-translate>`,t=getAttributeInputWrapper(t,i,e,!!this.disabled,this._templateProvider.supportsHelperText?void 0:n,this._templateProvider.supportsLabel?void 0:this.getLabel(),this._templateProvider.supportsSendButton?a:void 0,(()=>this._updateValue()),this.fullWidth),t}updated(e){e.has(\"_writeTimeoutHandler\")&&!this._writeTimeoutHandler&&(this._requestFocus=!0,this.requestUpdate())}get showButton(){return!(this.isReadonly()||this.disabled||this.disableButton||!this._getAttributeRef())&&!!this._templateProvider&&this._templateProvider.supportsSendButton}getValue(){return this._attributeEvent?this._attributeEvent.value:this.attribute?this.attribute.value:this.value}getTimestamp(){return this._attributeEvent?this._attributeEvent.timestamp:this.attribute?this.attribute.timestamp:void 0}_onEvent(e){if(\"attribute\"!==e.eventType)return;const t=this.getValue();this._attributeEvent=e,this._onAttributeValueChanged(t,this._attributeEvent.value,e.timestamp)}checkValidity(){return!!this._templateProvider&&(!this._templateProvider.validator||this._templateProvider.validator())}_onAttributeValueChanged(e,t,i){this.attribute&&(this.attribute.value=t,this.attribute.timestamp=i),this._clearWriteTimeout(),this.value=t,this._sendError=!1,this.dispatchEvent(new OrAttributeInputChangedEvent(t,e))}_onInputValueChanged(e,t){this._newValue=e,t&&this._updateValue()}_updateValue(){if(this.readonly||this.isReadonly())return;if(this._writeTimeoutHandler)return;void 0===this._newValue&&(this._newValue=this.getValue());const e=this.getValue(),t=this._newValue;this._newValue=void 0;const i=this._getAttributeRef();i&&!this.disableWrite?(super._sendEvent({eventType:\"attribute\",ref:i,value:t}),this._writeTimeoutHandler=window.setTimeout((()=>this._onWriteTimeout()),this.writeTimeout)):(this.value=t,this.dispatchEvent(new OrAttributeInputChangedEvent(t,e)))}_clearWriteTimeout(){this._writeTimeoutHandler&&window.clearTimeout(this._writeTimeoutHandler),this._writeTimeoutHandler=void 0}_onWriteTimeout(){this._sendError=!0,this.showButton&&!this.hasHelperText||this.requestUpdate(\"value\"),this._clearWriteTimeout()}};__decorate([property({type:Object,reflect:!1})],OrAttributeInput.prototype,\"attribute\",void 0),__decorate([property({type:String})],OrAttributeInput.prototype,\"assetId\",void 0),__decorate([property({type:Object})],OrAttributeInput.prototype,\"attributeDescriptor\",void 0),__decorate([property({type:Object})],OrAttributeInput.prototype,\"valueDescriptor\",void 0),__decorate([property({type:String})],OrAttributeInput.prototype,\"assetType\",void 0),__decorate([property({type:String})],OrAttributeInput.prototype,\"label\",void 0),__decorate([property({type:Boolean})],OrAttributeInput.prototype,\"disabled\",void 0),__decorate([property({type:Boolean})],OrAttributeInput.prototype,\"readonly\",void 0),__decorate([property({type:Boolean,attribute:!0})],OrAttributeInput.prototype,\"required\",void 0),__decorate([property()],OrAttributeInput.prototype,\"value\",void 0),__decorate([property()],OrAttributeInput.prototype,\"inputType\",void 0),__decorate([property({type:Boolean})],OrAttributeInput.prototype,\"hasHelperText\",void 0),__decorate([property({type:Boolean})],OrAttributeInput.prototype,\"disableButton\",void 0),__decorate([property({type:Boolean,attribute:!0})],OrAttributeInput.prototype,\"disableSubscribe\",void 0),__decorate([property({type:Boolean})],OrAttributeInput.prototype,\"disableWrite\",void 0),__decorate([property({type:Boolean})],OrAttributeInput.prototype,\"compact\",void 0),__decorate([property({type:Boolean})],OrAttributeInput.prototype,\"comfortable\",void 0),__decorate([property({type:Boolean})],OrAttributeInput.prototype,\"resizeVertical\",void 0),__decorate([property({type:Boolean})],OrAttributeInput.prototype,\"fullWidth\",void 0),__decorate([property({type:Boolean})],OrAttributeInput.prototype,\"rounded\",void 0),__decorate([property({type:Boolean})],OrAttributeInput.prototype,\"outlined\",void 0),__decorate([property()],OrAttributeInput.prototype,\"_attributeEvent\",void 0),__decorate([property()],OrAttributeInput.prototype,\"_writeTimeoutHandler\",void 0),OrAttributeInput=__decorate([customElement(\"or-attribute-input\")],OrAttributeInput);export{OrAttributeInput};","var __decorate=this&&this.__decorate||function(t,e,i,o){var r,d=arguments.length,s=d<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(d<3?r(s):d>3?r(e,i,s):r(e,i))||s);return d>3&&s&&Object.defineProperty(e,i,s),s};import{css,html,LitElement}from\"lit\";import{customElement,property,query}from\"lit/decorators.js\";import ace from\"ace-builds\";import\"ace-builds/src-noconflict/mode-javascript\";import\"ace-builds/src-noconflict/mode-json\";import\"ace-builds/src-noconflict/mode-groovy\";import\"ace-builds/webpack-resolver\";export class OrAceEditorChangedEvent extends CustomEvent{constructor(t,e){super(OrAceEditorChangedEvent.NAME,{bubbles:!0,composed:!0,detail:{value:t,valid:e}})}}OrAceEditorChangedEvent.NAME=\"or-ace-editor-changed\";export class OrAceEditorEditEvent extends CustomEvent{constructor(){super(OrAceEditorEditEvent.NAME,{bubbles:!0,composed:!0})}}OrAceEditorEditEvent.NAME=\"or-ace-editor-edit\";let OrAceEditor=class extends LitElement{constructor(){super(...arguments),this.mode=\"ace/mode/json\",this._lastValue=\"\",this._editing=!1}static get styles(){return css`\n            :host {\n                display: block;\n                width: 100%;\n                height: 100%;\n            }\n        \n            #ace-editor {\n                position: relative;\n                height: 100%;\n                width: 100%;\n            }\n        \n            @media screen and (max-width: 1400px) {\n                :host > * {\n                    flex-grow: 0;\n                }\n        \n                :host {\n                    flex-direction: column;\n                }\n            }\n        `}disconnectedCallback(){this.destroyEditor(),super.disconnectedCallback()}updated(t){super.updated(t),t.has(\"mode\")&&(this.destroyEditor(),this.initEditor()),t.has(\"value\")&&this._aceEditor&&(this._lastValue=void 0!==this.value?\"string\"==typeof this.value?this.value:JSON.stringify(this.value,null,2):\"\",this._aceEditor.setValue(this._lastValue))}render(){return html`\n            <div id=\"ace-editor\"></div>\n        `}destroyEditor(){this._aceEditor&&(this._aceEditor.destroy(),this._aceEditor=void 0)}initEditor(){this._aceElem&&(this._aceEditor=ace.edit(this._aceElem,{mode:this.mode,value:this._lastValue,useSoftTabs:!0,tabSize:2,readOnly:this.readonly,showPrintMargin:!1}),this._aceEditor.renderer.attachToShadowRoot(),this._aceEditor.getSession().on(\"changeAnnotation\",(()=>this._onEditorChange())),this._aceEditor.on(\"change\",(()=>this._onEditorEdit())))}_onEditorEdit(){this._editing||(this.dispatchEvent(new OrAceEditorEditEvent),this._editing=!0),this._changeTimer&&window.clearTimeout(this._changeTimer),this._changeTimer=window.setTimeout((()=>{this._changeTimer=void 0,this._editing&&this._onEditorChange()}),600)}_onEditorChange(){this._editing=!1;const t=this.getValue()||\"\";if(this._lastValue!==t){this._lastValue=t;const e=this.validate();this.dispatchEvent(new OrAceEditorChangedEvent(t,e))}}getValue(){if(this._aceEditor)return this._aceEditor.getValue()}validate(){if(!this._aceEditor)return!1;const t=this._aceEditor.getSession().getAnnotations();return!t||0===t.length}};__decorate([property({type:Boolean,attribute:!1})],OrAceEditor.prototype,\"readonly\",void 0),__decorate([property({attribute:!1})],OrAceEditor.prototype,\"value\",void 0),__decorate([property({type:String,attribute:!1})],OrAceEditor.prototype,\"mode\",void 0),__decorate([query(\"#ace-editor\")],OrAceEditor.prototype,\"_aceElem\",void 0),OrAceEditor=__decorate([customElement(\"or-ace-editor\")],OrAceEditor);export{OrAceEditor};","import{composeWithUi,createDefaultValue,deriveTypes,getAjv,getData,getRenderers,getSchema,hasShowRule,isVisible,Resolve,resolveSchema,resolveSubSchemas}from\"@jsonforms/core\";import{DefaultColor5,Util}from\"@openremote/core\";import{InputType}from\"@openremote/or-mwc-components/or-mwc-input\";import{i18next}from\"@openremote/or-translate\";import\"@openremote/or-components/or-ace-editor\";import{html,unsafeCSS}from\"lit\";import{createRef,ref}from\"lit/directives/ref.js\";import{unknownTemplate}from\"./standard-renderers\";import{OrMwcDialog,showDialog}from\"@openremote/or-mwc-components/or-mwc-dialog\";export function getTemplateFromProps(e,t){if(!e||!t)return html``;const o=t.renderers||getRenderers({jsonforms:Object.assign({},e)}),r=t.schema,i=t.uischema;let s;if(o&&r&&i){const n=o.map((e=>[e,e.tester(i,r)])).sort(((e,t)=>t[1]-e[1])),a=n&&n.length>0?n[0]:void 0;s=a&&-1!==a[1]?a[0].renderer(e,t):unknownTemplate()}return s}export function getCombinatorInfos(e,t){return e.map((e=>{let o,r,i;const s=findSchemaTitleAndDescription(e,t);if(e.$ref&&(e=Resolve.schema(t,e.$ref)),Array.isArray(e.allOf)&&(e=resolveSubSchemas(e,t,\"allOf\")),deriveTypes(e).every((e=>\"object\"===e))){const t=getSchemaObjectProperties(e).find((([e,t])=>void 0!==getSchemaConst(t)));t?(o=t[0],r=getSchemaConst(t[1]),i=()=>{const e={};return e[t[0]]=getSchemaConst(t[1]),e},s[0]||(s[0]=getSchemaConst(t[1]))):i=()=>createDefaultValue(e)}else i=()=>createDefaultValue(e);return{title:s[0],description:s[1],defaultValueCreator:i,constProperty:o,constValue:r}}))}export function getSchemaConst(e){if(e)return void 0!==e.const?e.const:Array.isArray(e.enum)&&1===e.enum.length?e.enum[0]:void 0}export function getSchemaPicker(e,t,o,r,i,s){const n=getCombinatorInfos(t[r],e),a=n.map(((e,t)=>[t+\"\",e.title||i18next.t(\"schema.title.indexedItem\",{index:t})])),c=i?i18next.t(\"schema.anyOfPickerLabel\",{label:i}):i18next.t(\"type\");return html`                \n        <or-mwc-input class=\"any-of-picker\" .label=\"${c}\" .type=\"${InputType.SELECT}\" .options=\"${a}\" @or-mwc-input-changed=\"${e=>(e=>{const t=n[e];s(t)})(Number(e.detail.value))}\"></or-mwc-input>\n    `}export function findSchemaTitleAndDescription(e,t){let o;if(e.$ref&&(o=getLabelFromScopeOrRef(e.$ref),e=Resolve.schema(t,e.$ref)),e.title)return[e.title,e.description];if(e.allOf){const o=resolveSubSchemas(e,t,\"allOf\").allOf.find((e=>!!e.title));if(o)return[o.title,o.description]}return[i18next.t(\"schema.title.\"+o,{defaultValue:Util.camelCaseToSentenceCase(o)}),void 0]}function getLabelFromScopeOrRef(e){return e.substr(e.lastIndexOf(\"/\")+1)}function getSchemaObjectProperties(e){let t=[];return e.allOf?t=e.allOf.map((e=>e.properties?Object.entries(e.properties):[])).flat():e.properties&&(t=Object.entries(e.properties)),t}export function mapStateToCombinatorRendererProps(e,t,o){const{uischema:r}=t,i=composeWithUi(r,t.path),s=getSchema(e),n=Resolve.schema(t.schema||s,r.scope,s),a=void 0===t.visible||hasShowRule(r)?isVisible(r,getData(e),t.path,getAjv(e)):t.visible,c=t.id,l=Resolve.data(getData(e),i),m=e.jsonforms.core.ajv,p=n||s,u=resolveSubSchemas(p,s,o),f=[\"required\",\"additionalProperties\",\"type\",\"enum\",\"const\"];let d=-1;for(let e=0;e<u[o].length;e++)try{const t=Object.assign({definitions:s.definitions},u[o][e]),r=m.compile(t);if(r(l),!(h=r.errors)||0===h.length||!h.find((e=>-1!==f.indexOf(e.keyword)))){d=e;break}}catch(e){console.debug(\"Combinator subschema is not self contained, can't hand it over to AJV\")}var h;return{data:l,path:i,schema:p,rootSchema:s,visible:a,id:c,indexOfFittingSchema:d,uischemas:e.jsonforms.uischemas,uischema:r}}export function getLabel(e,t,o,r){if(o)return o;const i=findSchemaTitleAndDescription(e,t);return i[0]?i[0]:r?Util.camelCaseToSentenceCase(getLabelFromScopeOrRef(r)):void 0}export function resolveSubSchemasRecursive(e,t,o){const r=o?[o]:[\"allOf\",\"anyOf\",\"oneOf\"];return e.$ref?resolveSubSchemasRecursive(resolveSchema(t,e.$ref),t):(r.forEach((o=>{const r=e[o];r&&(e[o]=r.map((e=>resolveSubSchemasRecursive(e,t))))})),e.items&&(Array.isArray(e.items)?e.items=e.items.map((e=>resolveSubSchemasRecursive(e,t))):e.items=resolveSubSchemasRecursive(e.items,t)),e.properties&&Object.keys(e.properties).forEach((o=>e.properties[o]=resolveSubSchemasRecursive(e.properties[o],t))),e)}export const controlWithoutLabel=e=>({type:\"Control\",scope:e,label:!1});export const showJsonEditor=(e,t,o)=>{const r=createRef(),i=createRef();showDialog((new OrMwcDialog).setContent(html`\n                <or-ace-editor ${ref(r)} @or-ace-editor-edit=\"${()=>{i.value.disabled=!0}}\" @or-ace-editor-changed=\"${e=>(e=>{const t=e.detail.valid;i.value.disabled=!t})(e)}\" .value=\"${t}\"></or-ace-editor>\n            `).setActions([{actionName:\"cancel\",content:\"cancel\"},{default:!0,actionName:\"update\",action:()=>{const e=r.value;if(e.validate()){const t=e.getValue()?JSON.parse(e.getValue()):void 0;o(t)}},content:html`<or-mwc-input ${ref(i)} disabled .type=\"${InputType.BUTTON}\" label=\"update\"></or-mwc-input>`}]).setHeading(e).setDismissAction(null).setStyles(html`\n                <style>\n                    .mdc-dialog__surface {\n                        width: 1024px;\n                        overflow-x: visible !important;\n                        overflow-y: visible !important;\n                    }\n                    #dialog-content {\n                        border-color: var(--or-app-color5, ${unsafeCSS(DefaultColor5)});\n                        border-top-width: 1px;\n                        border-top-style: solid;\n                        border-bottom-width: 1px;\n                        border-bottom-style: solid;\n                        padding: 0;\n                        overflow: visible;\n                        height: 60vh;\n                    }\n                </style>\n            `))};","var __decorate=this&&this.__decorate||function(e,t,i,o){var r,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(n<3?r(a):n>3?r(t,i,a):r(t,i))||a);return n>3&&a&&Object.defineProperty(t,i,a),a};import{css,html,LitElement,unsafeCSS}from\"lit\";import{customElement,property,query}from\"lit/decorators.js\";import{DefaultColor5}from\"@openremote/core\";const style=css`\n\n    :host {\n        display: block;\n        box-sizing: content-box;\n        margin: 0;\n        overflow: hidden;\n        transition: margin 225ms cubic-bezier(0.4, 0, 0.2, 1), box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);\n        position: relative;\n        border-color: var(--or-app-color5, ${unsafeCSS(DefaultColor5)});\n        background-color: var(--or-collapisble-panel-background-color);\n        border-radius: 4px;\n        border-width: 1px;\n        border-style: solid;\n    }\n\n    :host([hidden]) {\n        display: none;\n    }\n    \n    #header {\n        display: flex;\n        height: 48px;\n        flex-direction: row;\n        font-family: Roboto,Helvetica Neue,sans-serif;\n        font-size: 15px;\n        font-weight: 400;\n        align-items: center;\n        padding: 0 24px 0 16px;\n        border-radius: inherit;\n    }\n    \n    #header.expandable {\n        cursor: pointer;\n        transition: height 225ms cubic-bezier(0.4, 0, 0.2, 1);\n    }\n    \n    #header.expanded {\n        height: 64px;\n    }\n\n    #header.expanded > #indicator {\n    }\n    \n    #header-content {\n        flex: 1;\n        display: flex;\n        flex-direction: row;\n        overflow: hidden;\n    }\n\n    #header-title, #header-description {\n        display: inline-flex;\n        align-items: center;\n    }\n    \n    #header-description {\n        flex-grow: 2;\n    }\n    \n    #indicator {\n        align-self: center;\n        margin-right: 6px;\n        margin-left: -5px;\n    }\n    \n    #content {\n        height: 0;\n        visibility: hidden;\n    }\n    \n    #content.expanded {\n        height: unset;\n        visibility: visible;\n    }\n\n    or-icon {\n        vertical-align: middle;\n        --or-icon-width: 20px;\n        --or-icon-height: 20px;\n        margin-right: 2px;\n        margin-left: -5px;\n    }\n`;let OrCollapsiblePanel=class extends LitElement{constructor(){super(...arguments),this.expanded=!1,this.expandable=!0}static get styles(){return[style]}_onHeaderClicked(e){this.expandable&&(e.preventDefault(),this.expanded=!this.expanded)}render(){return html`\n            <div id=\"header\" class=\"${this.expandable?\"expandable\":\"\"} ${this.expandable&&this.expanded?\"expanded\":\"\"}\" @click=\"${e=>this._onHeaderClicked(e)}\">\n                ${this.expandable?html`<or-icon icon=\"chevron-${this.expanded?\"down\":\"right\"}\"></or-icon>`:\"\"}\n                <span id=\"header-content\">\n                    <span id=\"header-title\"><slot name=\"header\"></slot></span>\n                    <span id=\"header-description\"><slot name=\"header-description\"></slot></span>\n                </span>\n            </div>\n            <div id=\"content\" class=\"${this.expandable&&this.expanded?\"expanded\":\"\"}\">\n                <slot name=\"content\"></slot>\n            </div>\n        `}};__decorate([property({type:Boolean})],OrCollapsiblePanel.prototype,\"expanded\",void 0),__decorate([property({type:Boolean})],OrCollapsiblePanel.prototype,\"expandable\",void 0),__decorate([query(\"#header\")],OrCollapsiblePanel.prototype,\"headerElem\",void 0),OrCollapsiblePanel=__decorate([customElement(\"or-collapsible-panel\")],OrCollapsiblePanel);export{OrCollapsiblePanel};","import{DefaultColor3,DefaultColor4,DefaultColor5}from\"@openremote/core\";import{css,html,unsafeCSS}from\"lit\";export const baseStyle=css`\n    :host {\n        flex: 1;\n    }\n    \n    .item-container {\n        display: flex;\n    }\n    \n    .delete-container, .drag-container {\n        width: 30px;\n        display: flex;\n        vertical-align: middle;\n    }\n    \n    .item-container:hover .button-clear, .item-wrapper:hover .button-clear {\n        visibility: visible;\n    }\n    \n    .no-match-container {\n        align-items: center;\n    }\n\n    .no-match-container > *:not(:last-child) {\n        margin-right: 10px;\n    }\n\n    .button-clear {\n        background: none;\n        color: ${unsafeCSS(DefaultColor5)};\n        --or-icon-fill: ${unsafeCSS(DefaultColor5)};\n        visibility: hidden;\n        display: inline-block;\n        border: none;\n        padding: 0 0 0 5px;\n        cursor: pointer;\n    }                \n    .button-clear:hover {\n        --or-icon-fill: ${unsafeCSS(DefaultColor4)};\n    }                \n    .button-clear:focus {\n        outline: 0;\n    }                \n    .button-clear.hidden {\n        visibility: hidden;\n    }\n    \n    .any-of-picker {\n        width: 100%;\n        min-width: 200px;\n    }\n\n    #errors {\n        color: red;\n        margin-right: 10px;\n        flex: 1;\n        display: flex;\n        align-items: center;\n    }\n\n    #errors > or-icon {\n        margin-right: 5px;\n    }\n`;export const panelStyle=css`\n    #header-description {\n        flex: 1;\n        display: flex;\n        flex-direction: row;\n    }\n\n    #type-label {\n        border: 1px solid green;\n        border-radius: 3px;\n        padding: 3px;\n        margin-left: 10px;\n    }\n\n    #header-buttons {\n        flex: 0;\n    }\n\n    #content-wrapper {\n        flex: 1;\n        padding: 0 4px 14px 24px;\n    }\n\n    #content {\n        display: flex;\n        flex-direction: column;\n    }\n\n    #content > * {\n        flex: 1;\n    }\n\n    .item-container + .item-container {\n        padding-top: 10px;\n    }\n\n    #footer {\n        margin-top: 10px;\n    }\n\n`;export const addItemOrParameterDialogStyle=html`\n    <style>\n        .mdc-dialog__surface {\n            width: 800px;\n            overflow-x: visible !important;\n            overflow-y: visible !important;\n        }\n        #dialog-content {\n            border-color: var(--or-app-color5, ${unsafeCSS(DefaultColor5)});\n            border-top-width: 1px;\n            border-top-style: solid;\n            border-bottom-width: 1px;\n            border-bottom-style: solid;\n            padding: 0;\n        }\n        form {\n            display: flex;\n            height: 100%;\n        }\n        #type-list {\n            overflow: auto;\n            min-width: 150px;\n            max-width: 300px;\n            flex: 0 0 40%;\n            border-right: 1px solid var(--or-app-color5, #CCC);\n        }\n        #parameter-list {\n            display: block;\n        }\n        #parameter-title {\n            text-transform: capitalize;\n            color: var(--or-app-color3, ${unsafeCSS(DefaultColor3)});\n            font-size: 18px;\n            font-weight: bold;\n        }\n        #parameter-desc {\n            padding: 15px;\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n            justify-content: flex-start;\n            overflow: auto;\n        }\n    </style>\n`;","var __decorate=this&&this.__decorate||function(e,t,i,a){var r,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};import{computeLabel,createDefaultValue,getSchema,isControl,mapStateToControlProps,Paths}from\"@jsonforms/core\";import{css,html}from\"lit\";import{customElement,property}from\"lit/decorators.js\";import{LayoutBaseElement}from\"./layout-base-element\";import{controlWithoutLabel,getLabel,getSchemaPicker,getTemplateFromProps,showJsonEditor}from\"../util\";import{InputType}from\"@openremote/or-mwc-components/or-mwc-input\";import{i18next}from\"@openremote/or-translate\";import{OrMwcDialog,showDialog}from\"@openremote/or-mwc-components/or-mwc-dialog\";import\"@openremote/or-mwc-components/or-mwc-list\";import\"@openremote/or-components/or-collapsible-panel\";import{addItemOrParameterDialogStyle,baseStyle,panelStyle}from\"../styles\";const style=css`\n    \n    #dynamic-wrapper {\n        display: table;\n    }\n    \n    #dynamic-wrapper .row {\n        display: table-row;\n    }\n    \n    #dynamic-wrapper .row:hover .button-clear {\n        visibility: visible;\n    }\n    \n    #dynamic-wrapper .row > div {\n        display: table-cell;\n    }\n    \n    .value-container {\n        padding: 0 0 20px 10px;\n    }\n\n    .key-container {\n        padding: 0 10px 20px 0;\n    }\n\n    .value-container, .key-container {\n        vertical-align: top;\n    }\n\n    .key-container or-mwc-input, .value-container or-mwc-input {\n        display: block;\n    }\n\n    .value-container > .item-container {\n        margin: 0;\n    }\n\n    .value-container > .item-container > .delete-container {\n        display: none;\n    }\n\n    .value-container > .item-container :first-child {\n        border: 0;\n        padding: 0;\n        margin: 0;\n        flex: 1;\n    }\n`;function isDynamic(e){return void 0===e.allOf&&void 0===e.anyOf&&(void 0===e.properties||0===Object.keys(e.properties).length)}let LayoutVerticalElement=class extends LayoutBaseElement{static get styles(){return[baseStyle,panelStyle,style]}render(){const e=[],t={jsonforms:Object.assign({},this.state)},i=getSchema(t),a=isDynamic(this.schema);let r,o=\".+\";if(a)if(\"object\"==typeof this.schema.patternProperties){const e=Object.entries(this.schema.patternProperties);1===e.length&&(o=e[0][0],r=e[0][1])}else\"object\"==typeof this.schema.additionalProperties&&(r=this.schema.additionalProperties);const s=this.minimal?\"\":html`\n            <div slot=\"header\">\n                <span>${this.label?computeLabel(this.label,this.required,!1):\"\"}</span>\n                ${this.type?html`<span id=\"type-label\">${this.type}</span>`:\"\"}\n            </div>\n            <div id=\"header-description\" slot=\"header-description\">\n                <div id=\"errors\">\n                    ${this.errors?html`<or-icon icon=\"alert\"></or-icon><span>${this.errors}</span>`:\"\"}\n                </div>\n                <div id=\"header-buttons\"><or-mwc-input .type=\"${InputType.BUTTON}\" outlined label=\"json\" icon=\"pencil\" @or-mwc-input-changed=\"${e=>this._showJson(e)}\"></or-mwc-input></div>\n            </div>\n        `;let l;a&&r?l=this._getDynamicContentTemplate(o,r):this.getChildProps().length>0&&(l=this.getChildProps().map((a=>{if(isControl(a.uischema)){const r=mapStateToControlProps(t,a);if(r.label=r.label||getLabel(this.schema,i,void 0,a.uischema.scope)||\"\",a.label=r.label,a.required=!!r.required,!r.required&&void 0===r.data)return e.push(r),html``}return getTemplateFromProps(this.state,a)})).filter((e=>void 0!==e)));const n=!!l&&(!Array.isArray(l)||l.length>0)||!this.errors&&e.length>0,c=html`\n            ${s}\n            <div id=\"content-wrapper\" slot=\"content\">\n                <div id=\"content\">\n                    ${l||\"\"}\n                </div>\n\n                ${this.errors||0===e.length&&!a?\"\":html`\n                        <div id=\"footer\">\n                            <or-mwc-input .type=\"${InputType.BUTTON}\" label=\"addParameter\" icon=\"plus\" @or-mwc-input-changed=\"${()=>this._addParameter(i,e,o,r)}\"></or-mwc-input>\n                        </div>`}\n            </div>\n        `;return this.minimal?html`<div>${c}</div>`:html`<or-collapsible-panel .expandable=\"${n}\">${c}</or-collapsible-panel>`}_getDynamicContentTemplate(e,t){if(!this.data)return;const i=e=>{const t=Object.assign({},this.data);delete t[e],this.handleChange(this.path,t)},a=(e,t,i)=>{if(!e.valid)return;if(void 0!==this.data[i])return void e.setCustomValidity(i18next.t(\"validation.keyAlreadyExists\"));e.setCustomValidity(void 0);const a=Object.assign({},this.data),r=a[t];delete a[t],a[i]=r,this.handleChange(this.path,a)},r={renderers:this.renderers,uischema:controlWithoutLabel(\"#\"),enabled:this.enabled,visible:this.visible,path:\"\",schema:t,minimal:!0,required:!1,label:\"\"},o=(e,t)=>(r.path=Paths.compose(this.path,e),getTemplateFromProps(this.state,r)||html``);return html`\n            <div id=\"dynamic-wrapper\">\n                ${Object.entries(this.data).map((([t,r])=>html`\n                        <div class=\"row\">\n                            <div class=\"key-container\">\n                                <or-mwc-input .type=\"${InputType.TEXT}\" @or-mwc-input-changed=\"${e=>a(e.currentTarget,t,e.detail.value)}\" required .pattern=\"${e}\" .value=\"${t}\"></or-mwc-input>\n                            </div>\n                            <div class=\"value-container\">\n                                ${o(t)}\n                            </div>\n                            <div class=\"delete-container\">\n                                <button class=\"button-clear\" @click=\"${()=>i(t)}\"><or-icon icon=\"close-circle\"></or-icon></input>\n                            </div>\n                        </div>\n                    `))}\n            </div>\n        `}_showJson(e){e.stopPropagation(),showJsonEditor(this.title||this.schema.title||\"\",this.data,(e=>{this.handleChange(this.path||\"\",e)}))}_addParameter(e,t,i,a){const r=0===t.length;let o,s;const l=t.map((e=>{const t=computeLabel(e.label,!!e.required,!1);return{text:t,value:t,data:e}}));let n;const c=e=>{const t=e.currentTarget;t.setCustomValidity(void 0),n=t.currentValue;let i=t.valid;void 0!==this.data[n]&&(i=!1,t.setCustomValidity(i18next.t(\"validation.keyAlreadyExists\"))),d.shadowRoot.getElementById(\"add-btn\").disabled=!i},d=showDialog((new OrMwcDialog).setContent((()=>{let t;if(o&&o.schema&&o.schema.oneOf){const i=e=>{s=e,d.shadowRoot.getElementById(\"add-btn\").disabled=!s,d.shadowRoot.getElementById(\"schema-description\").innerHTML=(s?s.description:i18next.t(\"schema.selectTypeMessage\"))||i18next.t(\"schema.noDescriptionAvailable\")};t=getSchemaPicker(e,o.schema,o.path,\"oneOf\",o.label,i)}return html`\n                <div class=\"col\">\n                    <form id=\"mdc-dialog-form-add\" class=\"row\">\n                        ${r?\"\":html`\n                            <div id=\"type-list\" class=\"col\">\n                                <or-mwc-list @or-mwc-list-changed=\"${e=>{1===e.detail.length&&(e=>{o=e;const t=!!(o&&o.schema&&o.schema.oneOf);d.shadowRoot.getElementById(\"add-btn\").disabled=t,d.requestUpdate()})(e.detail[0].data)}}\" .listItems=\"${l}\" id=\"parameter-list\"></or-mwc-list>\n                            </div>\n                        `}\n                        <div id=\"parameter-desc\" class=\"col\">\n                            ${o?html`\n                                <or-translate id=\"parameter-title\" value=\"${o.label}\"></or-translate>\n                                <p>${o.description}</p>`:\"\"}\n                            ${r?html`\n                                <style>\n                                    #dynamic-wrapper > or-mwc-input {\n                                        display: block;\n                                        margin: 10px;\n                                    }\n                                </style>\n                                <div id=\"dynamic-wrapper\">\n                                    <or-mwc-input required .type=\"${InputType.TEXT}\" .pattern=\"${i}\" .label=\"${i18next.t(\"schema.keyInputLabel\")}\" @keyup=\"${e=>c(e)}\"></or-mwc-input>\n                                </div>\n                            `:t?html`\n                                <style>\n                                    #schema-picker {\n                                        align-self: stretch;\n                                        margin: 10px;\n                                        display: flex;\n                                        align-items: center;\n                                    }\n                                    #schema-picker > or-translate {\n                                        padding-right: 20px;\n                                    }\n                                    #schema-picker > or-mwc-input {\n                                        flex: 1;\n                                    }\n                                </style>\n                                <div id=\"schema-picker\">\n                                    <or-translate style=\"justify-self: left;\" value=\"type\"></or-translate>\n                                    ${t}\n                                </div>\n                                <p id=\"schema-description\">${i18next.t(\"schema.selectTypeMessage\")}</p>`:\"\"}\n                        </div>\n                    </form>\n                </div>\n            `})).setStyles(addItemOrParameterDialogStyle).setHeading((this.label?computeLabel(this.label,this.required,!1)+\" - \":\"\")+i18next.t(\"addParameter\")).setActions([{actionName:\"cancel\",content:\"cancel\"},{default:!0,actionName:\"add\",action:()=>{const e=r?n:o.path.split(\".\").pop(),t=Object.assign({},this.data),i=r?a:o.schema;t[e]=Array.isArray(i.type)?null:(s?s.defaultValueCreator():void 0)||createDefaultValue(i),this.handleChange(this.path||\"\",t)},content:html`<or-mwc-input id=\"add-btn\" .type=\"${InputType.BUTTON}\" disabled label=\"add\"></or-mwc-input>`}]).setDismissAction(null))}};__decorate([property()],LayoutVerticalElement.prototype,\"minimal\",void 0),__decorate([property()],LayoutVerticalElement.prototype,\"type\",void 0),LayoutVerticalElement=__decorate([customElement(\"or-json-forms-vertical-layout\")],LayoutVerticalElement);export{LayoutVerticalElement};","var __decorate=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};import{InputType}from\"@openremote/or-mwc-components/or-mwc-input\";import{css,html}from\"lit\";import{customElement}from\"lit/decorators.js\";import{ControlBaseElement}from\"./control-base-element\";import{baseStyle}from\"../styles\";import{isBooleanControl,isEnumControl,isIntegerControl,isNumberControl,isOneOfEnumControl,isStringControl}from\"@jsonforms/core\";import{isEnumArray}from\"../standard-renderers\";const style=css`\n    or-mwc-input {\n        width: 100%;\n    }\n`;let ControlInputElement=class extends ControlBaseElement{static get styles(){return[baseStyle,style]}render(){var t;const e=this.uischema,n=this.schema,i=this.schema.format;let r,o,s,p,l,a,m;this.inputType=InputType.TEXT;let u=!1,y=null!==(t=this.data)&&void 0!==t?t:n.default;return Array.isArray(n.type)?this.inputType=InputType.JSON:isBooleanControl(e,n)?this.inputType=InputType.CHECKBOX:isNumberControl(e,n)||isIntegerControl(e,n)?(r=isNumberControl(e,n)?.1:1,this.inputType=InputType.NUMBER,o=n.minimum,p=n.maximum,r=n.multipleOf||r,void 0!==o&&void 0!==p&&\"or-range\"===i&&(p-o)/r<=200&&(this.inputType=InputType.RANGE)):isEnumControl(e,n)||isOneOfEnumControl(e,n)||isEnumArray(e,n)?(this.inputType=InputType.SELECT,isEnumControl(e,n)?m=n.enum.map((t=>[JSON.stringify(t),String(t)])):isOneOfEnumControl(e,n)?m=n.oneOf.map((t=>[JSON.stringify(t.const),String(t.const)])):(u=!0,m=n.items.oneOf?n.items.oneOf.map((t=>[JSON.stringify(t.const),String(t.const)])):n.items.enum.map((t=>[JSON.stringify(t),String(t)]))),y=u?Array.isArray(y)?y.map((t=>JSON.stringify(t))):void 0!==y?[JSON.stringify(y)]:void 0:void 0!==y?JSON.stringify(y):void 0):isStringControl(e,n)&&(s=n.minLength,l=n.maxLength,a=n.pattern,\"date-time\"===i?this.inputType=InputType.DATETIME:\"date\"===i?this.inputType=InputType.DATE:\"time\"===i?this.inputType=InputType.TIME:\"email\"===i?this.inputType=InputType.EMAIL:\"tel\"===i?this.inputType=InputType.TELEPHONE:\"or-multiline\"===i?this.inputType=InputType.TEXTAREA:(\"or-password\"===i||n.writeOnly)&&(this.inputType=InputType.PASSWORD)),html`<or-mwc-input\n                .label=\"${this.label}\"\n                .type=\"${this.inputType}\"\n                .disabled=\"${!this.enabled}\"\n                .required=\"${!!this.required}\"\n                .id=\"${this.id}\"\n                .options=\"${m}\"\n                .multiple=\"${u}\"\n                @or-mwc-input-changed=\"${t=>this.onValueChanged(t)}\"\n                .maxLength=\"${l}\"\n                .minLength=\"${s}\"\n                .pattern=\"${a}\"\n                .validationMessage=\"${this.errors}\"\n                .step=\"${r}\"\n                .max=\"${p}\"\n                .min=\"${o}\"\n                .value=\"${y}\"></or-mwc-input>`}onValueChanged(t){this.inputType===InputType.SELECT?Array.isArray(t.detail.value)?this.handleChange(this.path,t.detail.value.map((t=>JSON.parse(t)))):this.handleChange(this.path,JSON.parse(t.detail.value)):this.handleChange(this.path,t.detail.value)}};ControlInputElement=__decorate([customElement(\"or-json-forms-input-control\")],ControlInputElement);export{ControlInputElement};","var __decorate=this&&this.__decorate||function(t,e,r,o){var a,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,o);else for(var n=t.length-1;n>=0;n--)(a=t[n])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s};import{computeLabel,createDefaultValue,mapDispatchToArrayControlProps,Paths,Resolve,update}from\"@jsonforms/core\";import{css,html,unsafeCSS}from\"lit\";import{customElement,property}from\"lit/decorators.js\";import{controlWithoutLabel,getCombinatorInfos,getTemplateFromProps,showJsonEditor}from\"../util\";import{InputType}from\"@openremote/or-mwc-components/or-mwc-input\";import{i18next}from\"@openremote/or-translate\";import{OrMwcDialog,showDialog}from\"@openremote/or-mwc-components/or-mwc-dialog\";import\"@openremote/or-mwc-components/or-mwc-list\";import{addItemOrParameterDialogStyle,baseStyle,panelStyle}from\"../styles\";import{DefaultColor4,DefaultColor5}from\"@openremote/core\";import{ControlBaseElement}from\"./control-base-element\";import{getTemplateWrapper}from\"../index\";const style=css`\n    .item-border, .drag-handle {\n        border-color: var(--or-app-color5, ${unsafeCSS(DefaultColor5)});\n        border-radius: 4px;\n        border-width: 1px;\n        border-style: solid;\n    }\n\n    .item-wrapper {\n        display: flex;\n    }\n    \n    .item-wrapper > .item-container {\n        flex: 1;\n    }\n\n    .item-wrapper + .item-wrapper {\n        padding-top: 10px;\n    }\n    \n    .item-wrapper > .item-container > .item-container {\n        margin: 0;\n        flex: 1;\n    }\n\n    .item-wrapper > .item-container > .item-container > .delete-container {\n        display: none;\n    }\n\n    .item-wrapper > .item-container > .item-container :first-child {\n        padding: 0;\n        margin: 0;\n        flex: 1;\n    }\n\n    .item-wrapper.dragging > .item-container {\n        opacity: 0.5;\n    }\n\n    .item-wrapper.indicator-after {\n        border-bottom-width: 3px;\n        border-bottom-style: solid;\n        border-bottom-color: var(--or-app-color4, ${unsafeCSS(DefaultColor4)});\n    }\n\n    .item-wrapper.indicator-before {\n        border-top-width: 3px;\n        border-top-style: solid;\n        border-top-color: var(--or-app-color4, ${unsafeCSS(DefaultColor4)});\n    }\n    \n    .drag-container > button {\n        cursor: grab;\n    }\n`;let ControlArrayElement=class extends ControlBaseElement{static get styles(){return[baseStyle,panelStyle,style]}shouldUpdate(t){if(t.has(\"schema\")&&(this.itemInfos=void 0,this.resolvedSchema=Resolve.schema(this.schema,\"items\",this.rootSchema),Array.isArray(this.resolvedSchema.anyOf)?this.itemInfos=getCombinatorInfos(this.resolvedSchema.anyOf,this.rootSchema):Array.isArray(this.resolvedSchema.oneOf)&&(this.itemInfos=getCombinatorInfos(this.resolvedSchema.oneOf,this.rootSchema))),t.has(\"state\")){const t=mapDispatchToArrayControlProps(this.state.dispatch);this.addItem=e=>t.addItem(this.path,e)(),this.removeItem=e=>{t.removeItems(this.path,[e])()},this.moveItem=(t,e)=>{this.state.dispatch(update(this.path,(r=>(((t,e,r)=>{let o=1;const a=t.splice(e,o)[0];o=0,t.splice(r,o,a)})(r,t,e),r))))}}return super.shouldUpdate(t)}render(){var t;const e=null!==(t=this.schema.maxItems)&&void 0!==t?t:Number.MAX_SAFE_INTEGER,r=Array.isArray(this.data)?this.data.length:0,o=this.minimal?\"\":html`\n            <span slot=\"header\">${this.label?computeLabel(this.label,this.required,!1):\"\"}</span>\n            <div id=\"header-description\" slot=\"header-description\">\n                <div id=\"errors\">\n                    ${this.errors?html`<or-icon icon=\"alert\"></or-icon><span>${this.errors}</span>`:\"\"}\n                </div>\n                <div id=\"header-buttons\"><or-mwc-input .type=\"${InputType.BUTTON}\" outlined label=\"json\" icon=\"pencil\" @or-mwc-input-changed=\"${t=>this._showJson(t)}\"></or-mwc-input></div>\n            </div>\n        `,a=html`\n            ${o}\n            <div id=\"content-wrapper\" slot=\"content\">\n                <div id=\"content\" @dragover=\"${t=>this._onDragOver(t)}\">\n                    \n                    ${Array.isArray(this.data)?this.data.map(((t,e)=>{const r=Paths.compose(this.path,\"\"+e),o={renderers:this.renderers,uischema:controlWithoutLabel(\"#\"),schema:this.resolvedSchema,path:r};return this.getArrayItemWrapper(getTemplateFromProps(this.state,o)||html``,e)})):\"\"}\n\n                </div>\n                ${this.errors?\"\":html`\n                    <div id=\"footer\">\n                        <or-mwc-input .disabled=\"${r&&r>=e}\" .type=\"${InputType.BUTTON}\" label=\"addItem\" icon=\"plus\" @or-mwc-input-changed=\"${()=>this.doAddItem()}\"></or-mwc-input>\n                    </div>\n                `}\n            </div>\n        `;return this.minimal?html`<div>${a}</div>`:html`<or-collapsible-panel>${a}</or-collapsible-panel>`}getArrayItemWrapper(t,e){return html`\n            <div class=\"item-wrapper\" data-index=\"${e}\">\n                <div class=\"drag-container\">\n                    <button draggable=\"true\" @dragstart=\"${t=>this._onDragStart(t)}\" @dragend=\"${t=>this._onDragEnd(t)}\" class=\"draggable button-clear\"><or-icon icon=\"menu\"></or-icon></input>\n                </div>\n                ${getTemplateWrapper(t,(()=>this.removeItem(e)))}\n            </div>\n        `}_onDragStart(t){const e=t.currentTarget.parentElement.parentElement;e.classList.add(\"dragging\");const r=e.lastElementChild;t.dataTransfer.setDragImage(r,r.getBoundingClientRect().width/2-50,0)}_onDragEnd(t){const e=[...this.shadowRoot.querySelectorAll(\".item-wrapper\")],r=t.currentTarget.parentElement.parentElement;r.classList.remove(\"dragging\");const o=Number(r.getAttribute(\"data-index\")),a=Math.max(0,(null!==r.getAttribute(\"data-after-index\")?Number(r.getAttribute(\"data-after-index\")):e.length)-1);e.forEach((t=>t.classList.remove(\"indicator-before\",\"indicator-after\"))),o!==a&&this.moveItem(o,a)}_onDragOver(t){const e=this.shadowRoot.querySelector(\".dragging\");if(!e)return;t.preventDefault();const r=[...this.shadowRoot.querySelectorAll(\".item-wrapper:not(.dragging)\")],o={offset:Number.NEGATIVE_INFINITY,element:null},a=r.reduce(((e,r)=>{const o=r.getBoundingClientRect(),a=t.clientY-o.top-o.height/2;return a<0&&a>e.offset?{offset:a,element:r}:e}),o).element;if(r.forEach((t=>t.classList.remove(\"indicator-before\",\"indicator-after\"))),null===a)r[r.length-1].classList.add(\"indicator-after\"),e.removeAttribute(\"data-after-index\");else{a.classList.add(\"indicator-before\");const t=a.getAttribute(\"data-index\");e.setAttribute(\"data-after-index\",t)}}_showJson(t){t.stopPropagation(),showJsonEditor(this.title||this.schema.title||\"\",this.data,(t=>{this.handleChange(this.path||\"\",t)}))}doAddItem(){this.resolvedSchema&&(this.itemInfos?this.showAddDialog():this.addItem(createDefaultValue(this.resolvedSchema)))}showAddDialog(){let t;const e=this.itemInfos.map(((t,e)=>{const r=t.title?computeLabel(t.title,!1,!0):\"\";return{text:r,value:r,data:t}})),r=showDialog((new OrMwcDialog).setContent(html`\n                <div class=\"col\">\n                    <form id=\"mdc-dialog-form-add\" class=\"row\">\n                        <div id=\"type-list\" class=\"col\">\n                            <or-mwc-list @or-mwc-list-changed=\"${e=>{var o;1===e.detail.length&&(o=e.detail[0].data,t=o,r.shadowRoot.getElementById(\"parameter-desc\").innerHTML=o.description||\"\",r.shadowRoot.getElementById(\"add-btn\").disabled=!1)}}\" .listItems=\"${e.sort(((t,e)=>t.text.localeCompare(e.text)))}\" id=\"parameter-list\"></or-mwc-list>\n                        </div>\n                        <div id=\"parameter-desc\" class=\"col\"></div>\n                    </form>\n                </div>\n            `).setStyles(addItemOrParameterDialogStyle).setHeading((this.label?computeLabel(this.label,this.required,!1)+\" - \":\"\")+i18next.t(\"addItem\")).setActions([{actionName:\"cancel\",content:\"cancel\"},{default:!0,actionName:\"add\",action:()=>{if(t){const e=t.defaultValueCreator();this.addItem(e)}},content:html`<or-mwc-input id=\"add-btn\" .type=\"${InputType.BUTTON}\" disabled label=\"add\"></or-mwc-input>`}]).setDismissAction(null))}};__decorate([property()],ControlArrayElement.prototype,\"minimal\",void 0),ControlArrayElement=__decorate([customElement(\"or-json-forms-array-control\")],ControlArrayElement);export{ControlArrayElement};","import{and,createCombinatorRenderInfos,findUISchema,hasType,isAllOfControl,isAnyOfControl,isBooleanControl,isDateControl,isDateTimeControl,isEnumControl,isIntegerControl,isNumberControl,isObjectControl,isOneOfControl,isOneOfEnumControl,isStringControl,isTimeControl,mapDispatchToControlProps,mapStateToControlProps,mapStateToControlWithDetailProps,mapStateToLayoutProps,or,rankWith,resolveSubSchemas,schemaMatches,schemaSubPathMatches,uiTypeIs}from\"@jsonforms/core\";import{html}from\"lit\";import\"@openremote/or-mwc-components/or-mwc-input\";import{getCombinatorInfos,getLabel,getSchemaConst,getSchemaPicker,getTemplateFromProps,mapStateToCombinatorRendererProps,showJsonEditor}from\"./util\";import\"./layouts/layout-vertical-element\";import\"./controls/control-input-element\";import\"./controls/control-array-element\";import{InputType}from\"@openremote/or-mwc-components/or-mwc-input\";import{Util}from\"@openremote/core\";const hasOneOfItems=e=>void 0!==e.oneOf&&e.oneOf.length>0&&e.oneOf.every((e=>void 0!==getSchemaConst(e))),hasEnumItems=e=>Array.isArray(e.enum);export const isEnumArray=and(uiTypeIs(\"Control\"),and(schemaMatches((e=>hasType(e,\"array\")&&!Array.isArray(e.items)&&!0===e.uniqueItems)),schemaSubPathMatches(\"items\",(e=>hasOneOfItems(e)||hasEnumItems(e)))));export const verticalOrGroupLayoutTester=rankWith(1,or(uiTypeIs(\"VerticalLayout\"),uiTypeIs(\"Group\")));export const verticalLayoutRenderer=(e,r)=>{const t=Object.assign(Object.assign(Object.assign({},mapStateToLayoutProps({jsonforms:Object.assign({},e)},r)),mapDispatchToControlProps(e.dispatch)),{label:r.label,required:r.required,errors:r.errors,minimal:r.minimal,type:r.type}),o=html`<or-json-forms-vertical-layout .state=\"${e}\" .props=\"${t}\"></or-json-forms-vertical-layout>`;let n;return!t.required&&t.path&&(n=()=>{t.handleChange(t.path||\"\",void 0)}),getTemplateWrapper(o,n)};export const constTester=rankWith(6,schemaMatches((e=>void 0!==getSchemaConst(e))));export const constRenderer=(e,r)=>{};export const inputControlTester=rankWith(3,or(schemaMatches((e=>Array.isArray(e.type)&&7===e.type.length)),isStringControl,isBooleanControl,isNumberControl,isIntegerControl,isDateControl,isTimeControl,isDateTimeControl,isEnumControl,isOneOfEnumControl,isEnumArray));export const inputControlRenderer=(e,r)=>{const t=Object.assign(Object.assign({},mapStateToControlProps({jsonforms:Object.assign({},e)},r)),mapDispatchToControlProps(e.dispatch));t.label=r.label||t.label,t.required=!!r.required||t.required;const o=html`<or-json-forms-input-control .state=\"${e}\" .props=\"${t}\"></or-json-forms-input-control>`;let n;return!t.required&&t.path&&(n=()=>{t.handleChange(t.path,void 0)}),getTemplateWrapper(o,n)};export const objectControlTester=rankWith(2,isObjectControl);export const objectControlRenderer=(e,r)=>{const{required:t,renderers:o,cells:n,uischemas:a,schema:s,label:i,errors:l,path:c,visible:m,enabled:p,uischema:h,rootSchema:u}=mapStateToControlWithDetailProps({jsonforms:Object.assign({},e)},r),d={visible:m,enabled:p,schema:s,uischema:findUISchema(a,s,h.scope,c,\"VerticalLayout\",h,u),path:c,renderers:o,cells:n,label:r.label||getLabel(s,u,i)||\"\",required:!!r.required||!!t,errors:l,minimal:r.minimal};return getTemplateFromProps(e,d)};export const anyOfOneOfControlTester=rankWith(4,or(isAnyOfControl,isOneOfControl));export const anyOfOneOfControlRenderer=(e,r)=>{const t={jsonforms:Object.assign({},e)},{required:o,renderers:n,cells:a,schema:s,label:i,path:l,errors:c,visible:m,enabled:p,uischema:h,rootSchema:u,data:d}=mapStateToControlWithDetailProps(t,r),C=void 0!==s.anyOf?\"anyOf\":\"oneOf\",f=resolveSubSchemas(s,u,C),b=mapStateToCombinatorRendererProps(t,r,C),O=createCombinatorRenderInfos(f[C],u,C,b.uischema||h,l,b.uischemas);if(null!=d&&(void 0===b.indexOfFittingSchema||b.indexOfFittingSchema<0)){const e=getCombinatorInfos(f[C],u),r=e.length>0?e[0].constProperty:void 0;if(r&&\"object\"==typeof d&&d[r]){const t=d[r];b.indexOfFittingSchema=e.findIndex((e=>e.constValue===t))}}if(void 0===b.indexOfFittingSchema||b.indexOfFittingSchema<0){const{handleChange:t}=mapDispatchToControlProps(e.dispatch);if(null!=d){console.warn(\"Cannot match \"+C+\" schema to instance data\");const e=e=>{e.stopPropagation(),showJsonEditor(i,d,(e=>{t(l||\"\",e)}))};return html`\n                <div class=\"item-container no-match-container\"><span>${i}:</span><b><or-translate value=\"validation.noSchemaMatchFound\"></b><or-mwc-input .type=\"${InputType.BUTTON}\" outlined label=\"json\" icon=\"pencil\" @or-mwc-input-changed=\"${r=>e(r)}\"></or-mwc-input></div>\n            `}return getSchemaPicker(u,f,l,C,r.label||i,(e=>t(l,e.defaultValueCreator())))}const y=O[b.indexOfFittingSchema].schema;let T=O[b.indexOfFittingSchema].uischema;y.allOf&&(T={type:\"Control\",scope:\"#\",label:!1});const g={schema:y,uischema:T,path:l,renderers:n,cells:a,label:r.label||getLabel(y,u,i)||\"\",required:r.required||!!o,errors:c,minimal:r.minimal,type:y.title};return getTemplateFromProps(e,g)};export const allOfControlTester=rankWith(4,isAllOfControl);export const allOfControlRenderer=(e,r)=>{const t={jsonforms:Object.assign({},e)},o=Object.assign({},mapStateToControlWithDetailProps(t,r)),n=resolveSubSchemas(o.schema,o.rootSchema,\"allOf\");return o.schema=n.allOf.reduce(((e,r)=>Util.mergeObjects(e,r,!1))),o.uischema.scope=\"#\",o.label=r.label||o.label,o.required=!!r.required||o.required,o.minimal=r.minimal,getTemplateFromProps(e,o)};export const arrayControlTester=rankWith(2,schemaMatches((e=>hasType(e,\"array\")&&!Array.isArray(e.items))));export const arrayControlRenderer=(e,r)=>{const t=Object.assign(Object.assign({},mapStateToControlProps({jsonforms:Object.assign({},e)},r)),mapDispatchToControlProps(e.dispatch));t.label=r.label||t.label,t.required=!!r.required||t.required,t.minimal=r.minimal;const o=html`<or-json-forms-array-control .state=\"${e}\" .props=\"${t}\"></or-json-forms-array-control>`;let n;return!t.required&&t.path&&(n=()=>{t.handleChange(t.path,void 0)}),getTemplateWrapper(o,n)};export function getTemplateWrapper(e,r){const t=r?html`\n                <button class=\"button-clear\" @click=\"${r}\"><or-icon icon=\"close-circle\"></or-icon></input>\n            `:\"\";return html`\n                <div class=\"item-container\">\n                    ${e}\n                    <div class=\"delete-container\">\n                        ${t}\n                    </div>\n                </div>\n            `}export function unknownTemplate(){return html`<span>No applicable renderer found!</span>`}export const StandardRenderers=[{tester:verticalOrGroupLayoutTester,renderer:verticalLayoutRenderer},{tester:constTester,renderer:constRenderer},{tester:inputControlTester,renderer:inputControlRenderer},{tester:objectControlTester,renderer:objectControlRenderer},{tester:arrayControlTester,renderer:arrayControlRenderer},{tester:anyOfOneOfControlTester,renderer:anyOfOneOfControlRenderer},{tester:allOfControlTester,renderer:allOfControlRenderer}];","var __decorate=this&&this.__decorate||function(e,t,r,o){var s,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(s=e[c])&&(i=(a<3?s(i):a>3?s(t,r,i):s(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i};import{css,html,LitElement}from\"lit\";import{customElement,property,state}from\"lit/decorators.js\";import{Actions,configReducer,coreReducer,createAjv,generateDefaultUISchema,generateJsonSchema,mapStateToJsonFormsRendererProps,setConfig}from\"@jsonforms/core\";import{getTemplateWrapper,StandardRenderers}from\"./standard-renderers\";import{getLabel,getTemplateFromProps}from\"./util\";import{baseStyle}from\"./styles\";import{Util}from\"@openremote/core\";export{StandardRenderers,getTemplateWrapper};const styles=css`\n    .delete-container {\n        width: 0;\n    }\n\n    .item-container {\n        margin: 0; /* Remove inherited margin */\n    }\n`;let OrJSONForms=class extends LitElement{constructor(){super(...arguments),this.renderers=StandardRenderers,this.readonly=!1,this.required=!1,this.previousErrors=[]}static get styles(){return[baseStyle,styles]}checkValidity(){return 0===this.previousErrors.length}shouldUpdate(e){if(super.shouldUpdate(e),this.schema||(this.schema=void 0!==this.data?generateJsonSchema(this.data):{}),this.uischema||(this.uischema=generateDefaultUISchema(this.schema)),this.core||(this.core={ajv:createAjv({useDefaults:!0,validateFormats:!1}),data:{},schema:this.schema,uischema:this.uischema},this.updateCore(Actions.init(this.data,this.schema,this.uischema)),this.config=configReducer(void 0,setConfig(this.config))),(e.has(\"data\")||e.has(\"schema\")||e.has(\"uischema\"))&&this.updateCore(Actions.updateCore(this.data,this.schema,this.uischema)),(!this.contextValue||e.has(\"core\")||e.has(\"renderers\")||e.has(\"cells\")||e.has(\"config\")||e.has(\"readonly\"))&&(this.contextValue={core:this.core,renderers:this.renderers,cells:this.cells,config:this.config,uischemas:this.uischemas,readonly:this.readonly,dispatch:e=>this.updateCore(e)}),e.has(\"core\")){const e=this.core.data,t=this.core.errors;this.onChange&&(!Util.objectsEqual(e,this.previousData,!0)||t&&!Util.objectsEqual(t,this.previousErrors,!0))&&(this.previousErrors=t||[],this.previousData=e,this.onChange({data:e,errors:t}))}return!0}updateCore(e){const t=coreReducer(this.core,e);return t!==this.core&&(this.core=t),e}render(){if(!this.contextValue)return html``;const e=Object.assign(Object.assign({},mapStateToJsonFormsRendererProps({jsonforms:Object.assign({},this.contextValue)},this)),{label:getLabel(this.schema,this.uischema,this.label,void 0)||\"\",required:this.required});return getTemplateFromProps(this.contextValue,e)||html``}};__decorate([property({type:Object})],OrJSONForms.prototype,\"uischema\",void 0),__decorate([property({type:Object})],OrJSONForms.prototype,\"schema\",void 0),__decorate([property({type:Object,attribute:!1})],OrJSONForms.prototype,\"data\",void 0),__decorate([property({type:Array})],OrJSONForms.prototype,\"renderers\",void 0),__decorate([property({type:Array})],OrJSONForms.prototype,\"cells\",void 0),__decorate([property({type:String,attribute:!1})],OrJSONForms.prototype,\"onChange\",void 0),__decorate([property({type:String,attribute:!1})],OrJSONForms.prototype,\"config\",void 0),__decorate([property({type:Array})],OrJSONForms.prototype,\"uischemas\",void 0),__decorate([property({type:Boolean})],OrJSONForms.prototype,\"readonly\",void 0),__decorate([property({type:String})],OrJSONForms.prototype,\"label\",void 0),__decorate([property({type:Boolean})],OrJSONForms.prototype,\"required\",void 0),__decorate([state()],OrJSONForms.prototype,\"core\",void 0),__decorate([state()],OrJSONForms.prototype,\"contextValue\",void 0),OrJSONForms=__decorate([customElement(\"or-json-forms\")],OrJSONForms);export{OrJSONForms};","import{css,unsafeCSS}from\"lit\";import{DefaultColor1,DefaultColor2,DefaultColor3,DefaultColor4,DefaultColor5,DefaultHeaderHeight}from\"@openremote/core\";export const markerColorVar=\"--internal-or-map-marker-color\";export const markerActiveColorVar=\"--internal-or-map-marker-active-color\";export const style=css`\n    :host {\n        --internal-or-map-width: var(--or-map-width, 100%);\n        --internal-or-map-min-height: var(--or-map-min-height, 300px);\n        --internal-or-map-marker-transform: var(--or-map-marker-transform, translate(-16px, -29px));\n        --internal-or-map-marker-width: var(--or-map-marker-width, 32px);\n        --internal-or-map-marker-height: var(--or-map-marker-height, 32px);\n        --internal-or-map-marker-color: var(--or-map-marker-color, var(--or-app-color4, ${unsafeCSS(DefaultColor4)}));\n        --internal-or-map-marker-stroke: var(--or-map-marker-stroke, none);\n        --internal-or-map-marker-icon-color: var(--or-map-marker-icon-color, var(--or-app-color1, ${unsafeCSS(DefaultColor1)}));\n        --internal-or-map-marker-icon-stroke: var(--or-map-marker-icon-stroke, none);\n        --internal-or-map-marker-icon-width: var(--or-map-marker-icon-width, 16px);\n        --internal-or-map-marker-icon-height: var(--or-map-marker-icon-height, 16px);\n        --internal-or-map-marker-icon-transform: var(--or-map-marker-icon-transform, translate(-50%, -14px));\n        --internal-or-map-marker-active-transform: var(--or-map-marker-active-transform, translate(-24px, -44px));\n        --internal-or-map-marker-active-width: var(--or-map-marker-active-width, 48px);\n        --internal-or-map-marker-active-height: var(--or-map-marker-active-height, 48px);\n        --internal-or-map-marker-active-color: var(--or-map-marker-active-color, var(--or-app-color4, ${unsafeCSS(DefaultColor4)}));\n        --internal-or-map-marker-active-stroke: var(--or-map-marker-active-stroke, 2px);\n        --internal-or-map-marker-icon-active-color: var(--or-map-marker-icon-active-color, var(--or-app-color1, ${unsafeCSS(DefaultColor1)}));\n        --internal-or-map-marker-icon-active-stroke: var(--or-map-marker-icon-active-stroke, none);\n        --internal-or-map-marker-icon-active-width: var(--or-map-marker-icon-active-width, 24px);\n        --internal-or-map-marker-icon-active-height: var(--or-map-marker-icon-active-height, 24px);\n        --internal-or-map-marker-icon-active-transform: var(--or-map-marker-icon-active-transform, translate(-50%, -20px));\n        display: block;\n        overflow: hidden;\n        \n        min-height: var(--internal-or-map-min-height);\n        width: var(--internal-or-map-width);\n    }\n    \n    canvas {\n        outline: none !important;\n    }\n\n    :host([hidden]) {\n        display: none;\n    }\n\n    slot {\n        display: none;\n    }\n          \n    #container {\n        position: relative;\n        width: 100%;\n        height: 100%;    \n    }\n    \n    #map {\n        position: absolute;\n        left: 0;\n        right: 0;\n        top: 0;\n        bottom: 0;\n    }\n    .mapboxgl-ctrl-geocoder,\n    .maplibregl-ctrl-geocoder--input {\n        width: calc(100% - 20px)\n    }\n    .leaflet-marker-icon, .maplibregl-marker, .mapboxgl-marker {\n        pointer-events: none !important;\n    }\n\n    .or-map-marker {\n        position: absolute; /* This makes mapboxJS behave like mapboxGL */\n    }\n    \n    .or-map-marker.active {\n        z-index: 1;\n    }\n    \n    .marker-container {\n        position: relative;\n        cursor: pointer;\n        transform: var(--internal-or-map-marker-transform);\n        --or-icon-fill: var(--internal-or-map-marker-color);\n        --or-icon-width: var(--internal-or-map-marker-width);\n        --or-icon-height: var(--internal-or-map-marker-height);\n        --or-icon-stroke: var(--internal-or-map-marker-stroke);\n    }\n\n    .or-map-marker.active .marker-container {\n        transform: var(--internal-or-map-marker-active-transform);\n        --or-icon-fill: var(--internal-or-map-marker-active-color);\n        --or-icon-width: var(--internal-or-map-marker-active-width);\n        --or-icon-height: var(--internal-or-map-marker-active-height);\n        --or-icon-stroke: var(--internal-or-map-marker-active-stroke);\n    }\n\n    .or-map-marker.interactive .marker-container {\n        pointer-events: all;\n    }\n\n    .or-map-marker-default.interactive .marker-container {\n        pointer-events: none;\n        --or-icon-pointer-events: visible;\n    }\n\n    .or-map-marker .marker-icon {\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        z-index: 1000;\n        --or-icon-fill: var(--internal-or-map-marker-icon-color);\n        --or-icon-stroke: var(--internal-or-map-marker-icon-stroke);\n        --or-icon-width: var(--internal-or-map-marker-icon-width);\n        --or-icon-height: var(--internal-or-map-marker-icon-height);\n        transform: var(--internal-or-map-marker-icon-transform);\n    }\n    \n    .or-map-marker.active .marker-icon {\n        transform: var(--internal-or-map-marker-icon-active-transform);\n        --or-icon-fill: var(--internal-or-map-marker-icon-active-color);\n        --or-icon-stroke: var(--internal-or-map-marker-icon-active-stroke);\n        --or-icon-width: var(--internal-or-map-marker-icon-active-width);\n        --or-icon-height: var(--internal-or-map-marker-icon-active-height);\n    }\n    \n    #openremote {\n        position: absolute;\n        bottom: 25px;\n        right: 5px;\n        height: 20px;\n        width: 20px;\n        cursor: pointer;\n    }\n    \n    #openremote img {\n        height: 20px;\n        width: 20px;\n    }\n    \n    @media only screen and (max-width: 640px) {\n        #openremote {\n            bottom: 40px;\n            right: 12px;\n        }\n    }\n`;export const mapAssetCardStyle=css`\n            :host {\n                --internal-or-map-asset-card-header-color: var(--or-map-asset-card-header-color, var(--or-app-color4, ${unsafeCSS(DefaultColor4)}));\n                --internal-or-map-asset-card-header-text-color: var(--or-map-asset-card-header-text-color, var(--or-app-color1, ${unsafeCSS(DefaultColor1)}));\n                --internal-or-map-asset-card-header-height: var(--or-map-asset-card-header-height, calc(${unsafeCSS(DefaultHeaderHeight)} - 10px));\n                --internal-or-map-asset-card-background-color: var(--or-map-asset-card-background-color, var(--or-app-color1, ${unsafeCSS(DefaultColor1)}));\n                --internal-or-map-asset-card-background-text-color: var(--or-map-asset-card-background-text-color, var(--or-app-color3, ${unsafeCSS(DefaultColor3)}));\n                --internal-or-map-asset-card-separator-color: var(--or-map-asset-card-separator-color, var(--or-app-color2, ${unsafeCSS(DefaultColor2)}));\n                \n                display: block;\n            }\n\n            #card-container {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                background-color: var(--internal-or-map-asset-card-background-color);\n                -webkit-box-shadow: 1px 1px 2px 0px rgba(0,0,0,0.28);\n                -moz-box-shadow: 1px 1px 2px 0px rgba(0,0,0,0.28);\n                box-shadow: 1px 1px 2px 0px rgba(0,0,0,0.28);  \n            }\n            \n            #header {\n                height: var(--internal-or-map-asset-card-header-height);\n                background-color: var(--internal-or-map-asset-card-header-color);\n                line-height: var(--internal-or-map-asset-card-header-height);\n                border-bottom: 1px solid ${unsafeCSS(DefaultColor5)};\n                text-align: center;\n                color: var(--internal-or-map-asset-card-header-text-color);\n                --or-icon-fill: var(--internal-or-map-asset-card-header-text-color);\n                --or-icon-width: 20px;\n                --or-icon-height: 20px;\n                z-index: 99999;\n            }\n\n            #header > or-icon {\n                margin-right: 5px;\n            }\n            \n            #title {\n                font-weight: 500;\n            }\n            \n            #attribute-list {\n                flex: 1;                \n                color: var(--internal-or-map-asset-card-background-text-color);\n                padding: 10px 20px;\n                overflow: auto;\n                font-size: 14px;\n            }\n            \n            ul {\n                list-style-type: none;\n                margin: 0;\n                padding: 0;\n            }\n            \n            li {\n                display: flex;\n                line-height: 30px;\n            }\n            li.highlighted {\n                font-weight: bold;\n            }\n            \n            .attribute-name {\n                flex: 1;            \n            }\n            \n            .attribute-value {\n                overflow: hidden;\n                padding-left: 20px;\n                text-align: right;\n            }\n            \n            #footer {\n                height: var(--internal-or-map-asset-card-header-height);\n                border-top: 1px solid var(--internal-or-map-asset-card-separator-color);\n                text-align: right;\n                padding: 5px 12px;\n            }\n            \n            @media only screen and (min-width: 415px){\n                #card-container {\n                    height: 400px; /* fallback for IE */\n                    height: max-content;\n                    max-height: calc(100vh - 150px);\n                    min-height: 134px;\n                }\n            }\n`;","var OrMapMarker_1,__decorate=this&&this.__decorate||function(e,t,r,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,a);else for(var n=e.length-1;n>=0;n--)(o=e[n])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};import{css,html,LitElement,unsafeCSS}from\"lit\";import{customElement,property,query}from\"lit/decorators.js\";import{markerActiveColorVar,markerColorVar}from\"../style\";import{DefaultBoxShadow}from\"@openremote/core\";export class OrMapMarkerChangedEvent extends CustomEvent{constructor(e,t){super(OrMapMarkerChangedEvent.NAME,{detail:{marker:e,property:t},bubbles:!0,composed:!0})}}OrMapMarkerChangedEvent.NAME=\"or-map-marker-changed\";export class OrMapMarkerClickedEvent extends CustomEvent{constructor(e){super(OrMapMarkerClickedEvent.NAME,{detail:{marker:e},bubbles:!0,composed:!0})}}OrMapMarkerClickedEvent.NAME=\"or-map-marker-clicked\";let OrMapMarker=OrMapMarker_1=class extends LitElement{constructor(){super(...arguments),this.visible=!0,this.interactive=!0,this.active=!1}static get styles(){return css`\n          .label {\n            background-color: white;\n            width: auto;\n            height: 20px;\n            position: absolute;\n            top: -14px;\n            left: 50%;\n            padding: 0 3px;\n            transform: translate(-50%, -50%);\n            text-align: center;\n            border-radius: 3px;\n            -webkit-box-shadow: ${unsafeCSS(DefaultBoxShadow)};\n            -moz-box-shadow: ${unsafeCSS(DefaultBoxShadow)};\n            box-shadow: ${unsafeCSS(DefaultBoxShadow)};\n          }\n          .label > span {\n            white-space: nowrap;\n          }\n          \n          .direction-icon-wrapper {\n            position: absolute;\n            top: 11px;\n            left: 16px;\n          }\n          .direction-circle {\n            position: absolute;\n            margin-top: -15px;\n            margin-left: -15px;\n            width: 30px;\n            height: 30px;\n          }\n          .direction-circle circle {\n            cx: 15px;\n            cy: 15px;\n            r: 12px;\n            stroke: white;\n            stroke-width: 3px;\n            fill: transparent;\n          }\n          .direction-icon {\n            position: absolute;\n            top: -25px;\n            left: -16px;\n            transform: scale(0.75) rotate(-90deg);\n          }\n          \n          .active .direction-icon-wrapper {\n            top: 17px;\n            left: 24px;\n          }\n          .active .direction-circle {\n            margin-top: -20px;\n            margin-left: -20px;\n            width: 40px;\n            height: 40px;\n          }\n          .active .direction-icon {\n            top: -36px;\n            left: -23px;\n          }\n          .active .direction-circle circle {\n            cx: 20px;\n            cy: 20px;\n            r: 18px;\n            stroke-width: 4px;\n          }\n        `}get markerContainer(){if(this._actualMarkerElement)return this._actualMarkerElement.firstElementChild}_onClick(e){this.dispatchEvent(new OrMapMarkerClickedEvent(this))}_createMarkerElement(){const e=document.createElement(\"div\"),t=document.createElement(\"div\");e.appendChild(t),this.addMarkerClassNames(e),this.addMarkerContainerClassNames(t);let r=this.createMarkerContent();return r||(e.classList.add(\"or-map-marker-default\"),r=this.createDefaultMarkerContent()),t.appendChild(r),this.updateInteractive(e),this.updateVisibility(e),this.updateColor(t),this.updateActive(e),e}createMarkerContent(){let e=!1,t=document.createElement(\"div\");if(this._slot&&this._slot.assignedNodes({flatten:!0}).forEach((r=>{r instanceof HTMLElement&&(t.appendChild(r.cloneNode(!0)),e=!0)})),e)return t}shouldUpdate(e){return(e.has(\"icon\")||e.has(\"displayValue\")||e.has(\"direction\"))&&this.refreshMarkerContent(),(e.has(\"color\")||e.has(\"activeColor\"))&&this.updateColor(this.markerContainer),e.has(\"visible\")&&this.updateVisibility(this._actualMarkerElement),e.has(\"interactive\")&&this.updateInteractive(this._actualMarkerElement),e.has(\"active\")&&(this.updateActive(this._actualMarkerElement),this.updateColor(this.markerContainer)),e.forEach(((e,t)=>this._raisePropertyChange(t))),!1}updateVisibility(e){e&&(this.visible?e.removeAttribute(\"hidden\"):e.setAttribute(\"hidden\",\"true\"))}getColor(){return this.color&&\"unset\"!==this.color?this.color:void 0}getActiveColor(){return this.activeColor&&\"unset\"!==this.activeColor?this.activeColor:void 0}updateColor(e){if(e){e.style.removeProperty(markerColorVar),e.style.removeProperty(markerActiveColorVar);const t=this.getColor(),r=this.getActiveColor();t&&e.style.setProperty(markerColorVar,t),r&&e.style.setProperty(markerActiveColorVar,r)}}updateActive(e){e&&(this.active?e.classList.add(\"active\"):e.classList.remove(\"active\"))}updateInteractive(e){e&&(this.interactive?e.classList.add(\"interactive\"):e.classList.remove(\"interactive\"))}refreshMarkerContent(){if(this.markerContainer){let e=this.createMarkerContent();e?this._actualMarkerElement.classList.remove(\"or-map-marker-default\"):(this._actualMarkerElement.classList.add(\"or-map-marker-default\"),e=this.createDefaultMarkerContent()),this.markerContainer.children.length>0&&this.markerContainer.removeChild(this.markerContainer.children[0]),this.markerContainer.appendChild(e)}}render(){return html`\n          <slot></slot>\n        `}_raisePropertyChange(e){this.dispatchEvent(new OrMapMarkerChangedEvent(this,e))}addMarkerClassNames(e){e.classList.add(\"or-map-marker\")}addMarkerContainerClassNames(e){e.classList.add(\"marker-container\")}createDefaultMarkerContent(){const e=document.createElement(\"div\");return e.innerHTML=OrMapMarker_1._defaultTemplate(this.icon,{displayValue:this.displayValue,direction:this.direction}),e}hasPosition(){return\"number\"==typeof this.lat&&\"number\"==typeof this.lng&&this.lat>=-90&&this.lat<90&&this.lng>=-180&&this.lng<180}};OrMapMarker._defaultTemplate=(e,t)=>`\\n        ${t&&void 0!==t.displayValue?`<div class=\"label\"><span>${t.displayValue}</span></div>`:\"\"}\\n        ${t&&t.direction?`<div class=\"direction-icon-wrapper\" style=\"transform: rotate(${t.direction}deg);\">\\n                <svg class=\"direction-circle\">\\n                 <circle/> \\n                </svg>\\n                <or-icon class=\"direction-icon\" icon=\"play\"></or-icon>\\n               </div>`:\"\"}\\n        <or-icon icon=\"or:marker\"></or-icon>\\n        <or-icon class=\"marker-icon\" icon=\"${e||\"\"}\"></or-icon>\\n    `,__decorate([property({type:Number,reflect:!0,attribute:!0})],OrMapMarker.prototype,\"lat\",void 0),__decorate([property({type:Number,reflect:!0})],OrMapMarker.prototype,\"lng\",void 0),__decorate([property({type:Number,reflect:!0})],OrMapMarker.prototype,\"radius\",void 0),__decorate([property({reflect:!0})],OrMapMarker.prototype,\"displayValue\",void 0),__decorate([property({reflect:!0})],OrMapMarker.prototype,\"direction\",void 0),__decorate([property({type:Boolean})],OrMapMarker.prototype,\"visible\",void 0),__decorate([property({type:String})],OrMapMarker.prototype,\"icon\",void 0),__decorate([property({type:String})],OrMapMarker.prototype,\"color\",void 0),__decorate([property({type:String})],OrMapMarker.prototype,\"activeColor\",void 0),__decorate([property({type:Boolean})],OrMapMarker.prototype,\"interactive\",void 0),__decorate([property({type:Boolean})],OrMapMarker.prototype,\"active\",void 0),__decorate([query(\"slot\")],OrMapMarker.prototype,\"_slot\",void 0),OrMapMarker=OrMapMarker_1=__decorate([customElement(\"or-map-marker\")],OrMapMarker);export{OrMapMarker};","var __decorate=this&&this.__decorate||function(t,e,s,r){var a,o=arguments.length,i=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,s):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(t,e,s,r);else for(var n=t.length-1;n>=0;n--)(a=t[n])&&(i=(o<3?a(i):o>3?a(e,s,i):a(e,s))||i);return o>3&&i&&Object.defineProperty(e,s,i),i};import{html,LitElement}from\"lit\";import{customElement,property}from\"lit/decorators.js\";import{classMap}from\"lit-html/directives/class-map.js\";import{AssetModelUtil}from\"@openremote/model\";import manager,{subscribe,Util}from\"@openremote/core\";import\"@openremote/or-icon\";import{mapAssetCardStyle}from\"./style\";import{InputType}from\"@openremote/or-mwc-components/or-mwc-input\";import{getMarkerIconAndColorFromAssetType}from\"./util\";import{getMarkerConfigAttributeName}from\"./markers/or-map-marker-asset\";export class OrMapAssetCardLoadAssetEvent extends CustomEvent{constructor(t){super(OrMapAssetCardLoadAssetEvent.NAME,{bubbles:!0,composed:!0,detail:t})}}OrMapAssetCardLoadAssetEvent.NAME=\"or-map-asset-card-load-asset\";export const DefaultConfig={default:{exclude:[\"notes\"]},assetTypes:{}};let OrMapAssetCard=class extends(subscribe(manager)(LitElement)){constructor(){super(...arguments),this.useAssetColor=!0}static get styles(){return mapAssetCardStyle}shouldUpdate(t){return(!t.has(\"assetId\")||(this.title=\"\",this.assetIds=this.assetId&&this.assetId.length>0?[this.assetId]:void 0,1!==t.size))&&super.shouldUpdate(t)}_onEvent(t){if(\"asset\"===t.eventType){const e=t;switch(e.cause){case\"READ\":case\"CREATE\":case\"UPDATE\":this.asset=e.asset;break;case\"DELETE\":this.asset=void 0}}\"attribute\"===t.eventType&&this.asset&&(this.asset=Util.updateAsset(this.asset,t),this.requestUpdate())}getCardConfig(){let t=this.config||DefaultConfig;return this.asset&&t.assetTypes&&t.assetTypes.hasOwnProperty(this.asset.type)?t.assetTypes[this.asset.type]:t.default}render(){if(!this.asset)return html``;const t=this.getIcon(),e=this.getColor(),s=e?\"--internal-or-map-asset-card-header-color: #\"+e+\";\":\"\",r=this.getCardConfig(),a=Object.values(this.asset.attributes).filter((t=>\"location\"!==t.name)),o=r&&r.include?r.include:void 0,i=r&&r.exclude?r.exclude:[],n=a.filter((t=>!(o&&!(o.indexOf(t.name)>=0)||i&&!(i.indexOf(t.name)<0)||t.meta&&t.meta.hasOwnProperty(\"showOnDashboard\")&&!Util.getMetaValue(\"showOnDashboard\",t)))).sort(Util.sortByString((t=>t.name))),p=getMarkerConfigAttributeName(this.markerconfig,this.asset.type);return html`\n            <div id=\"card-container\" style=\"${s}\">\n                <div id=\"header\">\n                    ${t?html`<or-icon icon=\"${t}\"></or-icon>`:\"\"}\n                    <span id=\"title\">${this.asset.name}</span>\n                </div>\n                <div id=\"attribute-list\">\n                    <ul>\n                        ${n.map((t=>{if(!this.asset||!this.asset.type)return;const e=AssetModelUtil.getAttributeAndValueDescriptors(this.asset.type,t.name,t);if(e&&e.length){const s=Util.getAttributeLabel(t,e[0],this.asset.type,!0),r=Util.getAttributeValueAsString(t,e[0],this.asset.type,!1,\"-\"),a={highlighted:p===t.name};return html`<li class=\"${classMap(a)}\"><span class=\"attribute-name\">${s}</span><span class=\"attribute-value\">${r}</span></li>`}}))}\n                    </ul>\n                </div>\n                ${r&&r.hideViewAsset?html``:html`\n                    <div id=\"footer\">\n                        <or-mwc-input .type=\"${InputType.BUTTON}\" label=\"viewAsset\" @or-mwc-input-changed=\"${t=>{t.preventDefault(),this._loadAsset(this.asset.id)}}\"></or-mwc-input>\n                    </div>\n                `}\n            </div>\n        `}_loadAsset(t){this.dispatchEvent(new OrMapAssetCardLoadAssetEvent(t))}getIcon(){var t;if(this.asset){const e=AssetModelUtil.getAssetDescriptor(this.asset.type);return(null===(t=getMarkerIconAndColorFromAssetType(e))||void 0===t?void 0:t.icon)||void 0}}getColor(){var t;if(this.asset){const e=AssetModelUtil.getAssetDescriptor(this.asset.type),s=null===(t=getMarkerIconAndColorFromAssetType(e))||void 0===t?void 0:t.color;if(s)return\"string\"==typeof s?s:s[0].colour}}};__decorate([property({type:String,reflect:!0,attribute:!0})],OrMapAssetCard.prototype,\"assetId\",void 0),__decorate([property({type:Object,attribute:!0})],OrMapAssetCard.prototype,\"asset\",void 0),__decorate([property({type:Object})],OrMapAssetCard.prototype,\"config\",void 0),__decorate([property({type:Object})],OrMapAssetCard.prototype,\"markerconfig\",void 0),__decorate([property({type:Boolean,attribute:!0})],OrMapAssetCard.prototype,\"useAssetColor\",void 0),OrMapAssetCard=__decorate([customElement(\"or-map-asset-card\")],OrMapAssetCard);export{OrMapAssetCard};","var __decorate=this&&this.__decorate||function(e,t,o,r){var a,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var i=e.length-1;i>=0;i--)(a=e[i])&&(s=(n<3?a(s):n>3?a(t,o,s):a(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};import manager from\"@openremote/core\";import{FlattenedNodesObserver}from\"@polymer/polymer/lib/utils/flattened-nodes-observer.js\";import{html,LitElement}from\"lit\";import{customElement,property,query}from\"lit/decorators.js\";import{LngLat,GeolocateControl}from\"maplibre-gl\";import{MapWidget}from\"./mapwidget\";import{style}from\"./style\";import\"./markers/or-map-marker\";import\"./markers/or-map-marker-asset\";import{OrMapMarker,OrMapMarkerChangedEvent}from\"./markers/or-map-marker\";import*as Util from\"./util\";import{InputType,OrMwcInput}from\"@openremote/or-mwc-components/or-mwc-input\";import{OrMwcDialog,showDialog}from\"@openremote/or-mwc-components/or-mwc-dialog\";import{getMarkerIconAndColorFromAssetType}from\"./util\";import{i18next}from\"@openremote/or-translate\";import{debounce}from\"lodash\";export{Util};export*from\"./markers/or-map-marker\";export*from\"./markers/or-map-marker-asset\";export*from\"./or-map-asset-card\";export class OrMapLoadedEvent extends CustomEvent{constructor(){super(OrMapLoadedEvent.NAME,{bubbles:!0,composed:!0})}}OrMapLoadedEvent.NAME=\"or-map-loaded\";export class OrMapClickedEvent extends CustomEvent{constructor(e,t=!1){super(OrMapClickedEvent.NAME,{detail:{doubleClick:t,lngLat:e},bubbles:!0,composed:!0})}}OrMapClickedEvent.NAME=\"or-map-clicked\";export class OrMapLongPressEvent extends CustomEvent{constructor(e){super(OrMapLongPressEvent.NAME,{detail:{doubleClick:!1,lngLat:e},bubbles:!0,composed:!0})}}OrMapLongPressEvent.NAME=\"or-map-long-press\";export class OrMapGeocoderChangeEvent extends CustomEvent{constructor(e){super(OrMapGeocoderChangeEvent.NAME,{detail:{geocode:e},bubbles:!0,composed:!0})}}OrMapGeocoderChangeEvent.NAME=\"or-map-geocoder-change\";export class CenterControl{onAdd(e){this.map=e;const t=document.createElement(\"div\");t.classList.add(\"maplibregl-ctrl\"),t.classList.add(\"maplibregl-ctrl-group\");const o=document.createElement(\"button\");o.className=\"maplibregl-ctrl-compass\",o.addEventListener(\"click\",(t=>e.flyTo({center:this.pos,zoom:e.getZoom()})));const r=document.createElement(\"span\");return r.className=\"maplibregl-ctrl-icon\",o.appendChild(r),t.appendChild(o),this.elem=t,t}onRemove(e){this.map=void 0,this.elem=void 0}}const CoordinatesRegexPattern=\"^[ ]*(?:Lat: )?(-?\\\\d+\\\\.?\\\\d*)[, ]+(?:Lng: )?(-?\\\\d+\\\\.?\\\\d*)[ ]*$\";function getCoordinatesInputKeyHandler(e){return t=>{if(\"Enter\"===t.code||\"NumpadEnter\"===t.code){const o=t.target.value;let r=o?{}:void 0;if(o){const e=o.split(/[ ,]/).filter((e=>!!e));2===e.length&&(r=new LngLat(Number.parseFloat(e[0]),Number.parseFloat(e[1])))}e(r)}}}export class CoordinatesControl{constructor(e=!1,t){this._readonly=!1,this._readonly=e,this._valueChangedHandler=t}onAdd(e){this.map=e;const t=document.createElement(\"div\");t.classList.add(\"maplibregl-ctrl\"),t.classList.add(\"maplibregl-ctrl-group\");const o=new OrMwcInput;return o.type=InputType.TEXT,o.outlined=!0,o.compact=!0,o.readonly=this._readonly,o.icon=\"crosshairs-gps\",o.value=this._value,o.pattern=CoordinatesRegexPattern,o.onkeyup=getCoordinatesInputKeyHandler(this._valueChangedHandler),t.appendChild(o),this.elem=t,this.input=o,t}onRemove(e){this.map=void 0,this.elem=void 0}set readonly(e){this._readonly=e,this.input&&(this.input.readonly=e)}set value(e){this._value=e,this.input&&(this.input.value=e)}}export const geoJsonPointInputTemplateProvider=(e,t,o,r,a,n)=>{const s=!(!n||!n.disabled),i=!(!n||!n.readonly),p=!(!n||!n.compact),l=!(!n||!n.comfortable),d=new CenterControl,c=e=>{a&&a(void 0!==e?{value:e?Util.getGeoJSONPoint(e):null}:void 0)},m=new CoordinatesControl(s,c);let h;return{templateFunction:(t,o,r,a,n,u)=>{let g;t&&(h=Util.getLngLat(t),g=h?Object.values(h):void 0);const v=g?g.join(\", \"):void 0;d.pos=h||void 0,m.readonly=s||i||a||r,m.value=v;const y=getMarkerIconAndColorFromAssetType(e);let C;const M=e=>{if(!i&&!s)if(h=e?Util.getLngLat(e):null,C){const e=C.shadowRoot.getElementById(\"geo-json-point-marker\");e.lng=h?h.lng:void 0,e.lat=h?h.lat:void 0,g=h?Object.values(h):void 0;const t=g?g.join(\", \"):void 0;m.value=t}else c(h)},f=[[d,\"bottom-left\"],[m,\"top-right\"]];if(!i){const e=new GeolocateControl({positionOptions:{enableHighAccuracy:!0},showAccuracyCircle:!1,showUserLocation:!1});e.on(\"geolocate\",(e=>{M(new LngLat(e.coords.longitude,e.coords.latitude))})),e.on(\"outofmaxbounds\",(e=>{M(new LngLat(e.coords.longitude,e.coords.latitude))})),f.push([e,\"bottom-left\"])}let _=html`\n            <or-map id=\"geo-json-point-map\" class=\"or-map\" @or-map-long-press=\"${e=>{M(e.detail.lngLat)}}\" .center=\"${g}\" .controls=\"${f}\" .showGeoCodingControl=${!i}>\n                <or-map-marker id=\"geo-json-point-marker\" active .lng=\"${h?h.lng:void 0}\" .lat=\"${h?h.lat:void 0}\" .icon=\"${y?y.icon:void 0}\" .activeColor=\"${y?\"#\"+y.color:void 0}\" .colour=\"${y?\"#\"+y.color:void 0}\"></or-map-marker>\n            </or-map>\n            <span class=\"long-press-msg\">${i18next.t(\"longPressSetLoc\")}</span>\n        `;if(p){const e=_,t=()=>{C=showDialog((new OrMwcDialog).setContent(e).setStyles(html`\n                            <style>\n                                .dialog-container {\n                                    flex-direction: column !important;\n                                }\n                                .dialog-container .long-press-msg {\n                                    display: block;\n                                    text-align: center;\n                                }\n                                or-map {\n                                    width: 600px !important;\n                                    min-height: 600px !important;\n                                }\n                            </style>\n                        `).setActions([{actionName:\"none\",content:\"none\",action:()=>{M(null),c(h)}},{actionName:\"ok\",content:\"ok\",action:()=>{c(h)}},{default:!0,actionName:\"cancel\",content:\"cancel\"}]))};_=html`\n                <style>\n                    #geo-json-point-input-compact-wrapper {\n                        display: table-cell;\n                    }\n                    #geo-json-point-input-compact-wrapper > * {\n                        vertical-align: middle;\n                    }\n                </style>\n                <div id=\"geo-json-point-input-compact-wrapper\">\n                    <or-mwc-input style=\"width: auto;\" .comfortable=\"${l}\" .type=\"${InputType.TEXT}\" .value=\"${v}\" .pattern=\"${CoordinatesRegexPattern}\" @keyup=\"${e=>getCoordinatesInputKeyHandler(c)(e)}\"></or-mwc-input>\n                    <or-mwc-input style=\"width: auto;\" .type=\"${InputType.BUTTON}\" compact icon=\"crosshairs-gps\" @or-mwc-input-changed=\"${t}\"></or-mwc-input>\n                </div>\n            `}return _},supportsHelperText:!1,supportsLabel:!1,supportsSendButton:!1,validator:()=>!h||void 0!==h.lat&&null!==h.lat&&void 0!==h.lng&&null!==h.lng}};let OrMap=class extends LitElement{constructor(){super(),this.type=manager.mapType,this._markerStyles=[],this.showGeoCodingControl=!1,this.showBoundaryBoxControl=!1,this.useZoomControl=!0,this.showGeoJson=!0,this.boundary=[],this._loaded=!1,this._markers=[],this.addEventListener(OrMapMarkerChangedEvent.NAME,this._onMarkerChangedEvent)}firstUpdated(e){super.firstUpdated(e),manager.ready&&this.loadMap()}get markers(){return this._markers}connectedCallback(){super.connectedCallback()}disconnectedCallback(){var e;super.disconnectedCallback(),this._observer&&this._observer.disconnect(),this._resizeObserver&&this._resizeObserver.disconnect(),null===(e=this._map)||void 0===e||e.unload()}render(){return html`\n            <div id=\"container\">\n                <div id=\"map\"></div>\n                <slot></slot>\n                <a id=\"openremote\" href=\"https://openremote.io/\" target=\"_blank\">\n                    <img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAP+Hj8y/AAAESUlEQVRIx5XVbWzdZRnH8c//f07POe36sK7SrYXZjYGzbBokOqd4QtKATdnMDFFSkoFzmWGRQOAFSoYnsBSzxBdmGsN4Y7LEFwZkUdHpDoja/AnJjBvp1sm2upW5PtAV+zBS+7Tz//tiLe0emPF+d9/39fvmunJf9+8K3HBF1drFzurVn5+5XkTwPwBNOt1s0pCjDnnT+Xzy/wOa5jaXnLLfLwzlF0WENwaYckyvUTHS1tnjl+6JFqk+JoMOqqy2JqjPVpXP1k7U1+Ty8paBPk97NX/pYwEdgZUetNkdlirDrHGnyv6y5r3lm4M2WVzwpJfz8XUBHTntnrJO6qqLWE9u/125zBNq0WebN/PXAjqq/cBOVWDasCEsd5MsmEzt/3xP+S6fwNsezPdfBejI6fCEDMa95oAT/t31pVxDQ6p6oy2WYSb18w0D2V3Klez2w3y8CNAR2G6vShxXUCxMkXLvS7Y6E/5+3emaJ92JqezzG+8M2nHW/flTi59xladU4phtfluYgnsDWUt8Nv7+8UfO73UUuenvDLxuCKu0RQt90BFo14wxzzpamD8uExtHSsu5HSP7XMCtZ5uTPyO0SdVCBlXahHjNG4WFrGY9Y4tXzODL7zb7NYJS64eHzWK92xYAa9yBKa8Wphf0xaQ4XOz0qF9JhMnXh//mIm4dnDSMOusWALepwQUnrm2t4pi9hrGyP+ccloxV6kOZFemoWi2mOpclaQycqGlt9R8XHS/GixinnVWvbDpjDEEpNpdnWrtd+HvZWzMQT9xjj1iXzUau6MPS9X9NKOeTmqzPpZWwfMkEKnza2ivimqxCKZjQa9BMmFI2D+gxibql4z7EiobYOSy1o7V6Xt1aYacGvD/7lse1+GZ9t0Zc8kHaGcOa1K6o+FePL1iy7K7wYHy70FZa9+qVWOm7tgslfpecKcy46GS0xXKM6g6d14VU+RfTnRJ8Y223w8j4tkMOOeR1j6nAMT8tzkCUcvlbn3ImbJn0RyWC+1af1Iv6ukcbf+aIRKDR3b5ipVCiy+PenaupWRsSfzCWim0ftUmdiqrJwWLpbmk3196UfXG0X6NKIWKDXva0I0UQZT2nRaDfc/mhgCj0PS9ImZzefbg5fliIvuTA++/0ZaYDTDqqpzhn6lHoW36iSuLHnslfCiBqdMBGDI6/0LUhfkgGiWFbC29c+epRaJMX3YJuD+R75l15wG4DaKh5dsPJsj0GXLaawavkWY/MyUcU/JOPHCkK7fAjNZiIf/PeX/vWx1814muF0Y/EKWs95mFVuKhgX352EYAoY5vnNSDRF/9p/MgHfQ2dldNIqbPeJm2aBBix20vzg26RpUUpLfb43FxZU4YMmEJGoxXKQeIfCg4uzMkrTDVitZ0ecst1B05i0Cv26Vk8H68JjFKabXa/Zkul5w5Lxp120EHdlyu/AQCiQI1P+YxaGcwY1+20kasnM/wXCa5/Ik1hKTEAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMDgtMjBUMTU6MTc6NTUrMDA6MDCwJSdSAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTA4LTIwVDE1OjE3OjU1KzAwOjAwwXif7gAAAABJRU5ErkJggg==\" />\n                </a>\n            </div>\n        `}updated(e){var t;super.updated(e),(e.has(\"center\")||e.has(\"zoom\"))&&this.flyTo(this.center,this.zoom),e.has(\"boundary\")&&this.showBoundaryBoxControl&&(null===(t=this._map)||void 0===t||t.createBoundaryBox(this.boundary))}refresh(){this._map&&this._map.loadViewSettings().then((()=>{this._map&&(this._map.setCenter(),this._map.flyTo())}))}loadMap(){this._loaded||(this._mapContainer&&this._slotElement&&(this._map=new MapWidget(this.type,this.shadowRoot,this._mapContainer,this.showGeoCodingControl,this.showBoundaryBoxControl,this.useZoomControl,this.showGeoJson).setCenter(this.center).setZoom(this.zoom).setControls(this.controls).setGeoJson(this.geoJson),this._map.load().then((()=>{var e,t;this._observer=new FlattenedNodesObserver(this._slotElement,(e=>{this._processNewMarkers(e.addedNodes),this._processRemovedMarkers(e.removedNodes)})),null===(e=this._resizeObserver)||void 0===e||e.disconnect(),this._resizeObserver=new ResizeObserver(debounce((()=>{this.resize()}),200));var o=null===(t=this._mapContainer)||void 0===t?void 0:t.parentElement;o&&this._resizeObserver.observe(o)}))),this._loaded=!0)}resize(){this._map&&this._map.resize()}flyTo(e,t){this._map&&this._map.flyTo(e,t)}_onMarkerChangedEvent(e){this._map&&this._map.onMarkerChanged(e.detail.marker,e.detail.property)}_processNewMarkers(e){e.forEach((e=>{if(this._map&&e instanceof OrMapMarker){this._markers.push(e);const t=e.constructor.name;if(this._markerStyles.indexOf(t)<0){const o=e.constructor.styles;let r=[];o&&(Array.isArray(o)?r=o:r.push(o),r.forEach((e=>{const t=document.createElement(\"style\");t.textContent=String(e.toString()),this._mapContainer.children.length>0?this._mapContainer.insertBefore(t,this._mapContainer.children[0]):this._mapContainer.appendChild(t)}))),this._markerStyles.push(t)}this._map.addMarker(e)}}))}_processRemovedMarkers(e){e.forEach((e=>{if(this._map&&e instanceof OrMapMarker){const t=this._markers.indexOf(e);t>=0&&this._markers.splice(t,1),this._map.removeMarker(e)}}))}};OrMap.styles=style,__decorate([property({type:String})],OrMap.prototype,\"type\",void 0),__decorate([property({type:String,converter:{fromAttribute(e,t){if(!e)return;const o=e.split(\",\");if(2!==o.length)return;const r=Number(o[0]),a=Number(o[1]);return new LngLat(r,a)},toAttribute(e,t){const o=Util.getLngLat(e);return o?o.lng+\",\"+o.lat:\"\"}}})],OrMap.prototype,\"center\",void 0),__decorate([property({type:Number})],OrMap.prototype,\"zoom\",void 0),__decorate([property({type:Boolean})],OrMap.prototype,\"showGeoCodingControl\",void 0),__decorate([property({type:Boolean})],OrMap.prototype,\"showBoundaryBoxControl\",void 0),__decorate([property({type:Boolean})],OrMap.prototype,\"useZoomControl\",void 0),__decorate([property({type:Object})],OrMap.prototype,\"geoJson\",void 0),__decorate([property({type:Boolean})],OrMap.prototype,\"showGeoJson\",void 0),__decorate([property({type:Array})],OrMap.prototype,\"boundary\",void 0),__decorate([query(\"#map\")],OrMap.prototype,\"_mapContainer\",void 0),__decorate([query(\"slot\")],OrMap.prototype,\"_slotElement\",void 0),OrMap=__decorate([customElement(\"or-map\")],OrMap);export{OrMap};","import{css,unsafeCSS}from\"lit\";import{DefaultColor4}from\"@openremote/core\";export const progressCircular=css`\n           \n            /*  https://codepen.io/finnhvman/pen/bmNdNr  */\n            .pure-material-progress-circular {\n                -webkit-appearance: none;\n                -moz-appearance: none;\n                appearance: none;\n                box-sizing: border-box;\n                border: none;\n                border-radius: 50%;\n                padding: 0.25em;\n                width: 3em;\n                height: 3em;\n                color: var(--or-app-color4, ${unsafeCSS(DefaultColor4)});\n                background-color: transparent;\n                font-size: 16px;\n                overflow: hidden;\n            }\n\n            .pure-material-progress-circular::-webkit-progress-bar {\n                background-color: transparent;\n            }\n\n            /* Indeterminate */\n            .pure-material-progress-circular:indeterminate {\n                -webkit-mask-image: linear-gradient(transparent 50%, black 50%), linear-gradient(to right, transparent 50%, black 50%);\n                mask-image: linear-gradient(transparent 50%, black 50%), linear-gradient(to right, transparent 50%, black 50%);\n                animation: pure-material-progress-circular 6s infinite cubic-bezier(0.3, 0.6, 1, 1);\n            }\n\n            :-ms-lang(x), .pure-material-progress-circular:indeterminate {\n                animation: none;\n            }\n\n            .pure-material-progress-circular:indeterminate::before,\n            .pure-material-progress-circular:indeterminate::-webkit-progress-value {\n                content: \"\";\n                display: block;\n                box-sizing: border-box;\n                margin-bottom: 0.25em;\n                border: solid 0.25em transparent;\n                border-top-color: currentColor;\n                border-radius: 50%;\n                width: 100% !important;\n                height: 100%;\n                background-color: transparent;\n                animation: pure-material-progress-circular-pseudo 0.75s infinite linear alternate;\n            }\n\n            .pure-material-progress-circular:indeterminate::-moz-progress-bar {\n                box-sizing: border-box;\n                border: solid 0.25em transparent;\n                border-top-color: currentColor;\n                border-radius: 50%;\n                width: 100%;\n                height: 100%;\n                background-color: transparent;\n                animation: pure-material-progress-circular-pseudo 0.75s infinite linear alternate;\n            }\n\n            .pure-material-progress-circular:indeterminate::-ms-fill {\n                animation-name: -ms-ring;\n            }\n\n            @keyframes pure-material-progress-circular {\n                0% {\n                    transform: rotate(0deg);\n                }\n                12.5% {\n                    transform: rotate(180deg);\n                    animation-timing-function: linear;\n                }\n                25% {\n                    transform: rotate(630deg);\n                }\n                37.5% {\n                    transform: rotate(810deg);\n                    animation-timing-function: linear;\n                }\n                50% {\n                    transform: rotate(1260deg);\n                }\n                62.5% {\n                    transform: rotate(1440deg);\n                    animation-timing-function: linear;\n                }\n                75% {\n                    transform: rotate(1890deg);\n                }\n                87.5% {\n                    transform: rotate(2070deg);\n                    animation-timing-function: linear;\n                }\n                100% {\n                    transform: rotate(2520deg);\n                }\n            }\n\n            @keyframes pure-material-progress-circular-pseudo {\n                0% {\n                    transform: rotate(-30deg);\n                }\n                29.4% {\n                    border-left-color: transparent;\n                }\n                29.41% {\n                    border-left-color: currentColor;\n                }\n                64.7% {\n                    border-bottom-color: transparent;\n                }\n                64.71% {\n                    border-bottom-color: currentColor;\n                }\n                100% {\n                    border-left-color: currentColor;\n                    border-bottom-color: currentColor;\n                    transform: rotate(225deg);\n                }\n            }\n`;"],"names":[],"sourceRoot":""}